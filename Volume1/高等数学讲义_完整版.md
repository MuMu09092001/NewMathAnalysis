---
title: 新工科数学分析 (上册)
author: 胡煜成
description: 首都师范大学新工科数学分析
"og:description": 浏览器版和手机版
"og:image": https://vlook-doc.pages.dev/pic/vlook-og.png
keywords:
- 高等数学,微积分,数学分析,讲义
vlook-chp-autonum: h1=off
vlook-query: vdl=on
vlook-query: ws=off
---

[toc]

# 极限

> [!tip] 
> 微积分是本课程的核心内容, 而极限则是微积分中的核心概念. 极限的概念很直观, 但经过数学的严格化后会变得非常抽象. 可以说极限的公理化是一道门槛, 是我们从中学的初等数学迈向大学的高等数学的必经之路. 要学好极限并不容易, 这里面涉及从有限到无穷的观念转变. 我们会发现这条路一开始会辗转反复, 让人晕头转向, 但是当你学完这门课程再回头来看, 会发现这么做是值得的, 数学概念的严格化其实不是在追求外表的精美, 而是让我们的内心变得更加的强大, 使我们有力量走得更远. 那么, 我们深呼吸一下, 一起敲开通向高等数学的大门吧.



## 集合与映射

> [!tip]
>
> ==集合与映射是数学研究从具体到抽象的第一步.==
>
> 举个例子, 比如我们上这门高数课, 最后需要给每个上课的学生一个成绩. 为了从数学上来更加严格的定义这个任务, 我们可以把所有选课的同学构放到一个**集合** $S$ 中, 同时把所有可能的成绩 (比如A, B, C, D四个档次) 放到另一个**集合** $G$ 中, 那么给学生成绩的这个任务在数学上就可以看成是**从集合 $S$ 到集合 $G$ 的一个映射**. 引入集合和映射的概念可以让一个问题变得更清晰, 更严格.
> 
> ![集合是数学抽象](../media/img/chpt1_set_final.svg)
>

### 集合
#### 集合的概念

> [!TIP]
> 
> 当我们用**数学语言**来描述世界时, 首先要把我们**感兴趣的对象**给拿出来, 进行适当的抽象, 然后再研究它们的规律. **集合**就是数学中用来界定对象的一个概念.
> 

> [!Note]
> 
> ==集合举例==
>
> 1. *`太阳系八大行星`* --- $\{水星, 金星, 地球, 火星, 木星, 土星, 天王星, 海王星\}$
> 2. *`10个阿拉伯数字`* --- $\{0, 1, 2, 3, 4, 5, 6, 7, 8, 9\}$
> 3. *`一个班所有男生的姓氏`* --- $\{李, 王, 张, 杨, 周, 诸葛, 徐, 孙, 胡\}$
> 4. *`1 ~ 10 之间的所有偶数`* $A=\left \{  2,4,6,8,10\right \} $
> 6. *`自然数集`* --- $\mathbb{N} = \left\{0, 1, 2, 3, \cdots \right\}$
> 7. *`整数集`* --- $\mathbb{Z} = \left\{0, \pm 1, \pm 2, \pm 3, \cdots \right\}$
> 8. *`实数集`*  --- $\mathbb{R} = \left\{x: -\infty < x < \infty \right\}$
> 9. *`满足不等式 x-3<10 的所有实数 x`* --- $A=\left \{x < 7\right \} $

> [!Important]
>
> 我们把所要研究的对象统称为**元素** (element), 这些元素所组成的总体叫做**集合** (set). 
>
> 描述集合的方式既可以通过文字叙述, 也可以把所有的元素写在 $\{\}$ 里面, 不管用那种方式, 一定要让人能够判断某个对象是不是在这个集合里.
>
> 集合需要满足下面两个性质: 
>
> 1. ###### **互异性**: 集合中的任何两个元素都是不同的. 比如在集合3的例子中, 即使这个班里有3个同学姓“王”, 在集合3中“王”姓也只出现一次, 重复的不算.
>
> 2. **无序性**: 集合中的元素没有顺序之分. 所以集合 $\{水星, 金星, 地球\}$ 与集合 $\{地球, 水星, 金星\}$ 是没有区别的.
>

> [!Caution]
>
> 一般用大写字母如 $A, B, C$ 表示集合, 用小写字母如 $x$ 或 $a, b, c$ 来表示集合中的元素.
>
> 我们说一个对象**在**或**不在**一个集合中, 用数学术语就是**属于**或**不属于**: 
>
> - 如果 $x$ 是集合 $A$ 的元素, 就说 $x$ **属于** 集合 $A$ , 记作 $x\in A$ ; 
> - 如果 $x$ 不是集合 $A$ 中的元素, 就说 $x$ **不属于** 集合 $A$, 记作 $a \notin A$.

> [!Warning]
> 
> ==图像掩码 (mask)==
> 
> **图像掩码**是计算机视觉中的重要概念. 掩码 (mask) 通常是一个二值 (0或1) 图像, 像素值为0表示不关心的区域, 1表示感兴趣的区域. 因此**所有像素值为1的像素点构成的集合**就是我们感兴趣的区域 (ROI, Region of Interest). 比如下图中, 左侧是我们拿到的一张图片 , 我们只关心图片中狗的区域, 因此对应的掩码就是中间的一个二值图像 (黑色区域的像素值为0, 白色区域的像素值为1), 将这个掩码逐像素的跟原图相乘, 得到的结果就是右边的这张只有狗的图 (狗所在部分的值跟原图一样, 之外部分的值都等于0).
>
> ![图像掩码](../media/img/mask.png)
> 

#### 集合的性质

> [!TIP]
> 
> 集合是一个包罗万象的容器, 不同的集合可能包含截然不同对象, 我们在研究集合的时候, 首先要搞清楚**集合内部元素的性质**.
> 

> [!important]
>
> ==有序性==
>
> 如果一个集合中的元素可以排序, 那么这个集合就是**有序集**, 否则就是**无序集**. 
>
> 注意这个并不是一个严格的数学定义, 即使在实际操作中也是模糊的, 比如集合 $\{红, 绿, 蓝\}$, 理解成三个汉字的话可能无法排序, 但理解成颜色所对应的波长则可以间接的通过波长大小进行排序. 所以关键的问题是, 你在建立这个集合时所关心的**具体问题**是什么. 我们在使用集合这个工具的时候一定要先想清楚这一点, 这很重要, 尤其是对于学习**编程**_~Rd~_的同学！例如, 在程序里, 有序集通常可以使用**array**数据结构, 其中的元素可以通过指标很方便的访问；而无序集则往往使用**set**数据结构, 其中的元素需要一个一个去比较.
>

> [!Note]
>
> ==有序性和无序集==
> 
> 下面的集合中的元素之间通常是可以比较大小, 如: 
>
> - 实数集 $\mathbb{R}$
> - 音阶集 $\{ 哆, 来, 咪, 发, 嗦, 啦, 西\}$
> 
> 下面的集合中的元素之间通常无法比较大小(至少没有显而易见的比较大小的规则), 如: 
>
> - 天气集 $\{ 天晴, 多云, 下雨, 雾霾\}$ 
> - 动物集 $\{ 猫, 狗, 牛, 马\}$
> 

> [!Important]
> 
> ==等价关系==
> 
> 如果我们能够在一个集合上定义某种**等价关系**, 那么凡是“等价”的元素都可以划分到一个子集中, 而这些子集也被称为**等价类**. **等价关系**是集合元素间的一种二元关系, 以符号 $\sim$ 表示, 它满足以下三个条件: 
>
> 1. **自反性**: 对于所有 $a \in A$, 有 $a \sim a$.
> 2. **对称性**: 对于所有 $a, b \in A$, 如果 $a \sim b$, 则 $b \sim a$.
> 3. **传递性**: 对于所有 $a, b, c \in A$, 如果 $a \sim b$ 且 $b \sim c$, 则 $a \sim c$.

> [!Note]
>
> ==等价关系==
>
> - 整数集 $ℤ$ 模 2 的等价关系: 如果 $a, b$ 除 2 的余数相等则 $a$ 和 $b$ 等价. 在该等价关系下, 所有偶数 (除2余0) 构成了一个等价类, 所有奇数 (除2余1) 构成了另一个等价类.
> - 记某个班全体同学构成的集合为 $A$, 按照座位我们规定, 如果 $a, b$ 两位同学坐在同一列则 $a$ 和 $b$ 等价. 在该等价关系下, 每一列的同学构成一个等价类. 老师就经常利用上述等价关系对同学进行分组或收发作业.

> [!Important]
> 
> ==一些常用的集合性质==
> 
> - 有限集 (有穷集) : 含有有限个元素的集合, 如 $\{ 2, 4, 5, 8\}$.
> - 无限集 (无穷集) : 含有无穷多个元素的集合, 如自然数集 $\mathbb{N}$.
> 
> **数集**中常用的性质还有
> 
> - 有界集: 集合中的所有元素 $x$ 的绝对值都小于 $M$, 如开区间 $(0, 1)$.
> - 无界集: 如 $(0, +\infty)$.

#### 集合之间的关系

> [!TIP]
> 
> 集合 $A$ 和 $B$ 之间能不能进行比较?有没有大小关系? 例如, 如何通过数学的语言来描述一个班全体男生构成的集合 $A$, 全体女生构成的集合 $B$, 以及全班所有同学构成的集合 $C$ 之间的关系呢?

> [!IMPORTANT]
>
> ==两个集合间的包含关系==
>
> 如果集合 $A$ 中**任意**_~Rd~_一个元素都是集合 $B$ 中的元素, 则称 $A$ **包含于** $B$ (或 $B$ **包含**$A$), 记作 $A\subseteq B$ 或 $B\supseteq A$, 此时称 $A$ 为 $B$ 的 **子集** (subset). 
> 
> 基于集合的包含关系我们再引入两个概念: 
> 1. **空集**: 不包含任何元素的集合叫做 **空集** (emptyset), 记为 $\phi $, 空集是任何集合的子集.
> 2. **集合相等**: 如果 $A\subseteq B$, 同时 $B\subseteq A$, 则集合 $A$, $B$ 中的元素是完全一样的, 此时我们说集合 $A$ 等于集合 $B$, 记作$A=B$.
> 
> 在上面的例子中, 全体男生构成的集合 $A$ 包含于全班同学构成的集合 $C$, 全体女生构成的集合 $B$ 也包含于集合 $C$, 但是 $A, B$ 之间没有包含与被包含的关系.

> [!Caution] 
> ==借助图像表示集合间的包含关系==
> 
> 集合 $A$ 包含于集合 $B$ 可以用下图表示
> 
> ![集合的包含关系](../media/img/1.2.jpg) 

> [!Note]
> 
> 下面例子中的 $A$ 和 $B$ 存在包含关系:
> 
> 1. $A=\left\{ 1,2,3 \right\},$  $B=\left\{1,2,3,4,5\right\}.$
> 2. $A$ 为所有等腰三角形, $B$ 为所有三角形.
> 
> 下面例子中的 $A$ 和 $B$ 不存在包含关系 (找反例: 是否能找到 $A$ 中的一个元素, 使其不在 $B$ 中):
> 
> 1. $A=\left\{ 1,2,6 \right\}$, $B=\left\{1,2,3,4,5\right\}$.
> 2. $A$ 为所有等腰三角形, $B$ 为锐角三角形.
> 

#### 集合之间的运算

> [!TIP]
> 
> 集合 $A$ 和 $B$ 之间能不能做运算? *`加`* *`减`*法是没有的, 但是有*`交`* *`并`* *`补`*运算. 

> [!Important]
> 
> ==交集==
> 
> 所有既属于 $A$ 又属于 $B$ 的元素组成的集合称为 $A$ 与 $B$ 的 **交集** (intersection set), 记作 $A\cap B$ (读作“$A$ 交 $B$”), 即
> 
> $$
> A\cap B=\left \{ x: x\in A \ \mathrm{and} \ x\in B \right \}
> $$
> 
> 下图展示了交集运算: 
> 
> ![交集](../media/img/1.4.jpg)

> [!Note]
> 1. $A=\left\{2, 4, 6, 8, 10 \right\}$, $B=\left\{ 3, 5, 8, 12 \right\}$,  则 $ A \cap B =\left\{ 8 \right\}$. 
> 2. $A=\left \{全校女同学 \right \} $, $B=\left \{所有高一级同学 \right \} $,  $A \cap B = \left \{ 高一级全体女同学 \right \}$.

> [!important]
> 
> ==并集==
>
> 所有属于集合 $A$ 或属于集合 $B$ 的元素组成的集合, 称为集合 $A$ 与 $B$ 的 **并集** (union set), 记作 $A\cup B$ (读作“ $A$ 并 $B$ ”), 即
> 
> $$
> A\cup B=\left \{ x: x\in A \ \mathrm{or} \ x\in B \right \}
> $$
> 
> 下图展示了并集运算: 
> 
> ![并集](../media/img/1.3.jpg)
> 

> [!Note]
> 
> 1. $A=\left \{ 1,3,5 \right \} $, $B=\left \{ 2,4,6 \right \} $, $A \cup B=\left \{ 1,2,3,4,5,6 \right \} $；
> 2. $A=\left \{有理数 \right \} $, $B=\left \{无理数 \right \} $, $A \cup B=\left \{实数 \right \} $.

> [!Important]
> 
> ==补集==
> 
> 如果集合 $A$ 是集合 $B$ 的子集, 则所有 $B$ 中不属于 $A$ 的所有元素构成的集合称为 $A$ 相对于 $B$ 的 **补集** (complementary set), 记作 $C_BA$ 或 $A^C$, 即
> 
> $$
> \bar{A} = C_B A = \{x \in B: \ x\notin A\}
> $$
> 
> 下图展示了补集运算: 
> 
> ![补集](../media/img/image.png)

> [!Note]
> 
> 1. $A=\left \{ 1,3,5 \right \} $, $B=\left \{ 1,2,3,4,5,6 \right \} $, $C_BA = \{ 2, 4, 6\}$.
> 2. $A=\left \{有理数 \right \} $, $B=\left \{ 实数 \right \} $, $C_BA = \{无理数\}$.

> [!Warning]
>
> ==图像掩码与集合的交集==
>
> 假设在一个图像里面我们有两个感兴趣的区域集合 $A$ 和集合 $B$, 分别对应掩码 $M_A$ 和 $M_B$, 则集合 $A \cap B$ 对应的掩码可以通过逐像素相乘运算得到, 即 $ M_{A \cap B} = M_A * M_B$, 其中 $*$ 表示每个对应位置的像素分别相乘.
>
> *==掩码的交集==*
> |![alt text](../media/img/mask_a.png)|![alt text](../media/img/mask_b.png)|![alt text](../media/img/intersection_mask.png)|
> |:-:|:-:|:-:|
> |$M_A$|$M_B$| $M_{A \cap B}$|
>
> ==图像掩码中的集合并运算==
>
> 假设在一个图像里面我们有两个感兴趣的区域集合 $A$ 和集合 $B$, 分别对应掩码 $M_A$ 和 $M_B$, 则集合 $A \cup B$ 对应的掩码可以通过逐像素作“或”运算得到.“或”运算的符号为 $ \lor$, 运算规则为 
>
> $$
> 1 \lor 1 = 1, \ 1\lor 0 = 0 \lor 1 = 1, \ 0 \lor 0 = 0.
> $$
>
> 我们有 $ M_{A \cup B} = M_A \lor M_B$.
>
> *==掩码的并集==*
>
> |![image\label{testlab1}](../media/img/mask_a.png)| ![alt text](../media/img/mask_b.png)| ![alt text](../media/img/union_mask.png)|
> |:-:    |:-:    |:-:            |
> |$M_A$|$M_B$| set $M_{A \cup B}$|
>
> ==图像掩码与集合的补集==
>
> 如下图, 假设在一个图像里面我们有一个感兴趣的区域集合 $A$, 对应掩码 $M_A$, 则图像中我们不感兴趣的区域可以看成是集合 $A$ 在以整个图像为全集的补集 $C_{M}A $,  $C_{M}A $ 可以通过取反运算得到, 即 $ M_{C_{M}A} = \mathrm{NOT}(M_A)$, 其中 $\mathrm{NOT}$ 表示每个对应位置的像素分别取反运算($\mathrm{NOT}(0) = 1, \mathrm{NOT}(1) = 0$).
>
> *==掩码的补集==*
> |![alt text](../media/img/mask_a.png)|![alt text](../media/img/comp_mask.png)|
> |:-:|:-:|
> |$M_A$|$M_{C_{M}A}$|



> [!Warning]
> 
> ==训练集和测试集==
> 
> **训练集和测试集**是机器学习中常见的两个集合. 假设我们手中有一个包含1000张图像的数据集, 我们通常会将这些图像分成两个不相交的部分: 一部分用来训练模型 (称为训练集), 另一部分用来评估模型性能 (称为测试集). **训练集是图像全集的一个子集**, 同样, 测试集也是全集的一个子集, 但它们**没有交集**——也就是说, 一个图像不能同时出现在训练集和测试集中. 这种划分就是集合的一个典型应用: 给定全集 $A$, 我们从中选出两个不相交的子集 $B$ 和 $C$, 满足 $A = B \cup C$ 且 $B \cap C = \emptyset$. 在实际应用中, 我们通常用70%的图像作为训练集, 30%的图像作为测试集, 也就是说我们从集合的角度划分数据, 保证模型的训练与测试在**不同的样本**上进行, 从而更好地评估模型的泛化能力.


### 映射

> [!TIP]
>
> 前面所讲的**集合**的概念是为了给**映射**做铺垫. 映射是集合与集合之间的关联, 集合对数学就好像计算机中的**键盘**, 无非就是100多个键; 而映射对数学就好像计算机中的**程序**, 变幻无穷. 
>
> 回到我们之前给学生打分的例子, 为了更加合理的给学生打分, 我们可以把学生努力的程度转化成数值, 然后把分数对应成绩点, 从而把打分的问题变成了一个从数到数的映射, 也就是**函数**. 可以看到函数是用来解决具体问题的一个很方便的工具.
>
> ![图片](../media/img/chpt1_function_final.svg)
>

#### 映射的概念

> [!Important]
> 
> ==映射的定义==
> 
> 映射 (map) 描述了从一个集合到另一个集合的某种对映关系. 设集合 $A$ 和 集合 $B$ 是两个集合, 如果存在一个对映关系 $f$, 使得集合 $A$ 中的每个元素都唯一的对映到 $B$ 中的一个元素, 则称 $f$ 为从 $A$ 到 $B$ 的映射, 记作
> $$
> f: A \rightarrow B
> $$
>
> 映射 $f$ 把集合 $A$ 中的元素 $a$ 对映到 $B$ 中的元素 $b$, 可记作
> $$
> f(a) = b
> $$
> 此时 $b$ 称为 $a$ 的**象**, $a$ 称为 $b$ 的**原象**.
>
> 映射可以通过下面的图像来理解: 
>
> ![映射](../media/img/image-2.png)
> 
> 图中箭头表示了集合 $A$ 中元素与集合 $B$ 中元素的对映关系. 
> 
> 根据定义, 映射需要满足两个要求: **随处取值, 唯一对映**.
>
> - **随处取值**是指 $A$ 中的任何一个元素在 $B$ 中都有对映；
> - **唯一对映**是指 $f$ 可以把 $A$ 中的不同元素映射到 $B$ 中的同一个元素, 但不能把 $A$ 中的一个元素映射到 $B$ 中的多个元素.

> [!Caution]
>
> ==映射的性质==
>
> 1. **单射**：如果 $A$ 中的每个元素都对映 $B$ 中的不同元素, 则称 $f$ 为单射.
> 2. **满射**：如果 $B$ 中的每个元素都有原象, 则称 $f$ 为满射.
> 3. **一一映射**：顾名思义, 一一映射就是集合 $A$ 中元素与集合 $B$ 中的元素一个对映一个.
> 可以证明, $f$ 是一一映射等价于 $f$ 既是单射又是满射.
>
> ==逆映射==
>
> 对于一一映射 $f: A \rightarrow B $, 把映射的象和原象反过来, 得到一个把集合 $B$ 映射到集合 $A$ 的新的映射, 称为逆映射, 记作 $f^{-1}: B\rightarrow A$.

> [!Note]
> 
> ==映射的例子==
> 
> 映射的例子在我们的生活中随处可见, 例如：
>
> 1. **名字**：集合 $A$ 是所有的人, 集合 $B$ 是所有的名字. 每个人都有一个名字, 我们允许重名, 但不允许一个人有2个名字.
> 2. **地图**：没错, map 本身就是一个 map！(我们希望)这是一个从地图到真实世界的一一映射.
> 3. **颜色**：为什么我们能看到不同的颜色？颜色是一个从光波长到我们主观感受的映射.
> 
> 从上面的例子可以感受到, 映射的作用在于把集合 $A$ 中的元素作为**输入信号**, 例如如不同的人、GPS坐标、光的波长等, 经过某种操作, 转换成我们关心的输出, 如名字、位置和颜色. 从这个意义上理解, 映射就是就是把输入 $x$ 转化成 $f(x)$ 的一个机器.
> 
> ![Function](../media/img/function.png)

> [!Caution]
>
> ==映射与函数==
>
> 映射的概念如此重要, 以至于在不同的场合映射还有不同的专业名称. 在计算机编程中, **函数**(function) 就是映射, 是一个从输入 (可以是数、数组、函数等）到输出 (也可以是数、数组、函数等）的一系列操作. 在数学里, 当集合 $A$ 和 $B$ 都是数集的时候, 映射也叫做**函数 **(function), 如函数 $f(x) = 2x+3$ 是一个从实数集到实数集的一个映射. 函数是高等数学上册的主要研究对象, 而多元函数 (从 $n$ 维实数空间到实数空间的映射, $n>2$ )则是高等数学下册的主要研究对象 (前面的给学生打分的例子可以进一步细化成一个多元函数, 也就是把平时, 期中, 期末和其它因素的成绩统一考虑, 然后映射到一个分数上).
>
> ![图片](../media/img/chpt1_mvfunction_final.svg)

#### 数列

> [!TIP]
> 
> **数列**是一类特殊的映射, 它把自然数集 $\mathbb{N}$ 映射到实数集 $\mathbb{R}$ 中, 进一步, 这还是一个数到数的映射, 因此同时也是一个函数, 这个函数可以记作 $a(n)$, 不过更多的时候我们会把 $n$ 作为下标, 以 $a_n$ 表示数列得第 $n$ 项, 并以 $\{ a_n \} $ 表示整个数列.

---

> [!Note]
> ==等差数列==
> 
> - 首项为 $a_{1}$,  公差为 $d$ 的等差数列的**通项公式**为
>
> $$
> a_{n} =a_{1} +(n-1)d
> $$
>
> - 等差数列的**前 $n$ 项和**为
> $$
> \quad S_{n}=na_1+\frac{n(n-1)}{2}d
> $$

> [!Note]
> ==等比数列==
>
> - 首项为 $a_{1}$ , 公比为 $q$ 的等比数列的**通项公式**为
> $$
> a_{n}=a_{1} q^{n-1}
> $$
>
> - 等比数列的**前 $n$ 项和**为
> $$
> S_{n}=a_{1}\frac{1-q^n }{1-q} （q\ne 1)
> $$

#### 函数

> [!TIP]
>
> 函数是用数学解决实际问题的重要**工具**, 函数之于数学就像**程序**之于计算机. 
> 
> 学习函数的时候不要去跟冰冷的公式硬刚, 而应该把函数的图像放在心里, 产生画面感, 把公式具象化, 成为直觉的一部分. 因此, **函数的图像非常重要!**_~Rd~_

> [!important]
> 
> ==函数的定义==
>
> 从**数集** $A$ 到**数集** $B$ 的映射 $f:A \rightarrow B$ 称为**函数** (function). 可以把函数写成 $y = f(x)$ 的形式, 并把 $x$ 称为**自变量**, $y$ 称为 $x$ 对映的**函数值**.
> 

> [!note]
> 
> ==初等函数==
> 
> 1. 幂函数: $y=x^{\alpha}$
> 2. 指数函数: $y=a^x$, 特别的有 $y=\mathrm{e}^x$, 后者在 python 中有专门的函数 $numpy.exp(x)$
> 3. 对数函数: $y=\mathrm{log}_a^{x}$, 特别的有 $y=\mathrm{ln}^{x}$, 后者在 python 中有专门的函数 $numpy.log(x)$
> 4. 三角函数: $y=\sin(x)$, $y=\cos(x)$, $y=\tan(x)$
> 5. 反三角函数: $y = \mathrm{arcsin}(x)$
> 
> ==其它常用函数==
>
> 1. 绝对值函数: $y=|x|$
> 2. 符号函数
> $$
> y=\mathrm{sgn}(x)=\left\{\begin{matrix}
>  1, &  x>0& \\
>  0, &  x=0& \\
>  -1, &  x<0&
> \end{matrix}\right.
> $$
> 
> 3. Sigmoid函数
> $$
> \sigma (x)=\frac{1}{1+e^{-x}}
> $$

> [!Note]
> 
> ==函数的性质==
>
> - 单调性
> - 奇偶性
> - 周期性
> 

> [!Caution]
>
> ==反函数== 
>
> **反函数**是**逆映射**的一个特例, 对于函数 $f: x \rightarrow y$ (也要求 $f$ 是一一映射), 其反函数为 $f^{-1}: y \rightarrow x$.
>
> [!Note]
> - $y = 3x + 1$ 的反函数为 $y = (x-1)/3$
> - $y = \mathrm{e}^x$ 的反函数为 $y = \mathrm{ln}x$. 
>
> 反函数本质上是把 $x$ 和 $y$ 的顺序对调了一下, 因此不难发现原函数与反函数的图像是关于直线 $y = x$ 对称的.
> 
> ![反函数图形的对称性](../media/img/inverse_function.png#400w)

> [!Caution]
> 
> ==复合函数==
> 
> 对于函数 $f$ 和 $g$, 我们可以构造一个**新的函数** $y = f[g(x)]$, 它把自变量 $x$ 通过函数 $g$ 映射到 $u = g(x)$, 再把 $u$ 视作自变量 (也称为**中间变量**) 通过函数 $f$ 映射到 $y = y = f[g(x)]$. 这个过程可以表示为:
> 
> $$
> x \stackrel{g}{\longrightarrow} u \stackrel{f}{\longrightarrow} y.
> $$
> 
> 我们把这个新函数 $y = f[g(x)]$ 称为函数 $f$ 和 $g$ 的**复合函数**, 记作 $f \circ g$. 注意函数复合是讲顺序的, 一般来说 $f\circ g \ne g\circ f$.
> 

> [!note]
> 
> 假设 $f(x) = x + 2$, $g(x) = x^2$, 则
> 
> $$
> \begin{align}
> f\circ g &= g(x) + 2 = x^2 + 2, \\
> g\circ f &= [f(x)]^2 = (x+2)^2. 
> \end{align}
> $$

> [!Warning]
>
> ==深度学习与复合函数==
>
> ![神经网络](../media/img/network.png#400w) 
> 
> 人工智能中的核心技术为**深度学习**, 深度学习的背后其实就是有很多层 (从几十到几千层都有) 的**神经网络** (Neuron Network). 神经网络的本质正是复合函数. 对于图中所示的神经网络, 从最左端的**输入信号**开始, 之后每一层都是上一层信号的复合, 因此神经网络就是一个复合了很多次的函数, 这个函数把输入 (比如一张图片) 映射到我们关心的结果 (比如图像有猫还是狗的概率). 


## 极限

> [!TIP] 
> 
> **极限**是高等数学有别于初等数学的核心概念. 极限的出现代表了数学思想的一次转变, 而促成这一转变的动机来自于现实问题中对**曲线**相关问题的需求. 在初等数学中我们会计算矩形的周长和面积, 会计算三角形的周长和面积, 甚至是任意多边形的周长和面积, 但是, 这些都是由直线构成的结构, 而到了曲线大家就不会了. 曲线的长度怎么算? 由曲线构成区域的面积怎么算? 尽管我们初中就知道圆的周长是 $2\pi r$, 面积是 $\pi r^2$, 但是为什么是这样, 只有运用微积分才能给出严格的证明.
> 
> 如果我们拿西游记作为类比, 那初等数学就是**小乘佛法**, 可以修身养性, 而微积分则是**大乘佛法**, 可以普度众生. 数学史上, 微积分的确立历经了千难万险, 九九八十一难, 要说这里面的**孙悟空**之名, 我认为当属**牛顿**: 牛顿的时代还没有微积分, 正是他开创性的运用我们今天微积分中的各种思想和方法, 成功的解决了**天体运行理论** (注意天体运行的轨迹就是**曲线**), 开启了人类理性思潮的革命.
> 
> 今天, 我们将追随西天取经的足迹, 开启一场精神朝圣之旅. 一路上我们会经历重重磨难, 但最终我们会穿上牛顿的衣钵, 运用我们所学的微积分, 来推导**天体运行理论**, 揭示宇宙运行的奥义. 而**极限**_~Rd~_是我们西行路上的第一难, 这个**观念上的转变**是重要的, 我们一开始慢慢来, 好好的理解, 这个转变做得**越深刻越彻底**, 对以后的学习就越有帮助.

### 数列极限

> [!tip]
> 
> ==极限与圆的面积==
> 
> 圆的面积怎么算? 我们来看教材 P18 的例子. 这个例子体现了极限中从有限到无限再到极限的思想: 为了计算圆的面积, 我们构造了一**系列**圆的内接正多边形, 这些正多边形的面积是可以通过初等数学计算的, 我们把它们的面积记作 $A_n, n = 1, 2, \cdots$. 通过**直觉**我们能感受到, **当 $n$ 趋于无穷大时, $A_n$ 的面积会无限接近圆的面积**_~Rd~_. 接下来我们要做的就是**把这个直觉通过数学语言给严格化**. 
> 
>
> 
> 极限是一个**动中取静**_~Rd~_的过程. 
> 
> - 什么在动?
> 	在上面的例子中, 我们构造了一个数列 $\{ A_n \}$, 前面说过数列是个从自然数集 $\mathbb{N}$ 到实数集 $\mathbb{R}$ 的映射. 我们说的**动**发生在集合 $\mathbb{N}$ 中, 指标 $n$ 从 1, 2 直到 1千, 一万 ..., 这是**数列极限**概念中**动**的部分. 
> 
> - 什么是静?
> 	**数列极限**概念中**静**的部分来自于集合 $\mathbb{R}$ 中, 它表示 $A_n$ 的取值会慢慢**趋于稳定**, 到最后**几乎不变**了, 数学上我们称这种行为叫**收敛**. 
> 

> [!Note]
>
> ==极限存在的例子==
>
> **一尺之捶，日取其半 (版本1)**
> 
> 站在棒子的角度, 这个过程可以用一个数列描述. $n$ 代表天数, $a_n$ 代表杠剩下的长度.
>
> $$
> \begin{align*}
> a_0 &= 1,  \\
> a_1 &= 1/2,  \\
> a_2 &= 1/4,  \\
> & \cdots \\
> a_n & = 1/2^n, \\
> & \cdots
> \end{align*}
> $$
> 
> 随着 $n$ 的增加 (**动**), $a_n$ 的值不断靠近0 (**静**), 直觉告诉我们当 $n$ 区域无穷大时 $a_n$ 的极限是0.
>
> **一尺之捶，日取其半 (版本2)**
> 
> 站在砍棒人的角度, 这个过程也可以用一个数列描述. $n$ 代表天数, $b_n$ 代表到第 $n$ 天为止所取的棒子的总数.
> 
> $$
> \begin{align*}
> b_0 &= 0,  \\
> b_1 &= 1/2,  \\
> b_2 &= 1/2 + 1/4 = 3/4,  \\
> & \cdots \\
> b_n & = 1/2 + 1/4 + \cdots + 1/2^n = 1 - \frac{1}{2^n}, \\
> & \cdots
> \end{align*}
> $$
>
> 随着 $n$ 的增加 (**动**), $b_n$ 的值不断靠近1 (**静**), 直觉告诉我们当 $n$ 区域无穷大时 $b_n$ 的极限是1.
> 
> **P21 例1**
> 
> $$
> a_n = \frac{n + (-1)^{n-1}}{n}
> $$
> 
> 随着 $n$ 的增加 (**动**), $a_n$ 的值不断靠近1 (**静**), 直觉告诉我们当 $n$ 区域无穷大时 $a_n$ 的极限是1.
>
> **P22 例2**
> 
> $$
> a_n = \frac{(-1)^{n}}{(n+1)^2}, \\
> $$
> 
> 随着 $n$ 的增加 (**动**), $a_n$ 的值不断靠近0 (**静**), 直觉告诉我们当 $n$ 区域无穷大时 $a_n$ 的极限是0.

> [!Note]
> 
> ==极限不存在的例子==
>
> **例3**
>  
> 数列 $\{ 1, -1, 1, -1, \cdots\}$ 不收敛, 因为直觉告诉我们这个数列**静**不下来.
>
> **例4**
>  
> 数列 $\{ 1, 2, 3, 4, \cdots\}$ 不收敛, 这个数列不断增长, 直觉告诉我们这个数列也**静**不下来.

>**直觉**_~Rd~_: 所以数列 $\{a_n\}$ 有极限就是, 当 $n$ 足够大时, $a_n$ 的值无限接近某个数 $A$.

> [!important]
> 
> ==数列极限的定义== (非常重要!!!)
> 
> 设 $\{a_n\}$ 为一数列, $A$ 为一常数, 如果**对于任意给定的正数 $\varepsilon$**, **总存在正整数 $N$**, 使得当 $n>N$ 时有
> $$
> |a_n - A| < \varepsilon,
> $$
> 则称 $A$ 为数列 $\{a_n\}$ 的**极限**, 记作
> $$
> \lim_{n\rightarrow \infty} a_n = A.
> $$
> 

> [!Note]
> 
> 上述定义把数列极限的直觉具象化了, 从而使得直觉变得可操作了. 根据定义, 我们现在可以严格的判断前面例子中数列的极限.
>
> ==一尺之捶，日取其半 (版本1)==
> 
> **直觉**: $a_n  = 1/2^n$ 的极限为0.
> 
> **证明**: 对于任意给定的 $\varepsilon > 0$, 要找到 $N$ 使得 $|1/2^N - 0| = 1/2^N < \varepsilon$, 取 $N = \left[ -\mathrm{ln} \varepsilon / \mathrm{ln} 2 \right] + 1$, 可知当 $n > N$ 时, 总有 $|a_n - 0| < \varepsilon$. 因此 $\displaystyle \lim_{n \rightarrow \infty} a_n = 0$.
> 
> ==一尺之捶，日取其半 (版本2)==
> 
> **直觉**: $b_n  = 1 - \frac{1}{2^n}$ 的极限为1.
> 
> **证明**: 对于任意给定的 $\varepsilon > 0$, 要找到 $N$ 使得 $|1-1/2^N - 1| = 1/2^N< \varepsilon$, 取 $N = \left[ -\mathrm{ln} \varepsilon / \mathrm{ln} 2 \right] + 1$, 可知当 $n > N$ 时, 总有 $|b_n - 1| < \varepsilon$. 因此 $\displaystyle \lim_{n \rightarrow \infty} b_n = 1$.
>
>
> ==P21 例1==
> 
> **直觉**: $\displaystyle a_n  = \frac{n + (-1)^{n-1}}{n}$ 的极限为1.
> 
> **证明**: 对于任意给定的 $\varepsilon > 0$, 要找到 $N$ 使得 $\displaystyle \left|\frac{n + (-1)^{n-1}}{n} - 1\right| = \frac{1}{n}< \varepsilon$, 取 $N = \left[ 1/ \varepsilon\right] + 1$, 可知当 $n > N$ 时, 总有 $|a_n - 1| < \varepsilon$. 因此 $\displaystyle \lim_{n \rightarrow \infty} a_n = 1$.
>
> ==P22 例2==
> 
> **直觉**: $\displaystyle a_n  = \frac{(-1)^n}{(n+1)^2}$ 的极限为0.
> 
> **证明**: 对于任意给定的 $\varepsilon > 0$, 要找到 $N$ 使得 $\displaystyle \left| \frac{(-1)^n}{(n+1)^2} - 0\right| = \frac{1}{(n+1)^2}< \varepsilon$, 取 $N = \left[ \sqrt{1/ \varepsilon}\right]$, 可知当 $n > N$ 时, 总有 $|a_n - 0| < \varepsilon$. 因此 $\displaystyle \lim_{n \rightarrow \infty} a_n = 0$.

> [!warning]
> 在极限的概念里, **有限**和**无限**, **动**和**静**交汇到了一起.
> 
> - 任意改变数列的有限多项, 不影响极限的收敛.

> [!caution]
> 
> ==数列极限的几条性质 (了解, 不需要证明)==
> 
> 1. 如果数列 $a_n$ 有极限, 那么它的极限唯一.
> 2. 如果数列 $a_n$ 有极限, 那么数列 $a_n$ 一定有界.
> 3. 如果 $\displaystyle \lim_{n\rightarrow \infty} a_n = A$, 且 $A > 0$, 那么存在正整数 $N$, 当 $n > N$ 时有 $x_n > 0$.
> 4. 如果 $\displaystyle \lim_{n\rightarrow \infty} a_n = A$, 那么 $a_n$ 的任一子数列的极限也是 $A$.

### 函数极限

> [!tip]
> 
> 函数极限跟数列极限本质上都是极限, 都是**动中取静**, 只不过数列极限中动的是 $n$, 而函数极限中动的是自变量 $x$. 之前我们强调过**函数图像**的重要性, 函数的极限过程同样可以通过函数图像来理解. 下面这张图可以作为我们对函数极限的**直觉**, 图中展示了 $\displaystyle \lim_{x\rightarrow 2} f(x) = 4$, 请大家想想在这个极限过程中什么在**动**, 什么是**静**?
>
>  ![函数极限](../media/img/function_limit.png)
>  

> [!note]
> 
> 考虑函数 $\displaystyle f(x) = \frac{\sin(x)}{x}$ 在 $x \rightarrow 0$ 时的极限. 从下面的表格和图像中我们**感觉**_~Gn~_这个极限等于1. 
> 
> *==函数极限举例==*
> | $x$ | $\displaystyle \frac{\sin(x)}{x}$|
> |:--:|:--:|
> |1|0.841471...|
> |0.1|0.998334...|
> |0.01|0.999983...|
> 
> ![函数图像](../media/img/sinx_over_x.png#200h)
> 

> [!warning]
>  
> **直觉**_~Rd~_: 所以函数 $\{f(x)\}$ 在 $x\rightarrow x_0$ 时有极限就是, 当 $x$ 足够接近 $x_0$ 时, $f(x)$ 的值无限接近某个数 $A$.
>
> 注意跟数列极限进行对比:
> 数列 $\{a_n\}$ 有极限就是, 当 $n$ 足够大时, $a_n$ 的值无限接近某个数 $A$.

> [!important]
> 
> ==函数极限的定义== (非常重要!!!)
> 
> 设函数 $\{f(x)\}$ 在点 $x_0$ 的某一去心领域内有定义 ( 为了让 $x$ 能够动起来), $A$ 为一常数. 如果**对于任意给定的正数 $\varepsilon$**, **总存在正数 $\delta$**, 使得当 $0 < |x-x_0| < \delta$ 时有
> $$
> |f(x) - A| < \varepsilon,
> $$
> 则称 $A$ 为函数 $\{f(x)\}$ 在 $x_0$ 的**极限**, 记作
> $$
> \lim_{x\rightarrow x_0} f(x) = A.
> $$
> 
> 上述定义可以通过下图来理解
> 
> ![函数极限](../media/img/function_limit_def.jpg)

> [!note]
> 跟数列极限的定义一样, 上面关于函数极限的定义提供了一个**可操作的流程**, 能够将我们关于函数极限的直观**具象化**. 
> 
> 
> ==例1==
> 
> **直觉**: $\displaystyle f(x)  = x^2 + 1$ 在 $x_0=2$ 的极限为5.
> 
> **证明**: 对于任意给定的 $\varepsilon > 0$, 要找到 $\delta$ 使得只要 $0 < |x-2|< \delta$, 总有 
> $$
> \begin{align*}
> \left|f(x) - 5\right| &= \left| x^2+1 - 5\right| \\
> & = \left| x^2 - 4\right| \\
> & = \left| x - 2\right| \left| x + 2\right|  \\
> & < 2.5|x-2| < \varepsilon
> \end{align*}
> $$
> 
> 取 $\displaystyle \delta = \frac{\varepsilon}{2.5}$, 可知当 $0< |x-2|<\delta$ 时, 总有 $|f(x) - 5| < \varepsilon$. 因此 $\displaystyle \lim_{x \rightarrow 2} f(x) = 5$.
> 
> ![函数极限例1](../media/img/function_limit_of_xsquare.png#400h)
>
> ==例2==
> 
> **直觉**: $\displaystyle \frac{\sin(x)}{x}$ 的极限为1.
> 
> **证明**: 根据定义来证明这个极限比较困难, 后面我们会介绍更加强大的方法.
> 
> ![一个重要的函数极限](../media/img/sinx_over_x_full.png#400h)
> 

> [!caution]
> 
> ==函数极限的性质==
> 
> 1. 如果 $\displaystyle \lim_{x\rightarrow x_0}f(x)$ 存在, 则极限唯一.
> 2. 如果 $\displaystyle \lim_{x\rightarrow x_0}f(x) = A$, 则 $f(x)$ 在 $x_0$ 周围有界, 即存在 $M >0$ 和 $\delta > 0$, 使得当 $0< |x-x_0|<\delta$ 时 $|f(x)| < M$ .
> 3. 如果 $\displaystyle \lim_{x\rightarrow x_0}f(x) = A > 0$, 则 $f(x)$ 在 $x_0$ 周围一定大于0, 即存在 $\delta > 0$, 使得当 $0< |x-x_0|<\delta$ 时 $f(x) > 0$.
>

> [!warning]
> 
> ==$\varepsilon-\delta$ 语言==
> 
> 本章的主要内容是*`数列极限`*和*`函数极限`*的**定义**, 在数学上我们也把这套定义极限的方法称为 $\varepsilon-N$ 语言 (数列) 或 $\varepsilon-\delta$ 语言 (函数). 这样的定义看似繁缛, 但只有这样才能把极限的本质说清楚. 初学者不要怕麻烦, 做题时应该一字一句的把极限的定义写清楚. 怕麻烦不想写字的同学, 在熟练掌握了极限的定义之后, 可以使用两个约定的缩写符号:
> 
> 1. $\forall$: **对于任意**_~Rd~_
> 2. $\exist$: **存在**_~Rd~_
> 
> 使用这两个符号, 数列极限和函数极限的定义可以写成下面的形式 (仅仅是少几个字而已).
> 
> ==数列极限的定义==
> 
> $\displaystyle \lim_{n\rightarrow \infty} a_n = A \iff  \forall \varepsilon > 0$, $\exist N$, s. t., $\ |a_n - A| < \varepsilon$ if $n > N$.
> 
> ==函数极限的定义==
> 
> $\displaystyle \lim_{x\rightarrow x_0} f(x) = A \iff \forall \varepsilon > 0$, $\exist \delta$, s. t., $|f(x) - A| < \varepsilon$ if $0 < |x-x_0| < \delta$.
> 

> [!warning]
> 
> ==对无穷大的描述==
> 
> 我们有时候会说一个数列或函数**趋于无穷大**, 也会写 $\displaystyle \lim_{n\rightarrow \infty} a_n = \infty$ 或 $\displaystyle \lim_{x\rightarrow x_0} f(x) = \infty$, 请注意, 这只是一种**习惯**上的说法, 并**不是**_~Rd~_真正意义上的 (有限的) 极限. 尽管如此, 我们可以借用类似 $\varepsilon-N$ 语言的做法来从数学上定义什么叫**趋于无穷大**, 例如:
> 
> 
> **数列趋于无穷大**
> 
> $\displaystyle \lim_{n\rightarrow \infty} a_n = \infty \iff  \forall M > 0$, $\exist N$, s. t., $|a_n| > M$ if $n > N$.
> 
>**函数趋于无穷大**
> 
> $\displaystyle \lim_{x\rightarrow x_0} f(x) = \infty \iff \forall M > 0$, $\exist \delta$, s. t., $|f(x)| > M$ if $0 < |x-x_0| < \delta$.
> 

### 极限的运算

> [!tip]
> 
> 这一讲我们主要关心如何计算极限.
> 
> - 对于一些简单的极限计算, 每次都用直觉和 $\varepsilon-\delta$ 语言来计算极限太繁琐, 也没有必要. 很多时候**极限的四则运算**能够帮上大忙.
> - 有一些困难的极限问题, 我们需要跟强大的数学结论和工具, 本讲介绍的**三明治定理**和**单调有界数列有极限**请收好.
>
> 注意, 本讲的性质和定理全部都建立在上一讲**极限定义**的基础之上, 其根本还是 $\varepsilon-\delta$ 语言.
> 

> [!warning]
>
> ==希尔伯特的旅店==
>
> 极限运算涉及到了**无限**_~Rd~_的概念, 对初学者来说这是一个之前从未踏足过的位置领域, 一些**有限世界中的直觉**将不再成立. **希尔伯特的旅店**是一个有趣的故事, 通过这个故事希望能让大家对**无限**_~Rd~_有一颗**敬畏之心**.
>
> [待补充]

> [!important]
>
> **数列极限四则运算**
> 
>  *`加减法`*: 如果 $\displaystyle \lim_{n\rightarrow \infty}a_n = A$, $\displaystyle \lim_{n\rightarrow \infty}b_n = B$, 则 $\displaystyle \lim_{n\rightarrow \infty}[a_n \pm b_n]= A \pm B$.
>  **证明**:  
>  对任意 $\varepsilon > 0$，存在 $N_1$ 使当 $n > N_1$ 时 $|a_n - A| < \frac{\varepsilon}{2}$，  
>  存在 $N_2$ 使当 $n > N_2$ 时 $|b_n - B|$ < $\frac{\varepsilon}{2}$。  
>  取 
> 
>  $|(a_n \pm b_n)$ - $(A \pm B)$| $\leq |a_n - A|$ + $|b_n - B|$ < $\varepsilon$.
>  
> 
>  *`乘法`*: 如果 $\displaystyle \lim_{n\rightarrow \infty}a_n = A$, $\displaystyle \lim_{n\rightarrow \infty}b_n = B$, 则 $\displaystyle \lim_{n\rightarrow \infty}a_nb_n = AB$.
>  **证明**:  
>  关键分解：\|$a_nb_n - AB$|$ = $|$a_nb_n - Ab_n + Ab_n - AB|$ $\leq $|$b_n||a_n - A| + |A||b_n - B$|  
>  因\{$b_n\}$收敛，故存在M>0使|$b_n|\leq M$  
>  对$\varepsilon > 0$，取$N_1$使当$n>N_1$时$|a_n-A|<\frac{\varepsilon}{2M}$  
>  取$N_2$使当$n>N_2$时$|b_n-B|<\frac{\varepsilon}{2|A|+1}$  
>  取$N=\max\{N_1,N_2\}$，则当$n>N$时：  
>  $|a_nb_n - AB| < \frac{\varepsilon}{2} + \frac{\varepsilon}{2} = \varepsilon$
> 
>  *`除法`*: 如果 $\displaystyle \lim_{n\rightarrow \infty}a_n= A$, $\displaystyle \lim_{n\rightarrow \infty}b_n = B$, 且 $B \ne 0$, 则 $\displaystyle \lim_{n\rightarrow \infty}\frac{a_n}{b_n}= \frac{A}{B}$.
>  **证明**:  
>  先证$\varepsilon > 0，取$$N_2$使当$n>N_2$时$|b_n-B|<\frac{\varepsilon B^2}{2}$  
>  则当$n>\max\{N_1,N_2\}$时：  
>  $\left|\frac{1}{b_n} - \frac{1}{B}\right| = \frac{|b_n - B|}{|b_nB|} < \frac{2}{|B|^2} \cdot \frac{\varepsilon B^2}{2} = \varepsilon$ 
>  再结合乘法法则即得结论。

> [!important]
>
> **函数极限四则运算**
> 
>  *`加减法`*: 如果 $\displaystyle \lim_{x\rightarrow x_0}f(x) = A$, $\displaystyle \lim_{x\rightarrow x_0}g(x) = B$, 则 $\displaystyle \lim_{x\rightarrow x_0}[f(x) \pm g(x)]= A \pm B$.
>  **证明**：
> 
>  对任意$\varepsilon > 0$，由 $lim_{x \to x_0} f(x) = A$，存在 $\delta_1$ > 0，  
>  使得当 $0 < |x - x_0| < \delta_1$ 时，$|f(x) - A| < \frac{\varepsilon}{2}$  
> 
>  由 $\lim_{x \to x_0} g(x) = B$，存在 $\delta_2 > 0$，  
>  使得当 $0 < |x - x_0| < \delta_2$ 时，$|g(x) - B| < \frac{\varepsilon}{2}$  
> 
>  取 $\delta = \min\{\delta_1, \delta_2\}$，则当 $0 < |x - x_0| < \delta$ 时：  
>  $
>  |[f(x) \pm g(x)] - [A \pm B]| \leq |f(x) - A| + |g(x) - B| < \varepsilon
>  $

> [!important]
> 
>  *`乘法`*: 如果 $\displaystyle \lim_{x\rightarrow x_0}f(x) = A$, $\displaystyle \lim_{x\rightarrow x_0}g(x) = B$, 则 $\displaystyle \lim_{x\rightarrow x_0}f(x)g(x)= AB$.
>  **证明**：
> 
>  对任意$\varepsilon > 0$，由 $\lim_{x \to x_0} f(x) = A$，存在 $\delta_1 > 0$，  
>  使得当 $0 < |x - x_0| < \delta_1$ 时，$|f(x) - A| < \frac{\varepsilon}{2}$  
> 
>  由 $\lim_{x \to x_0} g(x) = B，存在 \delta_2 > 0$，  
>  使得当 $0 < |x - x_0| < \delta_2$时，$|g(x) - B| < \frac{\varepsilon}{2}$  
> 
>  取 $\delta = \min\{\delta_1, \delta_2\}，则当 0 < |x - x_0| < \delta$ 时：  
>  $|[f(x) \pm g(x)] - [A \pm B]| \leq |f(x) - A| + |g(x) - B| < \varepsilon
>  $

> [!important]
> 
>  *`除法`*: 如果 $\displaystyle \lim_{x\rightarrow x_0}f(x) = A$, $\displaystyle \lim_{x\rightarrow x_0}g(x) = B$, 且 $B \ne 0$, 则 $\displaystyle \lim_{x\rightarrow x_0}\frac{f(x)}{g(x)}= \frac{A}{B}$.
> 
>  **证明**：
> 
>  先证 $\lim_{x \to x_0} \frac{1}{g(x)} = \frac{1}{B}$：  
> 
>  由 $\lim_{x \to x_0} g(x) = B \neq 0，存在 \delta_1 > 0使当 0 < |x - x_0| < \delta_1时，|g(x)| > \frac{|B|}{2}$  
> 
>  - 对任意$\varepsilon > 0$，取 $\delta_2 > 0 使当 0 < |x - x_0| < \delta_2$ 时：  
>    $
>    |g(x) - B| < \frac{\varepsilon B^2}{2}
>    $ 
>  - 取 $\delta = \min\{\delta_1, \delta_2\}$，则当 $0 < |x - x_0| < \delta$ 时：  
>    $
>    \left| \frac{1}{g(x)} - \frac{1}{B} \right| = \frac{|g(x) - B|}{|g(x)B|} < \frac{2}{|B|^2} \cdot \frac{\varepsilon B^2}{2} = \varepsilon
>    $
> 
>  2. 再结合乘法法则即得：  
>  $
>     \lim_{x \to x_0} \frac{f(x)}{g(x)} = \lim_{x \to x_0} \left( f(x) \cdot \frac{1}{g(x)} \right) = A \cdot \frac{1}{B} = \frac{A}{B}
>     $
> 

> [!note]
>
> ==极限四则运算的例子==
>
>
>
> **例1**
> 
> 证明 $\displaystyle \lim_{n\rightarrow \infty}\frac{1}{n}=0$
> 
> **证明**：  
> 
>  对任意给定的 $\varepsilon > 0$，我们需要找到正整数 $N$，使得当 $n > N$ 时：  
>  $
>  \left| \frac{1}{n} - 0 \right| = \frac{1}{n} < \varepsilon
>  $ 
> 
>  解不等式 $\frac{1}{n} < \varepsilon$ 得 $n > \frac{1}{\varepsilon}$  
> 
>  取 $N = \left\lfloor \frac{1}{\varepsilon} \right\rfloor + 1$（即不小于 $\frac{1}{\varepsilon}$ 的最小整数）  
> 
>  则当 $n > N$ 时，必有 $\frac{1}{n} < \varepsilon$  
> 
>  由极限定义，$\displaystyle \lim_{n\rightarrow \infty}\frac{1}{n}=0$ 得证  
>  **几何解释**：  
>  当 $n$ 趋近无穷大时，$\frac{1}{n}$ 无限接近于 $0$，如图像 $y=\frac{1}{x}$ 在 $x\to\infty$ 时的渐近线为 $y=0$。
> 
>
> **例2**
> 
> 计算 $\displaystyle \lim_{n\rightarrow \infty}\frac{1}{2n}$
> **解法1（直接法）**：  
> 由 $\displaystyle \lim_{n\rightarrow \infty}\frac{1}{n}=0$ 可得：  
> $
> \lim_{n\rightarrow \infty}\frac{1}{2n} = \frac{1}{2} \cdot \lim_{n\rightarrow \infty}\frac{1}{n} = \frac{1}{2} \times 0 = 0
> $
> **解法2（$\varepsilon-N$ 定义证明）**：  
> 
> 对任意 $\varepsilon > 0$，需存在 $N$ 使得当 $n > N$ 时：  
> $\left| \frac{1}{2n} - 0 \right| = \frac{1}{2n} < \varepsilon
> $ 
> 
> 解不等式得 $n > \frac{1}{2\varepsilon}$  
> 
> 取 $N = \left\lfloor \frac{1}{2\varepsilon} \right\rfloor + 1$  ，则当 $n > N$ 时必满足 $\frac{1}{2n} < \varepsilon$  ，故极限为 $0$
>
> **几何解释**：  
> 数列 $\frac{1}{2n}$ 的收敛速度是 $\frac{1}{n}$ 的一半，但最终都趋于 $0$。
>
> **推广结论**：  
> 对任意常数 $c \neq 0$，有：  
> $
> \lim_{n\rightarrow \infty}\frac{c}{n} = 0
> $
>
> [注] 两种解法分别展示了：  
> （1）利用已知极限的性质  
> （2）严格的 $\varepsilon-N$ 语言验证
>
>
> **例3**
>>
> 计算 $\displaystyle \lim_{n\rightarrow \infty}\frac{1}{n^2}$
>>
> **解法1（夹逼定理法）**：  
> 
> 注意到当 $n \geq 1$ 时：  
> $
> 0 < \frac{1}{n^2} \leq \frac{1}{n}
> $ 
> 
> 已知 $\displaystyle \lim_{n\rightarrow \infty}\frac{1}{n} = 0$  
> 
> 由夹逼定理可得：  
> $
> \lim_{n\rightarrow \infty}\frac{1}{n^2} = 0
> $
> 
> **解法2（$\varepsilon-N$ 定义证明）**：  
>
> 对任意 $\varepsilon > 0$，需存在 $N$ 使得当 $n > N$ 时：  
> $
> \left| \frac{1}{n^2} - 0 \right| = \frac{1}{n^2} < \varepsilon
> $ 
> 
> 解不等式得 $n > \frac{1}{\sqrt{\varepsilon}}$  
> 
> 取 $N = \left\lfloor \frac{1}{\sqrt{\varepsilon}} \right\rfloor + 1$  
> 
> 则当 $n > N$ 时必满足 $\frac{1}{n^2} < \varepsilon$  
> 
> 故极限为 $0$.
>
> **例4**
> 
> 计算 $\displaystyle \lim_{x\rightarrow 1}(2x-1)$
> 
>**解法1（直接代入法）**：  
> 
> 由于 $f(x) = 2x - 1$ 在 $x=1$ 处连续，可直接代入：  
> $\lim_{x\rightarrow 1}(2x-1) = 2(1) - 1 = 1
> $
>
> **解法2（$\varepsilon-\delta$ 定义证明）**：  
> 
> 对任意 $\varepsilon > 0$，需找到 $\delta > 0$ 使得当 $0 < |x-1| < \delta$ 时：  
> $
> |(2x-1) - 1| = 2|x-1| < \varepsilon$ 
> 
> 取 $\delta = \frac{\varepsilon}{2}$，则当 $0 < |x-1| < \delta$ 时：  
> $
> 2|x-1| < 2 \cdot \frac{\varepsilon}{2} = \varepsilon
> $ ，故极限为 $1$
>
> **几何解释**：
> 函数 $y=2x-1$ 是斜率为 $2$ 的直线，在 $x=1$ 处函数值自然趋近于 $1$。
>
> 
> **例5**
> 
> 计算 $\displaystyle \lim_{x\rightarrow 2}\frac{x^3-1}{x^2-5x+3}$
>
> **解法1（直接代入法）**：  
> 
> 分子在 $x=2$ 处的值：$2^3 - 1 = 7$  
> 
> 分母在 $x=2$ 处的值：$2^2 - 5(2) + 3 = -3$  
> 
> 分母不为零，可直接代入：  
> $
> \lim_{x\rightarrow 2}\frac{x^3-1}{x^2-5x+3} = \frac{7}{-3} = -\frac{7}{3}
> $
>
> **解法2（因式分解验证）**：  
> 
> 检查分子分母在 $x=2$ 时是否有公因式：  
> - 分子：$x^3-1 = (x-1)(x^2+x+1)$  
> - 分母：$x^2-5x+3$ 在 $x=2$ 处不为零  
> 
> 确认无零因子相消，直接代入有效
>
> **$\varepsilon-\delta$ 证明思路**：  
> 对于任意 $\varepsilon > 0$，存在 $\delta > 0$ 使得当 $0 < |x-2| < \delta$ 时：  
> $
> \left| \frac{x^3-1}{x^2-5x+3} - \left(-\frac{7}{3}\right) \right| < \varepsilon
> $  
> 可通过控制 $x$ 在 $2$ 附近的范围（如 $\delta < 0.5$）保证分母不为零，再构造不等式。
> 
> **例6**
>
> 计算 $\displaystyle \lim_{x\rightarrow 3}\frac{x-3}{x^2-9}$
>
> **解法1（因式分解法）**：
>
> 识别不定式：直接代入得 $\frac{0}{0}$，需进一步处理
> 
> 因式分解分母：
> $x^2-9 = (x-3)(x+3)
> $
> 
> 约去公因式：
> $
> \frac{x-3}{x^2-9} = \frac{1}{x+3} \quad (x \neq 3)
> $
> 
> 计算简化后的极限：
> $
> \lim_{x\rightarrow 3}\frac{1}{x+3} = \frac{1}{6}
> $

### 两个重要的极限

#### 重要极限一
> [!tip]
> 还记得"割圆法"求圆面积的例子吗? 圆的内接正 $n$ 边形的面积当 $n \rightarrow \infty$ 的极限的计算最后就会落到极限 $\displaystyle \lim_{x\rightarrow 0} \frac{\sin(x)}{x}$ 的计算, 这个极限与圆周率 $\pi$ (**阿基米德数**_~Rd~_)有着深刻的联系.

> [!warning]
> 
> ==圆内接正多边形的面积==

> [!important]
>
> ==三明治定理==
>
> **定理陈述**：  
> 设函数 $f(x), g(x), h(x)$ 在点 $x_0$ 的某去心邻域内满足：  
> 
> 1. $g(x) \leq f(x) \leq h(x)$  
> 2. $\displaystyle \lim_{x\to x_0} g(x) = \lim_{x\to x_0} h(x) = L$  
> 则 $\displaystyle \lim_{x\to x_0} f(x) = L$。  
>
> **数列版本**：  
> 若数列 $\{a_n\}, \{b_n\}, \{c_n\}$ 满足：  
> 1. $b_n \leq a_n \leq c_n$（对充分大的 $n$）  
> 2. $\displaystyle \lim_{n\to\infty} b_n = \lim_{n\to\infty} c_n = L$  
> 则 $\displaystyle \lim_{n\to\infty} a_n = L$。  
>
> **示例**：  
> 证明 $\displaystyle \lim_{x\to 0} x^2 \sin\left(\frac{1}{x}\right) = 0$  
> 
> - 因 $-1 \leq \sin\left(\frac{1}{x}\right) \leq 1$，故 $-x^2 \leq x^2 \sin\left(\frac{1}{x}\right) \leq x^2$  
>- 由 $\displaystyle \lim_{x\to 0} -x^2 = \lim_{x\to 0} x^2 = 0$ 得证  
> 

> [!caution]
>
> **证明** $\displaystyle \lim_{x\rightarrow 0} \frac{\sin(x)}{x} = 1$
> 
> ![一个重要的函数极限](../media/img/sinx_over_x_full.png#400h)
> 
> ##### 几何法证明
> 1. **单位圆构造**：
>   - 考虑单位圆（半径 \( r = 1 \)）中角度 \( x \in (0, \frac{\pi}{2}) \)   - 定义：
>     - \( \sin x \) 为对边长度
>     - \( x \) 为圆弧长度（弧度制）
>     - \( \tan x \) 为切线长度
> 2. **面积比较**：
>    $ \text{面积} \triangle OAP < \text{扇形面积} OAP < \text{面积} \triangle OAT$
>    即：$ \frac{1}{2} \sin x < \frac{1}{2} x < \frac{1}{2} \tan x $
> 3. **化简不等式**：
> $\sin x < x < \tan x \implies 1 < \frac{x}{\sin x} < \frac{1}{\cos x}$
> 取倒数得：$ \cos x < \frac{\sin x}{x} < 1$
> 
> 4. **应用夹逼定理**：
>     $
      \lim_{x \to 0} \cos x = 1 \quad \text{且} \quad \lim_{x \to 0} 1 = 1
      $
      故：
      $
      \lim_{x \to 0} \frac{\sin x}{x} = 1
      $

> [!warning]
> 
> ==注意事项==
> 
> 1. 角度 \( x \) 必须使用弧度制
> 2. 对于 \( x < 0 \) 的情况，利用奇函数性质：
> $
>  \frac{\sin(-x)}{-x} = \frac{\sin x}{x}
>  $
> 3. 该极限是推导三角函数导数的基础

#### 重要极限二
> [!tip]
> 
> 极限 $\displaystyle \lim_{n\rightarrow \infty} \left(1+\frac{1}{n}\right)^{n}$ 与无理数 $\mathrm{e}$ (**欧拉数**_~Rd~_)有密切的联系. Jacob Bernoulli 于1683年在研究**复利**的时候考虑过这个数列的极限.
> 
> ==复利与无理数 $\mathrm{e}$==
> 
> ![Jakob Bernoulli](../media/img/Jakob_Bernoulli.jpg#400h)
> 
> **雅各布·伯努利与数e的发现**
>
> **雅各布·伯努利**（Jacob Bernoulli，1654-1705）在研究**复利计算**时发现, 
> - 年复利 → 2.00美元  
> - 半年复利 → 2.25美元  
> - 日复利 → ≈2.7146美元  
> 最终确定极限值 ≈ 2.7182818
> 发现常数**e**：  
> $$
> e = \lim_{n \to \infty} \left(1 + \frac{1}{n}\right)^n
> $$
> ![数列的值](../media/img/limit_to_e.png#400h)

> [!important]
> 
> ==单调有界数列有极限==
>

> [!note]
> **证明** $\displaystyle \lim_{n\rightarrow \infty} \left(1+\frac{1}{n}\right)^{n} = \mathrm{e}$
>
> 1. **单调性证明**：
>    - 使用二项式定理展开：
>    $
>    \left(1+\frac{1}{n}\right)^n = \sum_{k=0}^n \binom{n}{k}\frac{1}{n^k}
>    $
>    - 通过比较相邻项证明数列单调递增
>
> 2. **有界性证明**：
>    - 证明展开式小于3：
>    $
>    \left(1+\frac{1}{n}\right)^n < 1 + 1 + \frac{1}{2!} + \cdots + \frac{1}{n!} < 3
>    $
>
> 3. **极限存在性**：
>    - 由单调有界定理，极限存在
>    - 定义该极限为e

> [!note]
>
> **证明** $\displaystyle \lim_{x\rightarrow 0} \left(1+x\right)^{\frac{1}{x}} = \mathrm{e}$
>
>    对任意小的\( x \)，取整数\( n \)使得：
>    $\frac{1}{n+1} \leq x \leq \frac{1}{n}
>    $
>    - 建立不等式：
>       $
>       \left(1+\frac{1}{n+1}\right)^n \leq (1+x)^{1/x} \leq \left(1+\frac{1}{n}\right)^{n+1}
>       $
>    - 当$ x \to 0 $时$ n \to \infty $，两边极限均为$e$. 

> [!warning]
>
> 可以证明 
>
> $$
> \mathrm{e} = 1 + \frac{1}{1!} + \frac{1}{2!} + \cdots + \frac{1}{n!} + \cdots
> $$
>
> 证明的方法也是用**单调有界数列有极限**.
>
> 中学学过**导数**的同学可以算一下展开式
>
> $$
> \mathrm{e}^x = 1 + \frac{x}{1!} + \frac{x^2}{2!} + \cdots + \frac{x^n}{n!} + \cdots
> $$
> 
> 的导数, 看看会发现什么有趣的现象?

### 复合函数的极限

> [!tip] 
> 
> 下面的结论相当于极限运算中的换元法, 在计算极限的时候十分有用.
> 

> [!caution]
> 
> 假设 $y=f[g(x)]$,  $\displaystyle \lim_{x\rightarrow x_0}g(x) = u_0$, $\displaystyle \lim_{u\rightarrow u_0}f(x) = A$, 则 $\displaystyle \lim_{x\rightarrow x_0}f[g(x)] = A$.
> 
> 这个结论请自行根据直觉理解, 证明略.
>

> [!note]
>
> 综合运用*`极限的定义`*, *`极限的四则运算`*和*`复合函数的极限 (换元法)`*, 以及*`三明治定理`*和*`单调有界数列有极限`*等结论, 我们现在可以计算很多数列和函数的极限.
>
>
> **例1**
> 
> $\displaystyle \lim_{x\rightarrow 0}\frac{\tan(x)}{x}$ (P48: 例1)
> 
> 解：$\displaystyle \lim_{x \rightarrow 0} \frac{\tan (x)}{x}= \lim_{x \rightarrow 0} \left( \frac{\sin (x)}{x} \cdot \frac{1}{\cos (x)} \right) = \left( \lim_{x \rightarrow 0} \frac{\sin (x)}{x} \right) \cdot \left( \lim_{x \rightarrow 0} \frac{1}{\cos (x)} \right)=1$.
>
> **例2**
> 
> $\displaystyle \lim_{x\rightarrow 0}\frac{1-\cos(x)}{x^2}$ (P48: 例2)
> 
> 解：$\displaystyle \lim_{x \rightarrow 0} \frac{1 - \cos (x)}{x^{2}} = \lim_{x \rightarrow 0} \left( \frac{\sin^{2}(x)}{x^{2}} \cdot \frac{1}{1 + \cos (x)} \right)= \lim_{x \rightarrow 0} \left( \frac{\sin (x)}{x} \right)^{2} \cdot \lim_{x \rightarrow 0} \frac{1}{1 + \cos (x)} = \frac{1}{2}$.
>
>
> **例3**
> 
> $\displaystyle \lim_{x\rightarrow 0}\frac{\arcsin(x)}{x}$ (P48: 例3)
> 
> 解：$t = \arcsin (x)$，则 $x = \sin t$，当 $x \to 0$ 时，有 $t \to 0$.  于是由复合函数的极限运算法则得：$\displaystyle \lim_{x \to 0} \frac{\arcsin (x)}{x} = \lim_{t \to 0} \frac{t}{\sin (t)} = 1$.
>
> **例4**
> 
> $\displaystyle \lim_{x\rightarrow \infty}\left( 1-\frac{1}{x}\right)^{x}$ (P51: 例4)
> 
> 解：令 $t = -x$，则当 $x \to \infty$ 时，$t \to -\infty$.  于是
> $\displaystyle \lim_{x \to \infty} \left( 1 - \frac{1}{x} \right)^{x} = \lim_{t \to -\infty} \left( 1 + \frac{1}{t} \right)^{-t} = \lim_{t \to -\infty} \frac{1}{\left( 1 + \frac{1}{t} \right)^{t}} = \frac{1}{e}$.
>
> **例5**
> 
> $\displaystyle \lim_{x\rightarrow 0}\frac{\tan (2x)}{\sin (5x)}$ (P55: 例3)
> 
> 解：当 $ x \rightarrow 0 $ 时，$\tan (2)x \sim 2x$，$\sin (5x) \sim 5x$，所以  $\displaystyle \lim_{x \rightarrow 0} \frac{\tan (2x)}{\sin (5x)} = \lim_{x \rightarrow 0} \frac{2x}{5x} = \frac{2}{5}$.
>
> **例6**
> 
> $\displaystyle \lim_{n\rightarrow \infty}\frac{\sqrt{n^2 + a^2}}{n}$ (习题1-2: 5(3))
> 
> - 方法一: 用定义证明.
> 解：当 $ a = 0 $ 时，所给数列为常数列，显然有此结论.以下设 $a ≠ 0$.
> 由不等式变形：
> $$\begin{aligned}\left| \frac{\sqrt{n^2 + a^2}}{n} - 1 \right|&= \frac{\sqrt{n^2 + a^2} - n}{n} \\&= \frac{a^2}{n(\sqrt{n^2 + a^2} + n)} \\&< \frac{a^2}{2n^2}\end{aligned}$$
> 要使 $\displaystyle \left| \frac{\sqrt{n^2 + a^2}}{n} - 1 \right| < \varepsilon $，只需满足：$\displaystyle \frac{a^2}{2n^2} < \varepsilon \quad \Rightarrow \quad n > \frac{|a|}{\sqrt{2\varepsilon}}$.
> 取 $ \displaystyle \ N = \left\lceil \frac{|a|}{\sqrt{2\varepsilon}} \right\rceil $，则当 $ n > N $ 时，有：$\displaystyle \lim_{n \to \infty} \frac{\sqrt{n^2 + a^2}}{n} = 1$
> 
> - 方法二: 用极限运算和复合函数的极限证明.
> 解：约简分式为：$ \displaystyle \frac{\sqrt{n^{2} + a^{2}}}{n} = \sqrt{\frac{n^{2} + a^{2}}{n^{2}}} = \sqrt{1 + \frac{a^{2}}{n^{2}}} $
> 设两个基本函数：内层函数：$\displaystyle \ f(n) = 1 + \frac{a^{2}}{n^{2}}$ ，外层函数：$g(x) = \sqrt{x}$ 
> 原极限可表示为复合函数：$\displaystyle \lim_{n \to \infty} \frac{\sqrt{n^{2} + a^{2}}}{n} = \sqrt{\lim_{n \to \infty} \left(1 + \frac{a^{2}}{n^{2}}\right)}$
> 利用基本极限性质：$\displaystyle\lim_{n \to \infty} \frac{a^2}{n^2} = a^2 \cdot \lim_{n \to \infty} \frac{1}{n} \cdot \lim_{n \to \infty} \frac{1}{n} = 0$
因此：$\displaystyle\lim_{n \to \infty} f(n) = 1 + 0 = 1$
> 因外函数 $ g(x) = \sqrt{x} $ 在 $ x = 1 $ 处连续，满足：$\displaystyle\lim_{x \to L} g(x) = g(L)$
> 代入内部极限结果：$\displaystyle\lim_{n \to \infty} \sqrt{1 + \frac{a^2}{n^2}} = g(1) = \sqrt{1} = 1$
> 

## 连续函数

> [!tip]
> 
> 我们研究**极限**的一个出发点是为了研究*`函数的极大值极小值`*或*`曲线包含区域的面积`*, 要实现这一目的我们还需要引入*`微分`*和*`积分`*等数学工具, 这是后面几章的内容, 所以我们离这个目标还有一定的距离. 但是, 仅用极限的概念, 我们也能初步刻画曲线 (或函数) 本身的一些基本性质, 比如这一讲要讲的**连续性**_~Rd~_.

### 连续和间断

> [!tip]
> 
> 所谓**连续函数**, 直白的说就是能笔不离开纸面一气画出来的函数, 下面我们就来运用**极限**的概念把这个**连续的直观**_~Rd~_给**数学化**.

> [!important]
> 
>
> 
> ==函数在某一点的连续==
> 
> 若 $\displaystyle \lim_{x\rightarrow x_0}f(x) = f(x_0)$, 则称 $f(x)$ 在 $x_0$ 处连续.
>
> ==连续函数==
> 
> 如果函数在某个区域上**每一点都连续**, 则称 $f(x)$ 是该区域上的**连续函数**.
>

> [!note]
> 
> ==连续函数==
> 
>
>
> **例1 $f(x) = |x|$**
> 
>  $f(x)$ 在 $(-\infty, +\infty)$ 上连续.
> 
> ![绝对值函数](../media/img/chap1_5.1.1.png#200h)
> 
> **例2: $\displaystyle f(x) = \frac{1}{|x|}$**
> 
>  $f(x)$ 在 $(-\infty,0)\bigcup (0, +\infty)$ 上连续, 但是在 0 点处不连续.
> 
> ![绝对值的倒数](../media/img/chap1_5.1.2.png#200h)
> 

> [!caution]
> 
> ==间断函数==
> 
> 不连续的函数就是**间断函数**. 间断函数一定有某处是不连续的, 造成不连续的原因很多, 其中有些间断点还能够被挽救回来变成连续的 (**可去间断点**), 有些则挽救不回来. 


> [!note]
>
> ==间断函数的例子==
>
>
>
> **例3 $\displaystyle f(x) = \frac{\sin(x)}{x}$**
> 
> 这个函数在 $x=0$ 处不连续, 造成不连续的原因是 $f(0)$ 没有定义, 从而 $\displaystyle \lim_{x\rightarrow 0} f(x) = f(0)$ 无从说起. 幸运的是, $f(x)$ 在 $x=0$ 处的极限等于1, 只要令 $f(0) = 1$ 就可以让 $f(x)$ 在0点也连续了, 从而**改良**后的 $f(x)$ 对任意 $x \in (-\infty, \infty)$ 都连续.
>
> **例4: $f(x)=\displaystyle \sin\left(\frac{1}{x}\right)$**
> 
> $f(x)$ 在 $x=0$ 点处不连续. 造成不连续的原因跟*`例3`*一样也是 $f(0)$ 没有定义. 不幸的是,  $f(x)$ 在 $x=0$ 处无限震荡, 没有极限, 所以这个函数没法像*`例3`*一样简单的补上一个点就成为连续函数.
> 
> ![震荡函数](../media/img/chap1_5.1.3.png#200h)
>

> [!caution]
>
> ==单侧极限==
>
> - **左连续**(注意极限记号下方的 $-$ 号)
> 
> $\displaystyle \lim_{x\rightarrow x_0^-} f(x) = A \iff \forall \varepsilon > 0$, $\exist \delta>0$, s. t., $|f(x) - A| < \varepsilon$ if $-\delta < x-x_0 < 0$.
> 
> - **右连续**(注意极限记号下方的 $+$ 号)
>
> $\displaystyle \lim_{x\rightarrow x_0^+} f(x) = A \iff \forall \varepsilon > 0$, $\exist \delta>0$, s. t., $|f(x) - A| < \varepsilon$ if $0 < x-x_0 < \delta$.
>
> 造成函数 $f(x)$ 在 $x=x_0$ 处的极限不存在的一个常见原因是 $f(x)$ 的**左右极限不相等**.



> [!note]
> 
> ==更多间断函数的例子==
> 
>
> 
> **例5: 符号函数 $\mathrm{sgn}(x)$**
> 
> $$
\mathrm{sgn}(x) = \begin{cases}
> 1,  & \text{if $x>0$}, \\
> 0, & \text{if $x=0$}, \\
> -1, & \text{if $x<0$}.
> \end{cases}
> $$
> 该函数在 $x_0=0$ 处不连续, 造成不连续的原因是函数在该点的左极限 ($x$ 从左往右趋于0) 等于 $-1$, 右极限 ($x$ 从右往左趋于0) 等于 $1$, 左右极限不相等. 这种情况也没有办法通过简单的修改 $f(0)$ 的值来让函数连续.
> 
> **例6: $\displaystyle f(x) = \frac{1}{|x|}$**
> 
>  $f(x)$ 在 $x=0$ 点处不连续, 造成不连续的原因是 $f(0)$ 没有定义, 而且 $f(x)$ 在 $x=0$ 左右极限都趋于无穷大, 没有 (有限的) 极限. 这种情况也没有办法通过简单的修改 $f(0)$ 的值来让函数连续.
> 

> [!warning]
> 
> 函数的连续性是一个很**自然**的性质, 我们所感受到的世界就是连续的: 物体运动的轨迹, 温度的变化, 甚至计算机里的0-1也是用连续函数来近似的. 
> - 在做**目标追踪**问题的时候, 连续是一个很重要的**先验**; 
> - 在求解**物理方程**的时候, 解的连续性是一个很重要的**约束**;
> - 在人工智能里, 连续性是解决高维问题的一个**核心底层逻辑**.


### 闭区间上连续函数的性质

> [!tip]
> 
> 闭区间上的连续函数是函数中的**乖宝宝**_~Gn~_, 因为这类函数的值总是可以被**控制**住.
> 

> [!important]
> 
> ==闭区间上连续函数的定义==
> 
> 如果函数 $f(x)$ 在 $(a, b)$ 内连续, 在 $a$ 处右连续, 在 $b$ 处左连续, 则 $f(x)$ 是闭区间 $[a, b]$ 上的连续函数.
> 


> [!important]
>  
> **维尔斯特拉斯 (Weierstrass) 极值定理/极大极小值定理**
> 
> 闭区间 $[a, b]$ 上的连续函数有界, 且至少有一点 $x_1 \in [a, b]$ 使得 $f(x_1)$ 是 $f(x)$ 在 $[a, b]$ 上的最大值, 也至少有一点 $x_2 \in [a, b]$ 使得 $f(x_2)$ 是 $f(x)$ 在 $[a, b]$ 上的最小值. 

> [!warning]
>
> ==Karl Weierstrass==
>
> ![Karl Weierstrass](../media/img/karl_weierstrass.jpeg#400h) 
>

> [!note]
>
> ==两个反例==
>
> **例1: $\displaystyle f(x) = \frac{1}{x}$ **
> 
> 在闭区间$[-1,1]$上, $f(x)$ 在 $x=0$ 处不连续, 因为 $f(0)$ 没有定义. 因此, $f(x)$ 在 $[-1,1]$ 上的连续性是不成立的. 违反维尔斯特拉斯极值定理，$f(x)$ 在闭区间$[-1,1]$上无界，当$x \to 0$ 时，$\displaystyle \lim_{x \to 0} |f(x)| \to +\infty$,不存在最大值和最小值.
>
> 
> **例2: 符号函数**
> 
> $$\mathrm{sgn}(x) = \begin{cases}
> 1,  & \text{if $x>0$}, \\
> 0, & \text{if $x=0$}, \\
> -1, & \text{if $x<0$}.
> \end{cases}$$
> 符号函数在闭区间$[-1, 1]$上不连续，因为在$x=0$处，符号函数的左右极限不相等。
> 

> [!important]
> 
> **布尔查诺 (Bolzano) 定理/介值定理**
> 
> 设闭区间 $[a, b]$ 上的连续函数 $f(x)$ 在端点的值分别为 $f(a) < 0$, $f(b) > 0$, 则一定存在 $x_0 \in [a, b]$ 使得 $f(x_0) = 0$.
> 

> [!warning]
>
> ==Bernard Bolzano==
> 
> ![Bernard Bolzano](../media/img/bernard_bolzano.jpeg#400h)
> 

> [!note]
>
> **例1：证明方程 $x^{3} - 4x^{2} + 1 = 0$ 在区间 $(0,\,1)$ 内至少有一个根**
> 
> 证明：函数 $f ( x ) = x ^ { 3 } - 4 x ^ { 2 } + 1$ 在闭区间 $[0，1]$上连续，又$f ( 0 ) = 1 >0$，$f ( 1 ) = - 2< 0$.
> 根据介值定理，在 $(0，1)$内至少有一点 $ξ$，使得 $f ( η ) = 0$.
即 $ ξ ^{3 }- 4 ξ ^{ 2 } + 1 = 0$ $\quad$ $(0<ξ<1)$.
这等式说明方程 $x ^ { 3 } - 4 x ^ { 2 } + 1 = 0$ 在区间(0，1)内至少有一个根是 $ξ$． 
>
> **习题1:  设函数$f ( x )$ 在闭区间 $[ a，b ]$ 上连续，且满足$a ≤ f ( x ) ≤ b$ 对所有$x \in [ a,b ]$ 成立. 证明：存在 $c \in [ a,b ]$，使得$f ( c ) = c$**
> 
> 借助**介值定理**可以很容易证明上述定理, 其中的 $c$ 也称为函数 $f(x)$ 的不动点.

---
title: 高等数学讲义
author: 胡煜成
description: 首都师范大学高等数学A
"og:description": 浏览器版和手机版
"og:image": https://vlook-doc.pages.dev/pic/vlook-og.png
keywords:
- 高等数学,微积分,讲义
vlook-chp-autonum: h1=off
vlook-query: vdl=on, ws=off
---


[toc]

# 导数

> [!tip]
> 
> ==导数是一种通过极限定义的运算==
> 
> 实际问题中人们经常会考虑某个函数的**极值**, 函数的**切线方向**是分析函数极值的有力工具: 
> - 切线斜率为正时函数单调递增
> - 切线斜率为负时函数单调递减
> - 切线斜率为零时函数取到极值
>
> 那么怎么求函数在某处**切线的斜率**呢? 这个问题困扰了数学家好多年, 直到后来有人发现**切线斜率可以看作是一个极限**, 这个极限也叫做**导数**.
> 
> 由此我们也可以进一步体会到**极限**的重要性. 而在后面的章节中, 我们会再次运用**极限**来构造**积分**. 因此极限的概念相当于整个微积分的基础. 
> 
> 右图给出了课本各部分内容之间的关系.
> 
> ==思维导图==
> 
> ![微积分思维导图](../media/img/chpt2_derivative.png#400h)

## 导数和导函数

> [!tip]
>
> - 导数是函数的**瞬时变化率**.
> - 导数是函数某处的**切线斜率**.
> 
>  ==**导数**是研究函数性质的重要工具==
> 
>  **问题**: 计算 $\displaystyle f(x) = \sin(x) - \frac{2x}{\pi}$在$\displaystyle [0,{\pi}]$的最大值.
> 
>  **求解**: 函数 $f(x)$ 的图像如下图, 问题要求我们找到图像的最高点. 运用导数我们可以很方便的得到最高点的坐标, 我们中学学过: 函数在一点的导数等于函数图像在这一点处的切线斜率, 从图像上看函数的最大值对应切线水平(即斜率为0)的位置. 因此我们可以对函数求导, 得到：
> $$
> \displaystyle f'(x) = \cos(x) - \frac{2}{\pi}.
> $$
> 令 $f'(x) = 0$，所得的解处的切线斜率为0, 由此解得极值点：
> $$
> \displaystyle x^* = \arccos\left(\frac{2}{\pi}\right),
> $$
> 所对应的函数值为 $\displaystyle f(x^*)$.
>  
>  ![导数的作用](../media/img/chap2_0.png)

### 导数的定义

> [!important]
>
> 
>  ==导数的定义==
>
> 导数是切线的斜率，而切线的斜率可以定义为割线斜率在割点趋于该点时的极限。
> 
> 设函数 $f(x)$ 在点 $x_0$ 附近有定义，则过点 $(x_0, f(x_0))$ 和 $(x_0 + \Delta x, f(x_0 + \Delta x))$ 的割线斜率为 $\displaystyle \frac{f(x_0 + \Delta x) - f(x_0)}{\Delta x}$, 当 $\Delta x \to 0$ 时，这个割线斜率的极限（若存在）就是切线的斜率，也即导数：
> $$
> f'(x_0) = \lim_{\Delta x \to 0} \frac{f(x_0 + \Delta x) - f(x_0)}{\Delta x} =\lim_{\Delta x \to 0} \frac{\Delta y}{\Delta x}.
> $$
> 这样，切线的斜率和导数都通过极限的方式被严格定义。

>  ![导数的几何意义](../media/img/derivative.png)
>  

> [!extension]
>
> ==切线的数学定义==
> 
> 早期，古希腊数学家如欧几里得和阿波罗尼斯主要用几何方法描述切线，把切线看作“只与曲线在一点相交且不过该点的直线”。但这种定义对复杂曲线（如圆外的曲线）不适用。
> 
> 直到17世纪，笛卡尔和费马等人提出了代数方法，尝试用斜率和代数方程描述切线。牛顿和莱布尼茨发明微积分后，才用“割线的极限”来严格定义切线斜率，也就是现代导数的定义。
> 
> 所以，现代切线的定义必须依靠极限，因为只有极限才能精确描述“割线趋近于切线”的过程，从而适用于所有光滑曲线。没有极限，切线的定义就不够一般和严密。
>

> [!note]
> 
> ==由定义计算导数==
> 
> 
> 
>  ==例1==
>  
>  **求 $f(x) = C$ 在 $x_0=1$ 处的导数.**
> 
>  解：根据导数的定义：
> $$
> f'(1) = \lim_{\Delta x \to 0} \frac{f(x_0 + \Delta x) - f(x_0)}{\Delta x} = \lim_{\Delta x \to 0} \frac{C - C}{\Delta x} = \lim_{\Delta x \to 0} \frac{0}{\Delta x} = 0.
> $$
> 
>  ==例2==
>  
>  **求 $f(x) = x^2$ 在 $x_0=2$ 处的导数.**
>  
> 解：根据导数的定义：
> 
> $$
> \begin{align*}
> \displaystyle f'(2) &= \lim_{\Delta x \to 0} \frac{(2 + \Delta x)^2 - 2^2}{\Delta x} \\ 
> & = \lim_{\Delta x \to 0} \frac{4 + 4\Delta x + (\Delta x)^2 - 4}{\Delta x} \\
> & = \lim_{\Delta x \to 0} \frac{\Delta x(4 + \Delta x)}{\Delta x} \\
> & = \lim_{\Delta x \to 0} (4 + \Delta x) \\
> & = 4
> \end{align*}
> $$

### 导函数

> [!tip]
> 
> 对函数 $f(x)$ 定义域上的每一点都求导 (假设每一点的导数都存在), 得到一个新的函数, 称为**导函数**, 记作 $f'(x)$. 导函数是由 $f(x)$ **衍生**出来的, 正好和 Derivative (导数) 的意思一致.


> [!extension]
>
> ==Derivative(金融衍生品)==
>
> 数学中的“导数”（Derivative）是由原函数“衍生”出来的新函数，反映原函数的变化率。
>
> 金融中的“衍生品”（Derivative）是指价值依赖于其他基础资产（如股票、债券等）的金融工具。期权（Option）是一种金融衍生品，允许持有者以指定价格来购买股票。
> - 如果股票价格上涨（函数递增），看涨期权的价值增加（导数为正）。
> - 如果股票价格下跌（函数递减），看涨期权的价值减少（导数为负）。
>
> 类比：
> - 数学导数：$f'(x)$ 依赖于 $f(x)$，描述 $f(x)$ 的变化率，是由 $f(x)$ “衍生”出来的。
> - 金融期权：期权的价格依赖于股票价格，是由股票“衍生”出来的金融产品。
> 
> [!note]
>
>  ==例3==
>  
>  **求函数 $f(x) = x^2$ 的导函数.**
>  
>  解： 
> $$
> \begin{align*}
> f'(x) & = \lim_{\Delta x\to 0} \frac{(x+\Delta x)^2 - x^2}{\Delta x}\\
> & = \lim_{\Delta x\to 0} \frac{2x\Delta x + \Delta x^2}{\Delta x} \\
> & = \lim_{\Delta x\to 0} 2x + \Delta x \\
> & = x.
> \end{align*}
> $$
>
>  ==例4(P78例4)==
>  
>  **求函数 $f(x) = \cos x$ 的导数.**
>
>  解：
> $$
> \begin{align*}
> f'(x) & = \lim_{\Delta x \to 0} \frac{\cos(x + \Delta x) - \cos x}{\Delta x} \\
> & = \lim_{\Delta x \to 0} \frac{-2 \sin\left( x + \frac{\Delta x}{2} \right) \sin\left( \frac{\Delta x}{2} \right)}{\Delta x} \\
> & = - \lim_{\Delta x \to 0} \sin\left( x + \frac{\Delta x}{2} \right) \cdot \lim_{\Delta x \to 0} \frac{\sin\left( \frac{\Delta x}{2} \right)}{\frac{\Delta x}{2}} \\
> & = \sin{x}.
> \end{align*}
> $$
>


> [!warning]
> 
> 在物理中, 给定位移关于时间的函数 $s(t)$, 物体的速度 $v(t)$ 便是 $s(t)$ 的导数. 以自由落体为例, 设物体从静止开始自由下落，重力加速度为 $g$，则
> 
> - 位移函数为 $s(t) = \frac{1}{2}gt^2$。
> 
> - 速度为位移的导数：$v(t) = s'(t) = gt$。
> 
> - 加速度为速度的导数：$a(t) = v'(t) = g$，为常数。
> 

### 幂函数, 对数函数和指数函数的导数

> [!note]
>
>  ==幂函数的导数== 
> 
> **求正整数次幂函数 $ f(x) = x^m $ 的导数.**
> 
> 解：当 $m = 1$ 时：
> $$
> \displaystyle f'(x) = \lim_{\Delta x \to 0} \frac{(x+\Delta x) - x}{\Delta x} = \lim_{\Delta x \to 0} \frac{\Delta x}{\Delta x} = 1
>$$
> 
> 当 $m > 1$ 时：
> $$
> \begin{align*}
> \displaystyle f'(x) & = \lim_{\Delta x \to 0} \frac{(x+\Delta x)^m - x^m}{\Delta x} \\
>   & = \lim_{\Delta x \to 0} \left[ \frac{x^m + m x^{m-1} \Delta x + \frac{m(m-1)}{2} x^{m-2} (\Delta x)^2 + \cdots + (\Delta x)^m - \Delta x^m}{\Delta x} \right]\\
>   & = \lim_{\Delta x \to 0} \left[ m x^{m-1} + \frac{m(m-1)}{2} x^{m-2} \Delta x + \cdots + (\Delta x)^{m-1} \right] \\ 
> & = m x^{m-1}
> \end{align*}
> $$
> 
> 考虑到 $x^0 = 1$, 上面两种情况可以统一为
> $$
> (x^m)' = m x^{m-1}, \ m = 1, 2, \cdots
> $$


> [!warning]
> 我们不加证明的指出, 上述公式对任意的 $m \in \mathbb{R}$ 都成立, 即
> $$
> \boxed{
> (x^m)' = m x^{m-1}, \ m \in \mathbb{R}.
> }
> $$
> 


> [!warning]
> 
> ==先导结论==
>
> 在计算指数函数和对数函数的导数时我们需要用到下面的一些结论.
>
> - $\displaystyle \lim_{x \to 0} \frac{\ln(1+ x)}{x} = 1$
> 
> **证明:** [待补充]
>
> - $\displaystyle \lim_{x \to 0} \frac{\log_a(1+ x)}{x} = \frac{1}{\ln a}$
>
> **证明:** [待补充]
> 


> [!important]
> 
>  ==对数函数的导数== 
> 
> **求对数函数 $f(x) = \log_u x$ 的导数, 其中 $u$ 是大于 0 且不等于 1 的常数.**
> 
> 解：
> $$
> f'(x) = \lim_{\Delta x \to 0} \frac{\log_u (x + \Delta x) - \log_u x}{\Delta x}
> $$
> 
> 利用换底公式 $\displaystyle \log_u a = \frac{\ln a}{\ln u}$, 
> 
> $$
> f'(x) = \lim_{\Delta x \to 0} \frac{\frac{\ln(x + \Delta x)}{\ln u} - \frac{\ln x}{\ln u}}{\Delta x} = \frac{1}{x \ln u} \cdot \lim_{\Delta x \to 0} \frac{\ln\left(1 + \frac{\Delta x}{x}\right)}{\frac{\Delta x}{x}}
> $$
> 
> 令 $\displaystyle h = \frac{\Delta x}{x}$，当 $\Delta x \to 0$ 时 $h \to 0$，则：
> $$
> f'(x) = \frac{1}{x \ln u} \cdot \lim_{h \to 0} \frac{\ln(1 + h)}{h} = \frac{1}{x \ln u}
> $$
>
> 注: 最后一步用到了上面的先导结论.
>
> 由此我们得到对数函数的导数为:
> 
> $$\boxed{
> (\log_u x)' = \frac{1}{x \ln u}.
> }
> $$

> [!warning]
>
> 特别的, 当 $u=e$ 时, $\log_u x = \ln x$, 此时 
> $$ \boxed{
> (\ln x)' = \frac{1}{x}.
> }
> $$

> [!important]
> 
>  ==指数函数的导数== 
> 
> **求指数函数 $f(x) = q^x$ 的导数，其中底数 $q$ 是大于 0 且不等于 1 的常数.**
> 
> 解：
> 
> $$
> f'(x) = \lim_{\Delta x \to 0} \frac{q^{x + \Delta x} - q^x}{\Delta x}= \lim_{\Delta x \to 0} \frac{q^x \cdot q^{\Delta x} - q^x}{\Delta x}= q^x \cdot \lim_{\Delta x \to 0} \frac{q^{\Delta x} - 1}{\Delta x}
> $$
>  
> 我们注意到当 $\Delta x\to 0$ 时, $q^{\Delta x} \to 1$, 而 $q^{\Delta x} -1 \to 0$, 于是我们把 $q^{\Delta x} -1$ 看作一个新的变量 $h$, 故此时有当 $\Delta x\to 0$ 时 $h \to 0$. 于是根据**极限运算的换元法**, 
> $$
> \lim_{\Delta x \to 0} \frac{q^{\Delta x} - 1}{\Delta x} = \lim_{h \to 0} \frac{h}{\log_q(1+h)} = \ln q.
> $$
>
> 上式中的最后一个等式用到了前面的先导结论.
> 
> 因此，
> $$\boxed{
> (q^x)' = q^x \ln q.
> }$$
> 
> 这就是指数函数的导数公式。

> [!warning]
> 
> 特别的, 当 $u = e$ 时，有
> $$\boxed{
> (e^x)' = e^x.
> }$$
> 
> 也就是说, 以欧拉数 $e$ 为底数的指数函数的导数正是**它自己**, 由此也可以看出 $e$ 在数学上的特殊性.

### 可导函数与连续函数

> [!caution]
> 
> ==连续与可导的关系==
>
> 处处可导的函数称为**可导函数**, 处处连续的函数称为**连续函数**. 函数在一点可导则在该点也必连续, 但函数在一点连续并不保证在该点可导. 
> 

> [!note]
> 
>  ==连续但不可导的反例1==
>  
>  **绝对值函数 $f(x) = |x|$ 在 0 点连续但不可导.**
> 
>  绝对值函数在 $x = 0$ 处是连续的. 在 $x=0$ 处, 
> $$
> \lim_{\Delta x \to 0} \frac{f(0+\Delta x)-f(0)}{\Delta x} = \lim_{\Delta x \to 0} \frac{|\Delta x|}{\Delta x}
> $$
> 
> 当 $\Delta x < 0$ 时, $\displaystyle \frac{|\Delta x|}{\Delta x} = -1$; 
> 当 $\Delta x > 0$ 时, $\displaystyle \frac{|\Delta x|}{\Delta x} = 1$, 
> 左右极限不相等，故极限不存在, 因此，函数 $f(x) = |x|$ 在 $x=0$ 处不可导.

> 
>  ==连续但不可导的反例2==
>  
>  **函数 $f(x) = x^{\frac{1}{3}}$ 在 0 点处连续但不可导.**
> 
>  函数在 $x = 0$ 处连续. 下面我们来计算该函数在 $x=0$ 处的导数.
>
> - **方法一: 根据定义计算**
> 
> $$
> \frac{f(0+\Delta x)-f(0)}{\Delta x} = \frac{(0+\Delta x)^{\frac{1}{3}} - 0^{\frac{1}{3}}}{\Delta x} = (\Delta x)^{-\frac{2}{3}}.
> $$
> 当 $\Delta x \to 0$ 时，极限趋于无穷大，故函数在 $x = 0$ 处**不可导**.
>
> - **方法二: 对导函数取极限**
>
> 根据幂函数的求导公式可以得到
>
> $$
> f'(x) = \frac{1}{3}x^{-\frac{2}{3}}, \ x\ne 0.
> $$
>
> 当 $x \to 0$ 时, 导函数 $f'(x)$ 趋于无穷大, 提示 $f'(0)$ 可能不存在. 需要特别指出, 上述对导数取极限的做法主要提供一个感性认识(直觉), 要严格证明导数在 0 点不存在还是需要根据定义计算.
>
> **注意:** 
>
> 上述两种方法都涉及到极限, 但是取极限的对象不同, 方法一中是对 $\Delta x$ 取极限, 而方法二中是对 $x$ 取极限, 尽管都趋于无穷大(而且指数项都是 $-\frac{2}{3}$), 但两者的意义是不一样的, 请注意体会.
> 

### 单侧导数

> [!important]
> 
> ==单侧导数==
>
> 在计算绝对值函数在 0 点的导数时, 我们注意到 $f(x) = |x|$ 在 0 点左右两侧的切线斜率都存在, 为了更加细致的分析函数的行为, 我们可以引入**单侧导数**的概念. 
> 
> 我们定义函数 $f(x)$ 在 $x_0$ 处的**左导数**
> $$
> f'_-(x_0) = \lim_{\Delta x  \to 0^-} \frac{f(x_0 + \Delta x ) - f(x_0)}{\Delta x },
> $$
> 和**右导数**  
> $$
> f'_+(x_0) = \lim_{\Delta x  \to 0^+} \frac{f(x_0 + \Delta x ) - f(x_0)}{\Delta x }.
> $$
>
> 左导数和右导数统称为单侧导数, 函数 $ f(x) $ 在点 $ x_0 $ 处可导的条件是左导数和右导数都存在且相等.
>
> 对绝对值函数在 $x_0 = 0$ 点处而言, 其单侧导数都存在, 但是不相等, 因此在该点并不可导.
>



## 导数的计算

> [!tip]
>
> 求给定函数的导数的操作称为求导运算。本节将介绍常见函数的求导公式与导数的四则运算法则。熟练运用这些法则，将能显著简化求导过程，提高运算效率。

### 初等函数求导公式

> [!important]
> 
> ==常见初等函数的求导公式==
> 1. 幂函数
> - 如果 $f(x) = x^n$，则：
> $$\displaystyle f'(x) = n \cdot x^{n-1}$$
> 
> 2. 指数函数
> - 如果 $f(x) = e^x$，则：
> $$\displaystyle f'(x) = e^x$$
> 
> - 如果 $f(x) = a^x$，则：
> $$\displaystyle f'(x) = a^x \ln(a)$$
> 
> 3. 对数函数
> - 如果 $f(x) = \ln(x)$，则：
> $$\displaystyle f'(x) = \frac{1}{x}$$
> 
> - 如果 $f(x) = \log_a(x)$，则：
> $$\displaystyle f'(x) = \frac{1}{x \ln(a)}$$
> 
> 4. 三角函数
> - 如果 $f(x) = \sin(x)$，则：
> $$\displaystyle f'(x) = \cos(x)$$
> 
> - 如果 $f(x) = \cos(x)$，则：
> $$\displaystyle f'(x) = -\sin(x)$$
> 
> 5. 反三角函数 (不要求)
> - 如果 $f(x) = \arcsin(x)$，则：
> $$\displaystyle f'(x) = \frac{1}{\sqrt{1 - x^2}}$$
> 
> - 如果 $f(x) = \arccos(x)$，则：
> $$\displaystyle f'(x) = \frac{-1}{\sqrt{1 - x^2}}$$
> 
> - 如果 $f(x) = \arctan(x)$，则：
> $$\displaystyle f'(x) = \frac{1}{1 + x^2}$$

### 导数的四则运算

> [!tip]
> 
> 下面的导数四则法则都可以根据导数的定义加以证明.
> 

> [!important]
> 
> ==导数的四则运算法则==
> 
> - **加法**: 若函数 $f(x)$ 和 $g(x)$ 在点 $x$ 处可导，则：
>
> $$
> [f(x) + g(x)]' = f'(x) + g'(x)
> $$
>
> **证明**:
> 根据导数的定义：
> $$
> \begin{align*}
> [f(x) + g(x)]' &= \lim_{h \to 0} \frac{[f(x+h) + g(x+h)] - [f(x) + g(x)]}{h} \\
> & = \lim_{h \to 0} \left[ \frac{f(x+h) - f(x)}{h} + \frac{g(x+h) - g(x)}{h} \right] \\
> & = \lim_{h \to 0} \frac{f(x+h) - f(x)}{h} + \lim_{h \to 0} \frac{g(x+h) - g(x)}{h} \\ 
> & = f'(x) + g'(x)
> \end{align*}
> $$
>
> 
> - **减法**: 若函数 $f(x)$ 和 $g(x)$ 在点 $x$ 处可导，则：
>
> $$
> [f(x) - g(x)]' = f'(x) - g'(x)
> $$
>
> 该性质的证明跟导数的加法运算完全类似.
> 
> - **乘法**: 若函数 $f(x)$ 和 $g(x)$ 在点 $x$ 处可导，则：
> $$
> [f(x) \cdot g(x)]' = f'(x)g(x) + f(x)g'(x)
> $$
>
> **证明：**
> 根据导数的定义：
> $$
> \begin{align*}
> [f(x)g(x)]' &= \lim_{h \to 0} \frac{f(x+h)g(x+h) - f(x)g(x)}{h} \\
> &= \lim_{h \to 0} \frac{f(x+h)g(x+h) - f(x+h)g(x) + f(x+h)g(x) - f(x)g(x)}{h} \\
> &= \lim_{h \to 0} \left( f(x+h) \frac{g(x+h) - g(x)}{h} + g(x) \frac{f(x+h) - f(x)}{h} \right) \\
> &= \lim_{h \to 0} f(x+h) \cdot \lim_{h \to 0} \frac{g(x+h) - g(x)}{h} + g(x) \cdot \lim_{h \to 0} \frac{f(x+h) - f(x)}{h} \\
> &= f(x)g'(x) + g(x)f'(x)
> \end{align*}
> $$
>
> - **除法**
> 若函数 $f(x)$ 和 $g(x)$ 在点 $x$ 处可导，且 $g(x) \ne 0$，则：
>$$
> \displaystyle\left[ \frac{f(x)}{g(x)} \right]' = \frac{f'(x)g(x) - f(x)g'(x)}{[g(x)]^2}
> $$
> 
>**证明：**
> 根据导数的定义：
> $$
> \begin{align*}
> \left[ \frac{f(x)}{g(x)} \right]' &= \lim_{h \to 0} \frac{\frac{f(x+h)}{g(x+h)} - \frac{f(x)}{g(x)}}{h} \\
> &= \lim_{h \to 0} \frac{f(x+h)g(x) - f(x)g(x+h)}{h \cdot g(x)g(x+h)} \\
> &= \lim_{h \to 0} \left( \frac{f(x+h) - f(x)}{h} \cdot \frac{g(x)}{g(x)g(x+h)} - \frac{g(x+h) - g(x)}{h} \cdot \frac{f(x)}{g(x)g(x+h)}\right) \\
> &= \lim_{h \to 0} \frac{f(x+h) - f(x)}{h} \cdot \lim_{h \to 0} \frac{g(x)}{g(x)g(x+h)} - \lim_{h \to 0} \frac{g(x+h) - g(x)}{h} \cdot\lim_{h \to 0} \frac{f(x)}{g(x)g(x+h)} \\
> &= f'(x) \cdot \frac{1}{g(x)} - g'(x) \cdot \frac{f(x)}{[g(x)]^2} \\
> &= \frac{f'(x)g(x) - f(x)g'(x)}{[g(x)]^2}
> \end{align*}
> $$

> [!note]
> 
> ==P86 例1== 
> 
> **求函数 $y = 3x^3 - 4x^2 + 5x - 9$ 的导数 $y'$.**
> 
> $\begin{aligned}
> 解：y' &= (3x^3 - 4x^2 + 5x - 9)' \\
> &= (3x^3)' - (4x^2)' + (5x)' - (9)' \quad  \\
> &= 3 \cdot 3x^{3-1} - 4 \cdot 2x^{2-1} + 5 \cdot 1x^{1-1}\\
> &= 9x^2 - 8x + 5 \quad 
> \end{aligned}$
> 
> 
> ==P86 例2==
> 
> **设 $y = 2e^{x}(\sin x + 2\cos x)$，求 $y'$**
> 
> $\begin{aligned}
> 解：y' &= (2e^{x})'(\sin x + 2\cos x) + 2e^{x}(\sin x + 2\cos x)' \\
> &= 2e^{x}(\sin x + 2\cos x) + 2e^{x}(\cos x - 2\sin x) \\
> &= 2e^{x}\sin x + 4e^{x}\cos x + 2e^{x}\cos x - 4e^{x}\sin x \\
> &= 6e^{x}\cos x - 2e^{x}\sin x \\
> &= 2e^{x}(3\cos x - \sin x)
> \end{aligned}$
>
> ==P86 例3==
> 
> **求函数 $f(x) = x^3 + 3\sin x + \frac{5}{2}$ 的导数 $f'(x)$ 及 $f'\left(\frac{\pi}{4}\right)$**
> 
> $\begin{aligned}
>    解：f'(x) &= \left( x^3 + 3\sin x + \frac{5}{2} \right)' \\
>    &= (x^3)' + (3\sin x)' + \left( \frac{5}{2} \right)' \quad \\
>    &= 3x^2 + 3\cos x + 0 \quad \\
>    &= 3x^2 + 3\cos x.
>    \end{aligned}$
> 
>  $\begin{aligned}\ \ \ \ \ \ \ 
>    f'\left( \frac{\pi}{4} \right) &= 3\left( \frac{\pi}{4} \right)^2 + 3\cos\left( \frac{\pi}{4} \right) \\
>    &= \frac{3\pi^2}{16} + \frac{3\sqrt{2}}{2}.
>    \end{aligned}$
>
>==P86 例4==
>
> **设 $y = \tan x$，求 $y$ 的导数 $y'$**
> 
> 解：
> $\displaystyle y' = (\tan x)' = \left( \frac{\sin x}{\cos x} \right)' = \frac{(\sin x)' \cos x - \sin x (\cos x)'}{\cos^2 x}$
> 
> $\displaystyle = \frac{\cos^2 x + \sin^2 x}{\cos^2 x} = \frac{1}{\cos^2 x} = \sec^2 x$


### 高阶导数
> [!tip]
> 
> 导函数也是函数, 所以可以继续对导函数求导, 也就是二阶导数. 二阶导数反应了导函数的变化率. 依次可以继续到三阶导数, 四阶导数, ...
> 

> [!important]
> 
> ==二阶导数==
> 
> $f''(x) = (f'(x))'$
>
> ==高阶导数==
> 
> - $f'(x)$, $f''(x)$, $f'''(x)$, $f^{(n)}(x)$, $\cdots$.

> [!note]
> 
> ==P97 例1==
> 
> **设 $y = ax^2 + bx + c$，求 $y''$**
> 
> 解： 
> 
> 一阶导数 $y'$ ：
> $$
> y' = (ax^2)' + (bx)' + (c)' = 2ax + b 
> $$
> 
> 二阶导数 $y''$ ：
> $$
> y'' = (2ax)' + (b)' = 2a + 0 = 2a
> $$
>

> [!note]
> 
> ==P98 例7==
> 
> **求幂函数 $y = x^{a}$（$a$ 是任意常数）的 $n$ 阶导数**
> 
> 解： 
> $$
> y' = (x^{a})' = a x^{a-1}
> $$
> 
> $$
> y'' = \left( a x^{a-1} \right)' = a (a - 1) x^{a-2}
> $$
> 
> $$
> y''' = \left( a (a - 1) x^{a-2} \right)' = a (a - 1)(a - 2) x^{a-3}
> $$
> 
> $$\cdots $$
> 
> $$
> y^{(n)} = a (a - 1)(a - 2) \cdots (a - n + 1) x^{a-n}
> $$
>
> 特别的, 当 $a = n$ 为正整数时,
> $$
> (x^n)^{(n)} = n(n-1)(n-2) \cdot \cdots \cdot 3 \cdot 2 \cdot 1 = n!
> $$
> 
> $$
> (x^n)^{m} = 0 \quad m > n.
> $$
>

## 利用导数来研究函数的性质

> [!tip]
> 
> 导数可以用来研究**函数的变化率**, 仅仅这一条已经很强大了, 下面的应用都源自于导数的这一功能.

### 单调性

> [!caution]
> 
> - 导数>0, 单调递增
> - 导数<0, 单调递减
> - 导数=0, 无法判断
>

> [!note]
> 
> 
> 
>  ==P145 例1==
> 
> **判定函数 $\displaystyle y = x + \cos x$ 在 $[0, 2\pi]$ 上的单调性**
> 
> 解： 函数在 $[0, 2\pi]$ 上连续，在 $(0, 2\pi)$ 内可导。求导得：
> $\displaystyle y' = (x + \cos x)' = 1 - \sin x$
> 因为 $\sin x \in [-1, 1]$，
> 所以：$\displaystyle 1 - \sin x \geq 0 \quad (\forall x \in \mathbb{R})$
> 当 $\displaystyle x = \frac{\pi}{2}$ 时，$y' = 1 - 1 = 0$ 
> 
> 当 $\displaystyle x \neq \frac{\pi}{2}$ 时，$y' > 0$
> 导数非负且仅在离散点为零时函数单调递增
> 
> 故函数 $y = x + \cos x$ 在 $[0, 2\pi]$ 上严格单调递增
>

> [!note]
> 
>  ==P145 例2==
>  
> **讨论函数 $\displaystyle y = e^x - x + 3$ 的单调性**
> 
> 解： 函数在 $(-\infty, +\infty)$ 上可导，其导数为：
> $\displaystyle y' = (e^x - x + 3)' = e^x - 1$
> 
> 函数 $y = e^x - x - 1$ 的定义域为 $(-\infty, +\infty)$
> 
> - 在区间 $(-\infty, 0)$ 内：
> $\displaystyle y' = e^x - 1 < 0$
> 因此函数在 $(-\infty, 0]$ 上单调递减。
> 
> - 在区间 $(0, +\infty)$ 内：
> $\displaystyle y' = e^x - 1 > 0$
> 因此函数在 $[0, +\infty)$ 上单调递增。
> 
> 
### 极值

> [!caution]
> 
> - 导数=0, 二阶导数>0, 极小
> - 导数=0, 二阶导数<0, 极大
> - 导数=0, 二阶导数=0, 无法判断. 导数为0的点也称为**驻点**或**临界点**.
> 

> [!note]
> 
> ==P156 例2==
> 
> **求函数 $f(x) = x^4 - 4x^2$ 的极值**
> 
> 解：一阶导数为：
> $\displaystyle f'(x) = (x^4 - 4x^2)' = 4x^3 - 8x = 4x(x^2 - 2)$
> 
> 令 $f'(x) = 0$，解得：
> 
> $\displaystyle 4x(x^2 - 2) = 0 \quad \Rightarrow  x_1 = 0,\quad x_2 = \sqrt{2}, \quad x_3 = -\sqrt{2}$
> 
> 二阶导数为： 
> $\displaystyle f''(x) = (4x^3 - 8x)' = 12x^2 - 8$
> 
> 在 $x = 0$ 处：
> $\displaystyle f''(0) = 12 \cdot 0 - 8 = -8 < 0$ 因此 $x = 0$ 处为极大值，极大值为：
>    
> $\displaystyle f(0) = 0^4 - 4 \cdot 0^2 = 0$
> 
> 在 $x = \pm \sqrt{2}$ 处：
> 
> $\displaystyle f''(\pm \sqrt{2}) = 12 \cdot (\sqrt{2})^2 - 8 = 12 \cdot 2 - 8 = 16 > 0$
> 
> 因此 $x = \pm \sqrt{2}$ 处为极小值，极小值为：
> 
> $\displaystyle f(\pm \sqrt{2}) = (\sqrt{2})^4 - 4 \cdot (\sqrt{2})^2 = 4 - 8 = -4$

>
> [!caution]
> 
> ==极值和最值==
> 
>闭区间上连续函数最值的求解步骤
>设 $f(x)$ 在 $[a, b]$ 上连续，则其最大值和最小值可按以下步骤求解：
> 1. **确定临界点**：
> - 求 $f(x)$ 在 $(a, b)$ 内的 **驻点**（即 $f'(x) = 0$ 的解）；
> - 找出 $f(x)$ 的 **不可导点**（如分段点、尖点等）。
> 2. **计算候选值**：
> - 计算驻点、不可导点处的函数值 $f(x_i)$；
> - 计算端点值 $f(a)$ 和 $f(b)$。
> 3. **比较结果**：选出最大值和最小值


> [!warning]
> 
> ==光路最短原理==
>
> **问题：** 一束光线从空气中的点A出发，经过水面折射后到达水中的点B。已知光在空气中和水中的传播速度分别为 $v_1$ 和 $v_2$，试确定光线从点A到点B传播耗时最短的路径。
>
> **解：**
>
> 如图所示，我们建立一个直角坐标系，将光线传播路径与水面（$x$ 轴）的交点设为 $P$。
>
> * 点 $A$ 的坐标为 $(0, h_1)$。
> * 点 $B$ 的坐标为 $(l, -h_2)$。
> * 点 $P$ 的坐标为 $(x, 0)$。
>
> ![](../media/img/chap2_1.png)
>
>
> 光线从 $A$ 到 $P$ 在空气中传播的距离为 $S_1 = \sqrt{h_1^2 + x^2}$，从 $P$ 到 $B$ 在水中传播的距离为 $S_2 = \sqrt{h_2^2 + (l - x)^2}$。
>
> 根据**光路最短原理（费马原理）**，光线在两点之间传播时，所走的路径是耗时最短的路径。因此，光线从A到B的总传播时间 $T(x)$ 必须取最小值。
>
> $$T(x) = \frac{S_1}{v_1} + \frac{S_2}{v_2} = \frac{\sqrt{h_1^2 + x^2}}{v_1} + \frac{\sqrt{h_2^2 + (l - x)^2}}{v_2}, \ \ x \in [0, l]$$
>
> 为了找到使 $T(x)$ 最小的 $x$ 值，我们对函数 $T(x)$ 求导并令其等于零。
>
> $$T'(x) = \frac{1}{v_1} \cdot \frac{2x}{2\sqrt{h_1^2 + x^2}} + \frac{1}{v_2} \cdot \frac{2(l-x)(-1)}{2\sqrt{h_2^2 + (l - x)^2}}$$
>
> $$= \frac{1}{v_1} \cdot \frac{x}{\sqrt{h_1^2 + x^2}} - \frac{1}{v_2} \cdot \frac{l - x}{\sqrt{h_2^2 + (l - x)^2}}$$
>
> 令 $T'(x) = 0$，得到：
>
> $$\frac{1}{v_1} \cdot \frac{x}{\sqrt{h_1^2 + x^2}} = \frac{1}{v_2} \cdot \frac{l - x}{\sqrt{h_2^2 + (l - x)^2}}$$
>
> 观察几何关系，我们可以看到：
>
> * $\frac{x}{\sqrt{h_1^2 + x^2}} = \sin \theta_1$
> * $\frac{l - x}{\sqrt{h_2^2 + (l - x)^2}} = \sin \theta_2$
>
> 其中，$\theta_1$ 是入射光线与法线之间的夹角，$\theta_2$ 是折射光线与法线之间的夹角。将这两个关系代入上式，我们得到：
>
> $$\frac{\sin \theta_1}{v_1} = \frac{\sin \theta_2}{v_2}$$
>
> 这就是著名的**斯涅耳定律（Snell's Law）**。它精确地描述了光线在两种介质交界面上发生折射时的行为。
>
> **光路最短原理（费马原理，Fermat's Principle**是几何光学中最基本、最重要的原理之一，它指出光在两点之间传播时，所走的路径是光程最短的路径，而非距离最短的路径。这个例子很好地说明了如何利用微积分来证明费马原理与斯涅耳定律的等价性。

### 凸性

> [!important]
> 
> ==凸函数的定义==
>
> 设 $f(x)$ 是定义在实数集上的函数。如果对于定义域内任意的 $x_1, x_2$，都有：
> $$
> f\left(\frac{x_1 + x_2}{2}\right) \leq \frac{f(x_1) + f(x_2)}{2}
> $$
> 则称函数 $f(x)$ 是凸函数。
> 

> [!caution]
> 
> ==根据二阶导数判定函数的凸性==
> 
> 二阶导数<0, 凸函数
> 二阶导数>0, 凹函数
> 二阶导数=0, 可能是拐点
> 一般地，如果曲线在经过点 $(x_0, y_0)$时，曲线的凹凸性改变了，那么就称点 $(x_0, y_0)$ 为这曲线的**拐点**
> 


> [!note]
> 
> ==P148 例1==
> 
>  **判定曲线 $y = \sqrt{x}$ 的凹凸性**
> 
> 解： 一阶导数：
> $\displaystyle y' = (\sqrt{x})' = \frac{1}{2\sqrt{x}}$
> 二阶导数：$\displaystyle y'' = \left( \frac{1}{2\sqrt{x}} \right)' = -\frac{1}{4x^{3/2}}$
> 
> 在函数定义域 $(0, +\infty)$ 内：
> $\displaystyle x > 0 \quad \Rightarrow \quad x^{3/2} > 0 \quad \Rightarrow \quad y'' = -\frac{1}{4x^{3/2}} < 0$
> 
> 当 $y'' < 0$ 时，曲线为**凸的**，则曲线 $y = \sqrt{x}$ 在定义域 $(0, +\infty)$ 内始终为凸曲线


> [!note]
> 
> ==P149 例2==
> 
>  **判定曲线 $y = x^3 - 3x$ 的凹凸性**
> 
> 解： 一阶导数：$\displaystyle y' = 3x^2 - 3$
> 
> 二阶导数：  $\displaystyle y'' = 6x$
> 
>  - 当 $x < 0$：
>    $\displaystyle y'' = 6x < 0 \quad (\text{因为 } x < 0)$ 此时曲线为**凸的**
> 
>  - 当 $x > 0$：
>    $\displaystyle y'' = 6x > 0 \quad (\text{因为 } x > 0)$ 此时曲线为**凹的**

## 导数在人工智能中的应用: 梯度下降法

> [!important]
> 
> ==梯度下降法==
> 
> 想象你在调一台老式收音机，它只有一个旋钮 $ w $ 用来调频道。你转动旋钮时，耳朵会立刻听到声音的变化：有时候，往一个方向轻轻一转，会发现杂音立刻变小了，但也有时候，刚一转动旋钮，嗞嗞的噪声突然变大。整个过程就像是在黑暗中摸索，只能凭耳朵判断该往哪边走，一边转旋钮，一边听声音的变化，一步步靠近那个最清晰的频道。
> 你的目标：找到让声音最清晰的那个旋钮位置。
>
>损失函数：$ L(w) $ 表示：当旋钮在位置$ w $时，收音机的杂音强度是多少。
>- 杂音大 → $L(w)$ 大  
>- 杂音小 → $L(w)$ 小
>  
>我们的目标，就是找到让 $L(w)$ 最小的那个 $w$，也就是杂音最小、声音最清晰的旋钮位置。
>
>![收音机](../media/img/gd_1.png)
>
> **导数的含义**
> 
>如果$\displaystyle L'(w)>0$，说明 $L(w)$ 随 $w$ 增大而增大，所以我们要让 $w$ 变小  
>
>如果$\displaystyle L'(w)<0$，说明 $L(w)$ 随 $w$ 增大而减小，所以我们要让 $w$ 变大  
>
>导数的符号告诉我们当前这一刻旋钮往哪边调，杂音$($损失函数 $L(w))$会增加还是减少，而沿着负导数的方向调旋钮，就能让函数值 $L(w)$ 逐步减小。
>
> **学习率：控制 “转旋钮的幅度**
>
>数学上，用学习率控制幅度，公式是：$\displaystyle w \leftarrow w - \eta \cdot L'(w)$  
>
>- 如果 $\eta$ 太大 → 你猛地把旋钮转过头，直接跨过谷底，来回震荡，甚至跑到更高的山上  
>- 如果 $\eta$ 太小 → 你像用牙签拨旋钮，一次几乎没动，走到谷底需要很久  
>
>![学习率](../media/img/gd_2.png)
>
> **收敛**
>
>在迭代公式:
> $$
> w \leftarrow w - \eta \cdot L'(w)
> $$
>
>当导数很接近 $0$ 时，更新步长会非常小，参数 $w$ 变化几乎停下来，这时我们就找到了让 $L(w)$ 最小的 $w$，参数就收敛到了最优点。
>
> **梯度下降的过程**
>
>- 观察 $L(w)$ 数值变化（计算导数）  
>- 按合适的幅度调节 $w$  
>- 反复进行，直到导数接近 $0$，迭代结束


---
title: 高等数学讲义
author: 胡煜成
description: 首都师范大学高等数学A
"og:description": 浏览器版和手机版
"og:image": https://vlook-doc.pages.dev/pic/vlook-og.png
keywords:
- 高等数学,微积分,讲义
vlook-chp-autonum: h1=off
vlook-query: vdl=on
vlook-query: ws=off
---

[toc]

# 微分

> [!tip]
>
> 上一章我们通过极限给出了**导数的定义**, 并指出导数的几何意义是函数某一点处**切线的斜率**. 通过计算函数切线的斜率, 我们可以判断函数的增减性及其极值. 
> 
> 本章我们将介绍**微分**的概念, 并揭示微分与导数之间的朴实却深刻的联系. 微分是微积分的核心思想, 将在后续的课程中贯穿始终.
> 

## 微分的概念

> [!tip] 
> 
> **微分 (differential)** 的意思是 **无穷小的改变量 (infinitesimally small change)**，莱布尼茨为微分创立了其专属符号 "$d$", 例如 $dx$ 表示变量 $x$ 的微分, $dy$ 表示变量 $y$ 的微分. 与之对应的, 物理上经常用 $\Delta x$ 表示一个很小的改变量，比如一小段位移. 直观上看, $\Delta x$ 和 $dx$ 想传达的意思很相近, 都是**很小的量**, 但是在数学它们是有区别的. 
> 
> - $\Delta x$ 表示一个非常小但**固定的数**.
> 
> - $dx$ 则表示一个"无穷小量", 它不再是一个固定的数, 而是蕴含了某个**极限过程**.
> 

> [!note]
> 
> 如图, 考虑一个做直线运动的物体, 它在经过一小段时间 $\Delta t$ 之后位移的变化量为 $\Delta s = s(t +\Delta t) - s(t)$. 此时我们考虑 $\Delta t \to 0$ 的极限, 就得到**时间的微分** $dt$ 以及对应的**位移的微分** $ds$.
> 
> ![微分的例子1](../media/img/diff_example_1.png)

> [!note]
> 
> 如图, 从原点位置以角度 $\theta$ 发射一束激光, 设激光与直线 $y = b$ 的交点坐标为 $(x, b)$. 如果我们将发射角做一个微小的改变 $\Delta \theta$, 与之对应的激光光斑的位置会在 $x$-轴方向上发生了一个 $\Delta x$ 的偏移. 此时我们考虑 $\Delta \theta \to 0$ 的极限, 就得到**角度的微分** $d\theta$ 以及对应的**x的微分** $dx$.
> 
> ![微分的例子2](../media/img/diff_example_2.png)
> 


### 微分与导数

> [!tip]
> 
> 在研究实际问题的时候, 我们经常关心两个微分之间的关系. 例如, 设想我们需要控制一个机械手臂在黑板上画图, 粉笔移动一个小位移, 机械臂的各个关节也要相应的移动一个小量. 我们可以把关节移动的小量认为是 $dx$, 粉笔移动的小量认为是 $dy$. 很多时候我们关心两个微分之间的联动关系, 比如在机器人控制领域, 给定 $dx$ 计算 $dy$ 叫做**正动力学**, 给定 $dy$ 计算 $dx$ 叫做**逆动力学**. 又比如在例1中 $dx$ 与 $dt$ 的关系反映了物体的位移随时间的变化关系; 例2中 $dx$ 与 $d\theta$ 的关系反映了激光光斑的位置随发射角度之间的变化关系, 这些都是物理中所关心的量.
> 
> 那么如何确定两个微分之间的关系呢? 如果我们能够写出两个变量之间所满足的**函数关系**, 很容易就可以得到这两个变量所对应的微分之间的关系, 这是**微分学**的一个重要成就.


> [!important]
>
> ==微分与导数的关系==
> 
> 一般的, 假定两个变量 $x$, $y$ 满足函数关系 $y = f(x)$, 则 $dy = f'(x) dx$. 

> [!note]
>
> 我们首先通过数值计算来验证上述关系.
> 
> 例1: 我们分别考虑两种直线运动: **匀速运动** 和 **匀加速运动**. 对于匀速运动,
>  
> $$ s = s_0 + vt $$
> 
> 根据微分公式, 位移的微分与时间的微分满足关系:
> 
> $$ ds = vdt$$
>
> 对于初速度为0的匀加速运动, 其位移随时间的函数为
> 
> $$ s = s_0 + \frac{1}{2} a t^2 $$
>
> 根据微分公式, 位移的微分与时间的微分满足关系:
>
> $$ ds = a t dt$$
> 
> 下表给出了 $\Delta x$ 取不同数值时所对应得 $\Delta s$ 的真实值和微分公式的预测值 ($v = 2m/s, a = 2m/s^2, t=1s$).
>
> ![表格1](..\media\img\table1.png)
> 
> 从表中可以看到, 对于匀速运动, 所有情况下差值均为 0, 这表明对于线性函数，微分给出的是**精确**的, 但这仅限于线性函数的特例. 对于更加一般的匀加速运动, 差值不等于0, 但会随着 Δt 的减小而迅速减小. 这一观察提示我们, 当 $\Delta t\to 0$ 时, 误差的极限也区域0, 由此得到微分公式中的等式成立.
>
> 
> 例2: 在这个例子中, $x$ 与 $\theta$ 的函数关系为
>
> $$
> x = \frac{b}{\tan \theta}
> $$
>
> 根据微分公式, 我们有
> 
> $$
> dx = -b \frac{1}{\sin^2 \theta}d\theta
> $$
>
> 也就是说, 激光出射角度每增加 $d\theta$, 光斑就会左移(负号) $\displaystyle b \frac{1}{\sin^2 \theta}d \theta$.
> 
> 我们再稍微拓展一下, 如果我们关心的不是横坐标 $x$, 而是激光飞行的距离 $l$, 则
> 
> $$
> l = \frac{b}{\sin \theta}
> $$
> 此时的微分公式给出
> $$
> dl = -b \frac{\cos \theta}{\sin^2 \theta}d\theta
> $$
> 也就是说, 激光出射角度每增加 $d\theta$, 激光得飞行距离就会缩短(负号) $\displaystyle -b \frac{\cos \theta}{\sin^2 \theta}d\theta$.
>
> 下表给出了取不同的 $\Delta \theta$ 时 $x$ 和 $l$ 的真实变化量和微分公式预测的变化量的对比($\theta = \pi/3$):
> 
> ![表2](..\media\img\table2.png)
>
> 从表中可以看出, 随着 $\Delta \theta$ 的减小, 微分公式与精确值的误差也迅速减小, 提示当 $\Delta t\to 0$ 时, 误差的极限也区域0.
>
> 综合上面的例子可以得到如下结论: 当 $\Delta x$ 很小时, 近似满足
> $$ \Delta y \approx f'(x) \Delta x$$
>
> 而取 $\Delta x \to 0$ 的极限, 上式约等于变成等于
>
> $$ d y = f'(x) d x$$

> [!warning]
>
> 接下来我们结合导数的定义来理解微分公式. 在上一章中，我们曾从函数图像切线的角度出发，借助极限给出导数的定义：
>
> $$
> f'(x) = \lim_{\Delta x \to 0} \frac{f(x + \Delta x) - f(x)}{\Delta x}.
> $$
>
> 上式的分子就是 $\Delta y$. 因此形式上我们有
>
> $$
> f'(x) = \lim_{\Delta x \to 0} \frac{\Delta y}{\Delta x} = \frac{dy}{dx}
> $$
>  
>
> 由此可见，当 $\Delta x \to 0$ 时，差分商 $\Delta y / \Delta x$ 的极限正是微分之商 $dy/dx$。
>
> 在微积分的逻辑体系内，dy/dx 最初是一个整体符号代表导数。事实上，我们也常用符号 $\dfrac{dy}{dx}$ 表示导数，常见的表达方式包括：
>
> $$
> \frac{dy}{dx} \sim y'(x)
> $$
>
> $$
> \frac{df(x)}{dx} \sim f'(x)
> $$
>
> $$
> \left. \frac{df(x)}{dx} \right\rvert_{x = x_0} \sim f'(x_0)
> $$
> 
> 但这里我们形式上将 dx 和 dy 作为独立的“微分”概念，从而将导数的定义式
>
> $$
> \frac{dy}{dx} = f'(x)
> $$
>
> 变形成等式
> 
> $$
> dy = f'(x) dx
> $$
>

> [!important]
> 微分公式表明函数值 $y$ 的微分与自变量 $x$ 的微分呈线性关系，它的背后体现了**化曲为直**的思想, 具体体现在
>
> $$
> \begin{align*}
> &\boxed{dy = f'(x_0) dx} \\
> &\quad \downarrow \\
> &\boxed{\Delta y \approx f'(x_0) \Delta x} \\
> &\quad \downarrow \\
> &\boxed{f(x_0+ \Delta x) - f(x_0) \approx f'(x_0) \Delta x} \\
> &\quad \downarrow \\
> &\boxed{f(x_0+ \Delta x) \approx f(x_0) + f'(x_0) \Delta x}
> \end{align*}
> $$
>
> ![微分与线性近似](..\media\img\diff_linear_approx.jpg)
>
> 最后一个公式说明，函数在 $x_0$ 附近可近似看作一条过点 $(x_0, f(x_0))$、斜率为 $f'(x_0)$ 的**直线**. **在局部用一条直线来近似函数**也就是所谓的**化曲为直**, 这是微积分中一个极其重要的思想.
>

> [!warning]
> 
> 基于微分符号所建立的导数定义与运算规则非常直观，在后续课程中，我们将进一步领略**微分**思想的强大力量，并体会良好符号系统为数学带来的美感与实用价值。

## 借助微分计算导数

> [!tip]
> 
> 借助微分的思想和符号可以帮助我们去处理更加复杂的求导运算, 包括复合函数求导和隐函数求导.
> 

### 复合函数求导的链式法则

> [!tip]
> 
> 非常重要!
> 

> [!important]
> 
> ==链式法则 (Chain Rule)==
> 
> 若函数 $y = f(u)$ 在点 $u = g(x)$ 可导，且 $u = g(x)$ 在点 $x$ 可导，则：
> $$
> [f(g(x))]' = f'(g(x)) g'(x)
> $$
>
> 基于微分的思想, 链式法则可以直观的理解为: 分子分母同时乘以无穷小量 $du$, 得到
>
> $$
> \frac{dy}{dx} = \frac{dy}{du} \cdot \frac{du}{dx}.
> $$


> [!note]
> 
> ==P90 例9== 
> 
>  **设函数 $y = e^{x^2}$，求 $\frac{dy}{dx}$**
> 
> 解：$y = e^{x^2}$ 可看作由 $y = e^u$，$u = x^2$ 复合而成，因此：
>   
> $$\frac{dy}{dx} = \frac{dy}{du} \cdot \frac{du}{dx} = e^u \cdot 2x = 2xe^{x^2}.$$

> [!note]
> 
> ==P90 例10==
> 
> **设函数 $y = \cos \frac{x^2-1}{3x}$，求 $\frac{dy}{dx}$**
> 
> 解：$y = \cos \frac{x^2-1}{3x}$ 可看作由 $\displaystyle  y = \cos u, u = \frac{x^2-1}{3x}$ 复合而成。因
> $\displaystyle \frac{dy}{du} = -\sin u,$
> $\displaystyle \frac{du}{dx} = \frac{x^2 + 1}{3x^2},$
> 所以
> $$ \frac{dy}{dx} = -\sin u \cdot \frac{x^2 + 1}{3x^2} = -\frac{x^2 + 1}{3x^2} \cdot \sin \frac{x^2-1}{3x}.$$
>


> [!note]
> 
> ==P91 例11==
> 
> **设 $y = \ln \cos x$，求 $\frac{dy}{dx}$**.
> 
> 解：$y = \ln \cos x$ 可看作由 $y = \ln u$，$u = \cos x$ 复合而成。所以
> $$ \frac{dy}{dx} = \frac{dy}{du} \cdot \frac{du}{dx} = \frac{1}{\cos x} \cdot (-\sin x) = -\frac{\sin x}{\cos x} = -\tan x.$$

> [!note]
> 
> ==P92 例12==
> 
> **设 $y = \sqrt{1 + 3x^3}$，求 $\frac{dy}{dx}$.**
> 
> 解：$y = \sqrt{1 + 3x^3} = (1 + 3x^3)^{\frac{1}{2}}$ 可看作由 $y = u^{\frac{1}{2}}$， $u = 1 + 3x^3$ 复合而成。
> 所以
> $$ \frac{dy}{dx} = \frac{dy}{du} \cdot \frac{du}{dx} = \frac{1}{2\sqrt{1 + 3x^3}} \cdot 9x^2 = \frac{9x^2}{2\sqrt{1 + 3x^3}}.$$

> [!note]
> 
> ==P92 例13==
> 
> **设 $y = \ln \sin(2x^2)$，求 $\frac{dy}{dx}$**
>  
> 解：所给函数可分解为 $y = \ln u, u = \sin v, v = 2x^2$。
> $$\frac{dy}{dx} = \frac{1}{u} \cdot \cos v \cdot 4x = \frac{\cos(2x^2)}{\sin(2x^2)} \cdot 4x = 4x \cot(2x^2).$$
>

> [!note]
> 
> ==P92 例14==
> 
> **设 $y = e^{\cos \sqrt{x}}$，求 $y'$**
> 
> 解：逐层求导：
> $\displaystyle \frac{dy}{du} = e^u = e^{\cos \sqrt{x}}$
> $\displaystyle \frac{du}{dv} = -\sin v = -\sin \sqrt{x}$
> $\displaystyle \frac{dv}{dx} = \frac{1}{2}x^{-1/2} = \frac{1}{2\sqrt{x}}$
> 
> 根据链式法则：
> 
> $\displaystyle y' = \frac{dy}{du} \cdot \frac{du}{dv} \cdot \frac{dv}{dx} = e^{\cos \sqrt{x}} \cdot (-\sin \sqrt{x}) \cdot \frac{1}{2\sqrt{x}}= -\frac{e^{\cos \sqrt{x}} \sin \sqrt{x}}{2\sqrt{x}}$
>
>

> [!note]
> 
> ==P93 例15==
> 
> **设 $y = \cos 2x \cdot \cos^2 x$，求 $y'$**
> 
> 解：
> 
> $y' = (\cos 2x)' \cos^2 x + \cos 2x (\cos^2 x)'$
> $= -2\sin 2x \cos^2 x + \cos 2x (-2\sin x \cos x)$
$= -2\cos x (\sin 2x \cos x + \cos 2x \sin x)$
$= -2\cos x \sin 3x$

### 隐函数求导

> [!tip]
> 
> 隐函数将自变量 $x$ 和函数值 $y$ 通过某个等式联系起来, 从这个等式里我们可以推测 $dy$ 和 $dx$ 之间的关系, 一些复杂的函数的导数通过隐函数更容易计算.
> 

> [!note]
> 
> ==P101 例1==
> 
> **求由方程 $\ln y + x^2y - 1 = 0$ 所确定的隐函数的导数 $\frac{dy}{dx}$**.
> 
> 解：将方程两边对 $ x $ 求导，注意 $ y $ 是 $ x $ 的函数：
> 
> 左边求导：$\displaystyle \frac{d}{dx}(\ln y + x^2y - 1) = \frac{1}{y}\frac{dy}{dx} +2xy + x^2\frac{dy}{dx}$
> 右边求导：$\displaystyle \frac{d}{dx}(0) = 0$
> 
> 令两边相等：$\displaystyle \frac{1}{y}\frac{dy}{dx} + 2xy + x^2\frac{dy}{dx} = 0$
> 
> 合并关于 $\frac{dy}{dx}$ 的项：
> $\displaystyle \left(\frac{1}{y} + x^2\right)\frac{dy}{dx} = -2xy$
> 
> 解得：$\displaystyle \frac{dy}{dx} = -\frac{2xy}{\frac{1}{y} + x^2} = -\frac{2xy^2}{1 + x^2y} \quad (y \ne 0)$
> 即 $\displaystyle \frac{dy}{dx} = -\frac{2xy^2}{1 + x^2y}$


> [!note]
> 
> ==P102 例2==
> 
> **求由方程 $ y^3 + 3y - x^2 - 2x^5 = 0 $ 所确定的隐函数在 $ x = 0$ 处的导数 $\left.\frac{dy}{dx}\right|_{x=0}$**.
> 
> 解：将方程两边对 $ x $ 求导（注意 $ y $ 是 $ x $ 的函数）：$\displaystyle \frac{d}{dx}(y^3 + 3y - x^2 - 2x^5) $
> 
> $\displaystyle = 3y^2 \frac{dy}{dx} + 3 \frac{dy}{dx} - 2x - 10x^4 = 0$
> 
> 解关于 $\displaystyle\frac{dy}{dx}$的方程:
> 
> $\displaystyle (3y^2 + 3)\frac{dy}{dx} = 2x + 10x^4$
> 
> 解得:$\displaystyle \frac{dy}{dx} = \frac{2x + 10x^4}{3y^2 + 3}$
> 
> 求 $ x = 0 $ 时的 $ y $ 值:
> 
> $\displaystyle y^3 + 3y - 0 - 0 = 0 \Rightarrow y^3 + 3y = 0 \Rightarrow y(y^2 + 3) = 0$
> 
> 解得实数解为 $ y = 0 $
> 
> 计算 $ x = 0 $ 处的导数值:
> 将 $ x = 0 $, $ y = 0 $ 代入导数表达式：$\displaystyle \left.\frac{dy}{dx}\right|_{x=0}= \frac{0 + 0}{0 + 3} = 0$

> [!note]
> 
>==P102 例3==
>**求双曲线 $\frac{x^2}{9} - \frac{y^2}{4} = 1$ 在点 $(3\sqrt{2}, 2)$ 处的切线方程**.
> 
>  解：对双曲线方程两边关于 $x$ 求导：
> 
> $\displaystyle \frac{2x}{9} - \frac{2y}{4}\cdot\frac{dy}{dx} = 0 \Rightarrow \frac{x}{9} - \frac{y}{2}\cdot\frac{dy}{dx} = 0$
> 
> 解得：$\displaystyle \frac{dy}{dx} = \frac{2x}{9y}$
> 
> 计算切点处斜率,在点 $(3\sqrt{2}, 2)$ 处：$\displaystyle k = \left.\frac{dy}{dx}\right|_{(3\sqrt{2},2)} = \frac{2 \times 3\sqrt{2}}{9 \times 2} = \frac{\sqrt{2}}{3}$
> 
> 于是所求的切线方程为：
> $\displaystyle y - 2 = \frac{\sqrt{2}}{3}(x - 3\sqrt{2})\Rightarrow 3y - 6 = \sqrt{2}x - 6 \Rightarrow \sqrt{2}x - 3y = 0$
> 

### 反函数求导

> [!tip]
> 
> 反函数求导可以看作是隐函数求导的特例.
> 

> [!note]
>
> ==P88 例6==
>  [不要用书上的做法, 用隐函数求导]
>  **设 $ y = \arcsin x $ ($ -1 < x < 1 $)，用隐函数求导法求 $ y' $**
> 
>  解：由 $ y = \arcsin x $ 可得直接函数关系：$x = \sin y$
>  对 $ x = \sin y $ 两边关于 $ x $ 求导（注意 $ y $ 是 $ x $ 的函数）：
>  $\displaystyle \frac{d}{dx}(x) = \frac{d}{dx}(\sin y)$
> 
>  $\displaystyle1 = \cos y \cdot \frac{dy}{dx}$
> 
> 将 $\cos y $用$ x $表示
> 
>  利用三角恒等式：
>  $\displaystyle \cos y = \sqrt{1 - \sin^2 y} = \sqrt{1 - x^2}$（当 $ -\frac{\pi}{2} < y < \frac{\pi}{2} $ 时，$ \cos y > 0 $，故取正根）
> 
>  故得到结果：$\displaystyle \frac{dy}{dx} =(\arcsin x)' = \frac{1}{\sqrt{1 - x^2}}$
>  用类似的方法可得反余弦函数的导数公式
>  $\displaystyle (\arccos x)' = -\frac{1}{\sqrt{1-x^2}}$
> 
>  ==P88 例7==
>  [不要用书上的做法, 用隐函数求导]
>  **设 $ y = \arctan x $ ($ x \in \mathbb{R} $)，用隐函数求导法求 $ y' $**
> 
>  解：由 $ y = \arctan x $ 可得直接函数关系：$x = \tan y$
>  对 $ x = \tan y $ 两边关于 $ x $ 求导（注意 $ y $ 是 $ x $ 的函数）：
>  $\displaystyle \frac{d}{dx}(x) = \frac{d}{dx}(\tan y)$
> 
> $\displaystyle 1 = \sec^2 y \cdot \frac{dy}{dx}$
> 
> $\displaystyle \frac{dy}{dx} = \frac{1}{\sec^2 y}$
> 
>  将 $ \sec^2 y $ 用 $ x $ 表示:
> 
>  利用三角恒等式：$\displaystyle \sec^2 y = 1 + \tan^2 y = 1 + x^2$ 故得到结果：
>  $\displaystyle \frac{dy}{dx}=(\arctan x)' = \frac{1}{1 + x^2}$
>  用类似的方法可得反余切函数的导数公式 $\displaystyle (arccot x)' = -\frac{1}{1+x^2}$

> [!note]
> 
> ==P103 例5==
> 
> **求 $y = (x^2)^{\ln x}$（$x > 0$）的导数**
> 
> 解： 利用对数求导法
> 两边取对数: 
> $\displaystyle\ln y = \ln \left( (x^2)^{\ln x} \right) = \ln x \cdot \ln(x^2)=\ln x \cdot 2\ln x=2(\ln x)^2$
> 
> 两边对 $x$ 求导得：
> $\displaystyle\frac{1}{y} \cdot y' = 2 \cdot 2\ln x \cdot \frac{1}{x} = \frac{4\ln x}{x}$
> 
> 解出 $y'$得到:
> 
> $\displaystyle\ y' = y \cdot \frac{4\ln x}{x} = (x^2)^{\ln x} \cdot \frac{4\ln x}{x}$
>  
> 
> ==P103 例6==
> 
> **求 $\displaystyle y = \sqrt{\frac{(x-1)(x-2)}{(x-4)(x-5)} }$ 的导数**
> 
> 解：假设 $x > 5$，在等式两边取对数：
> $\displaystyle\ln y = \frac{1}{2} [ \ln(x-1) + \ln(x-2) \\- \ln(x-4) - \ln(x-5) ]$
> 
> 对两边关于 $x$ 求导（注意 $y$ 是 $x$ 的函数）：
> 
> $\displaystyle\frac{1}{y} y' = \frac{1}{2} ( \frac{1}{x-1} + \frac{1}{x-2}$
> $\displaystyle  - \frac{1}{x-4} - \frac{1}{x-5})$
> 
> 整理得到导数表达式：
> 
> $\displaystyle\ y' = \frac{y}{2} ( \frac{1}{x-1} + \frac{1}{x-2}$
> $\displaystyle - \frac{1}{x-4} - \frac{1}{x-5})$
> 
> 将 $\displaystyle y = \sqrt{\frac{(x-1)(x-2)}{(x-4)(x-5)} }$ 代入：
> 
> $\displaystyle\ y' = \frac{1}{2} \sqrt{\frac{(x-1)(x-2)}{(x-4)(x-5)}}( \frac{1}{x-1}$
> $\displaystyle + \frac{1}{x-2} - \frac{1}{x-4} - \frac{1}{x-5})$

### 更多的高阶导数计算

> [!tip]
> 
> 微分的思想也可以帮助我们来理解和计算高阶导数, 结合链式法则, 我们可以进行更加复杂的计算.
> 

> [!caution]
> 
> ==常用记号==
> 
> - $f'(x)$, $f''(x)$, $f'''(x)$, $f^{(n)}(x)$, $\cdots$.
> - $\displaystyle \frac{d}{dx}f(x)$, $\displaystyle \frac{d^2}{dx^2}f(x)$, $\displaystyle \frac{d^3}{dx^3}f(x)$, $\displaystyle \frac{d^{n}}{dx^{n}}f(x)$, $\cdots$.
> 


> [!note]
> 
> ==P97 例2==
> 
> **设 $y = \cos(a x)$，求 $y''$**
> 
> 解： 求一阶导数 $y'$, 
> 
> $$y' = \frac{d}{dx} \cos(a x) = -a \sin(a x)$$
> 
> 求二阶导数 $y''$: 
> $$y'' = \frac{d}{dx} \left( -a \sin(a x) \right) = -a \cdot a \cos(a x) = -a^2 \cos(a x)$$
> 
> 最终得到：
> $$y'' = -a^2 \cos(a x)$$
>


> [!note]
> 
> ==P97 例4==
> 
> **求指数函数 $y = e^{kx}$（$k$ 为常数）的 $n$ 阶导数**
> 
> 解： 一阶导数：$\displaystyle y' = \frac{d}{dx} e^{kx} = ke^{kx}$
> 
> 二阶导数：$\displaystyle y'' = \frac{d}{dx} (ke^{kx}) = k^2 e^{kx}$
> 
> 三阶导数：$\displaystyle y''' = \frac{d}{dx} (k^2 e^{kx}) = k^3 e^{kx}$
> 
> 四阶导数：$\displaystyle y^{(4)} = \frac{d}{dx}(k^3 e^{kx})=k^4 e^{kx}$
> 
> 观察规律可知，每求导一次会多乘一个系数 $k$，因此一般形式为：$\displaystyle y^{(n)} = k^n e^{kx}$
> 

> [!note]
> 
> ==P103 例4==
> 
> **求由方程 $x + 2y - \frac{1}{3}\cos y = 0$ 所确定的隐函数的二阶导数 $\frac{d^2y}{dx^2}$**
> 
> 解： 对原方程两边关于 $x$ 求导：
> 
> $\displaystyle \frac{d}{dx}\left(x + 2y - \frac{1}{3}\cos y\right) = 0$
> 
> $\displaystyle 1 + 2\frac{dy}{dx} + \frac{1}{3}\sin y \cdot \frac{dy}{dx} =0$
> 
> $\displaystyle \frac{dy}{dx} \left(2 + \frac{1}{3}\sin y\right) = -1$
> 
> $\displaystyle \frac{dy}{dx} = \frac{-1}{2 + \frac{1}{3}\sin y} = \frac{-3}{6 + \sin y}$
> 
> 对一阶导数 $\displaystyle\frac{dy}{dx} = \frac{-3}{6 + \sin y}$ 两边关于 $x$ 求导：
> 
> $\displaystyle \frac{d^2y}{dx^2} = \frac{3\cos y \cdot \frac{-3}{6 + \sin y}}{(6 + \sin y)^2}$
> 
> 代入 $\displaystyle\frac{dy}{dx}$ 得到：$\displaystyle \frac{d^2y}{dx^2} = \frac{-9\cos y}{(6 + \sin y)^3}$

> [!note]
>
> 最后我们回过头来看一下图2中所给出的例子. 上面我们已经得到
> $$
> dx = -b \frac{1}{\sin^2 \theta}d\theta, \quad dl = -b \frac{\cos \theta}{\sin^2 \theta}d\theta
> $$
>
> 如果我们希望计算 $dx$ 与 $dl$ 的关系，即 $\dfrac{dx}{dl}$，可以采用以下两种方法：
>
> **方法一：建立 x 与 l 的显式函数关系**
>
> 由 $l = \dfrac{b}{\sin \theta}$ 可得 $\sin \theta = \dfrac{b}{l}$，代入 $x = \dfrac{b}{\tan \theta} = b\dfrac{\cos \theta}{\sin \theta}$ 得：
> $$
> x = b \cdot \frac{\cos \theta}{\sin \theta} = b \cdot \frac{\sqrt{1 - \sin^2 \theta}}{\sin \theta} = b \cdot \frac{\sqrt{1 - (b/l)^2}}{b/l} = l \cdot \sqrt{1 - \left(\frac{b}{l}\right)^2}
> $$
>
> 对 $l$ 求导得：
> $$
> \frac{dx}{dl} = \sqrt{1 - \left(\frac{b}{l}\right)^2} + l \cdot \frac{1}{2\sqrt{1 - (b/l)^2}} \cdot \frac{2b^2}{l^3} = \frac{1}{\sqrt{1 - (b/l)^2}} = \frac{1}{\cos \theta}
> $$
>
> 因此 $dx = \dfrac{1}{\cos \theta} dl$。
>
> **方法二：直接利用微分之比**
>
> 由 $dx$ 和 $dl$ 的表达式直接相除：
> $$
> \frac{dx}{dl} = \frac{-b \frac{1}{\sin^2 \theta}d\theta}{-b \frac{\cos \theta}{\sin^2 \theta}d\theta} = \frac{1}{\cos \theta}
> $$
>
> 同样得到 $dx = \dfrac{1}{\cos \theta} dl$。
>
> 两种方法结果一致，但第二种方法通过直接操作微分，避免了复杂的函数关系和求导过程，显示了微分运算的简洁性与灵活性。在实际问题中，灵活运用微分关系可以大大简化计算，这正是微分思想的强大之处。


## 借助微分计算极限

> [!tip]
> 
> 借助微分的思想和符号还可以帮助我们去理解一个较为使用的求极限方法: 洛必达法则.
>

### 洛必达法则

> [!important]
>
> **洛必达法则**是用于计算在不定形式 (未定式, 即: $0/0$或$\infty/\infty$) 下极限的有力工具.
>
> 如果函数 $f(x)$ 和 $g(x)$ 在点 $x=c$ 的某个邻域内可导，且在该点附近有：
>
> - $f(c) = 0$ 且 $g(c) = 0$ (或 $f(x)$ 和 $g(x)$ 的极限趋于 $\infty$). 
> - $g'(x) ≠ 0$.
>
> 那么
>
> $$
> \displaystyle \lim_{x\rightarrow c} \frac{f(x)}{g(x)} = \lim_{x\rightarrow c} \frac{f'(x)}{g'(x)},
> $$
>
> 前提是后者的极限存在.
>
> **注意**:  有时可能需要多次应用洛必达法则, 特别是当 $f'(x)/g'(x)$ 仍然是 $0/0$ 或 $\infty/\infty$ 的形式时.
>

> [!warning]
> 
> 下面我们借助微分的思想来理解洛必达法则.

> 当 $x$ 充分接近 $c$ 时，我们可以用函数的线性近似（即微分）来替代原函数。由于 $f(c) = g(c) = 0$，在点 $c$ 附近有：
> 
> $$
> f(x) \approx f(c) + f'(c)(x - c) = f'(c)(x - c)
> $$
> 
> $$
> g(x) \approx g(c) + g'(c)(x - c) = g'(c)(x - c)
> $$
> 
> 因此，原比式的极限可近似表示为：
> 
> $$
> \frac{f(x)}{g(x)} \approx \frac{f'(c)(x - c)}{g'(c)(x - c)} = \frac{f'(c)}{g'(c)}
> $$
> 
> 当 $x \to c$ 时，这一近似将趋于精确。这正是洛必达法则的直观含义——在极限过程中，分子与分母的**变化趋势**由它们在该点的导数之比决定。
> 
> 对于 $\infty/\infty$ 型未定式，虽然不能直接使用上述推导，但微分思想仍然适用：此时我们比较的是 $f(x)$ 与 $g(x)$ 在 $x \to c$ 过程中的**相对变化速率**，而导数正是刻画这种瞬时变化率的工具。
> 
> 需要强调的是，上述推导仅为理解洛必达法则提供了直观的几何图像。严格证明需依赖**柯西中值定理**，该定理能够将 $\dfrac{f'(c)}{g'(c)}$ 替换成 $\dfrac{f'(\xi)}{g'(\xi)}$，其中 $\xi$ 位于 $x$ 与 $c$ 之间, 从而得到使用起来更加灵活的洛必达法则。这部分内容我们放在了后面的章节中. 
>
> 
> [!note]
> 
> P134-P136, 例1-10.


> [!warning]
> 
> 后面的章节中, 我们会介绍更加强大的计算极限的工具---泰勒展开. 而泰勒展开体现的也是微分的思想.

---
title: 高等数学讲义
author: 胡煜成
description: 首都师范大学高等数学A
"og:description": 浏览器版和手机版
"og:image": https://vlook-doc.pages.dev/pic/vlook-og.png
keywords:
- 高等数学,微积分,讲义
vlook-chp-autonum: h1=off
vlook-query: vdl=on
vlook-query: ws=off
---

[toc]

# 积分

> [!tip]
>  
> 在微积分的发展历程中，积分与微分如同一对孪生兄弟，共同构成了现代数学的基石。
> 如果说微分研究的是函数在**局部**的瞬时变化率，那么积分则致力于从**整体**上把握量的累积效应。
> 
> 为什么要引入积分？
> 让我们从几个经典问题开始思考：
> 
> 1. **面积问题**：如何计算由任意曲线围成的平面图形的面积？
> 2. **距离问题**：已知物体运动的速度随时间变化，如何计算它在某段时间内走过的总路程？
> 3. **体积问题**：如何计算旋转体或不规则立体的体积？
> 
> 这些问题看似各异，但本质上都涉及到一个共同的思想——**"化整为零，积零为整"**。
> 我们将复杂的整体分解为无数个简单的微小部分，分别计算每个微小部分的贡献，然后将这些微小贡献累加起来，当分割无限精细时，就得到了精确的整体量。
> 
> 积分不仅仅是一种计算工具，更是一种思维方式。
> 它在物理学中用于计算功、能量、质心；在工程学中用于分析应力、流量；在经济学中用于计算总收益、消费者剩余；在概率论中则是定义连续型随机变量概率密度的基础。
> 
> 本章将带领大家沿着历史发展的轨迹，首先建立积分的概念，然后揭示积分与微分之间深刻的内在联系——微积分基本定理，最后掌握计算积分的基本方法。
> 

## 积分的概念

> [!tip]
> 
> ==问题引入：从规则图形到曲边图形==
> 
> **什么是面积？**
> 这是一个看似简单却深奥的问题。
> 
> 在初等几何中，我们以边长为1的正方形作为**单位面积**，基于此定义了：
> - 矩形的面积 = 长 × 宽
> - 三角形的面积 = ½ × 底 × 高
> - 多边形的面积可通过分割为三角形求和得到
> 
> 这套方法在古代丈量田地时已经足够实用。
> 然而，当人类文明的触角伸向更精深的科学领域时，我们遇到了新的挑战：
> 
> - **圆的面积**：如何精确计算圆的面积？
> 古希腊的阿基米德用"穷竭法"不断用内接正多边形逼近圆，已经蕴含了积分思想的萌芽。
> 
> - **椭圆面积**：行星轨道是椭圆，计算椭圆面积对天文学至关重要。
> 
> - **一般曲线围成的面积**：在物理学和工程学中，经常需要计算由复杂曲线围成的区域的面积。
> 
> 这些问题的共同特点是：**边界不再是直线，而是曲线**。
> 传统的几何方法对此无能为力，我们需要一种全新的数学工具——这就是积分诞生的背景。
> 

> [!note]
> 
> ==通过极限定义积分==
> 
> 让我们从一个具体例子出发：计算由曲线$y = f(x)$、直线$x = a$、$x = b$以及$x$轴所围成的曲边梯形的面积。
> 
> 我们考虑一个具体的函数：半径为$\sqrt{2}$、圆心在$(\sqrt{2}, 0)$的圆的上半部分。
> 这个圆的方程为：$(x - \sqrt{2})² + y² = 2$，所以上半圆的函数为 $y = f(x) = \sqrt{2 - (x - \sqrt{2})²}$。
> 我们计算这个上半圆在区间 $[0, 2\sqrt{2}]$ 上的面积，这正好是半个圆的面积, 中学我们已经学过圆的面积公式, 知道这半个圆的面积正好等于 $\pi$。
> 
> **第一步：分割**
> 将区间 $[0, 2\sqrt{2}]$ 分成 $n$ 个小区间，设分点为：
> $0 = x_0 < x_1 < x_2 < \cdots < x_n = 2\sqrt{2}$
> 每个小区间长度为 $\Delta x_i = x_i - x_{i-1}$
> 为简单起见，我们可以采用等分，即 $\Delta x = (2\sqrt{2} - 0)/n = 2\sqrt{2}/n$
> 
> **第二步：近似代替**
> 在每个小区间 $[x_{i-1}, x_i]$ 上任取一点 $\xi_i$，例如取右端点 $\xi_i = x_i$。
> 用高为 $f(\xi_i) = \sqrt{2 - (\xi_i - \sqrt{2})^2}$、宽为 $\Delta x$ 的小矩形面积 $f(\xi_i)\Delta x$ 来近似代替该小区间上曲边梯形的面积。
> 
> **第三步：求和**
> 将所有小矩形的面积相加，得到整个曲边梯形面积的近似值：
> $$
> S_n = \sum_{i=1}^n f(\xi_i)\Delta x
> $$
> 这个和称为**黎曼和**(Riemann sum)
> 
> **第四步：取极限**
> 当分割越来越细，即 $n \to \infty$ 时，$\Delta x \to 0$，如果黎曼和的极限存在，我们就定义这个极限值为曲边梯形的面积：
> $$
> S = \lim_{n\to\infty} S_n = \lim_{n\to\infty} \sum_{i=1}^n f(\xi_i)\Delta x
> $$
> 
> 取 $n=4, 8, 16, 32, \ldots$ 计算 $S_n$ 的值，会发现 $S_n$ 趋近于 $\pi$（见下表）。
> 
> | $n$ | $S_n$ | 误差 |
> |------|------------|-----------------|
> | 4    | 2.732      | 0.4096          |
> | 8    | 2.995      | 0.1466          |
> | 16   | 3.084      | 0.0576          |
> | 32   | 3.121      | 0.0206          |
> | 64   | 3.134      | 0.0076          |
> | 128  | 3.139      | 0.0026          |
> | 256  | 3.141      | 0.0006          |
> | 512  | 3.1415     | 0.0001          |
> | 1024 | 3.14157    | 0.00002         |
> 
> 这个表格直观地展示了黎曼和随着分割数 $n$ 的增加而收敛于精确面积 $\pi$ 的过程，体现了积分作为"无限细分、无限求和"极限过程的本质。

> [!important]
>
> ==积分的定义==
> 
> 设函数 $f(x)$ 在区间 $[a, b]$ 上有定义。
> 用分点 $a = x_0 < x_1 < \cdots < x_n = b$ 将区间任意分割成 $n$ 个小区间，在每个小区间 $[x_{i-1}, x_i]$ 上任取一点 $\xi_i$，作黎曼和 $\sum_{i=1}^n f(\xi_i)\Delta x_i$。
> 
> 如果当最大小区间长度 $\lambda = \max\{\Delta x_i\} \to 0$ 时，黎曼和的极限存在且与区间的分割方式以及点 $\xi_i$ 的取法无关，则称函数 $f(x)$ 在 $[a, b]$ 上**可积**，并称此极限值为 $f(x)$ 在 $[a, b]$ 上的**定积分**，记作：
> 
> $$
> \int_a^b f(x)\,dx = \lim_{\lambda\to 0} \sum_{i=1}^n f(\xi_i)\Delta x_i
> $$
> 
> 其中：
> - "$\int$" 是积分号，由莱布尼兹引入，是求和符号 "$S$" 的拉长
> - $f(x)$ 称为**被积函数**
> - $f(x)dx$ 称为**被积表达式**
> - $x$ 称为**积分变量**
> - $[a, b]$ 称为**积分区间**
> - $a$ 称为**积分下限**，$b$ 称为**积分上限**
> 
> **几何意义**：当 $f(x) \geq 0$ 时，定积分 $\int_a^b f(x)\,dx$ 表示由曲线 $y = f(x)$、直线 $x = a$、$x = b$ 与 $x$ 轴所围成的曲边梯形的面积。

> [!note]
> 
> ==通过定义计算积分==
> 
> **例1** 计算 $\int_0^1 x\,dx$
> 
> 解：将 $[0,1]$ $n$ 等分，$\Delta x = 1/n$，取 $\xi_i$ 为每个小区间的右端点，即 $\xi_i = i/n$
> 
> 黎曼和 $= \sum_{i=1}^n (i/n)\cdot(1/n) = (1/n^2) \sum_{i=1}^n i = (1/n^2)\cdot n(n+1)/2 = (n+1)/(2n)$
> 
> 当 $n\to\infty$ 时，$\lim_{n\to\infty} (n+1)/(2n) = 1/2$
> 
> $\int_0^1 x\,dx = 1/2$
> 
> **例2** 计算 $\int_0^1 x^2\,dx$
> 
> 解：同样 $n$ 等分 $[0,1]$，$\Delta x = 1/n$，取 $\xi_i = i/n$
> 
> 黎曼和 $= \sum_{i=1}^n (i/n)^2\cdot(1/n) = (1/n^3) \sum_{i=1}^n i^2 = (1/n^3)\cdot n(n+1)(2n+1)/6$
> 
> 当 $n\to\infty$ 时，极限 $= 1/3$
> 
> $\int_0^1 x^2\,dx = 1/3$
> 
> 从这两个例子我们看到，用定义计算积分虽然思路直接，但过程繁琐。
> 在下一节中，我们将介绍微积分基本定理，它提供了计算定积分的强大工具。

## 微积分基本定理

> [!tip]
> 
> 在上一节中，我们通过黎曼和的极限定义了定积分，并用这种方法计算了几个简单函数的积分。
> 然而，这种方法极其繁琐，对于复杂函数几乎无法实际应用。
> 我们需要一种更高效、更强大的工具来计算定积分。
> 
> 微积分基本定理正是这样的工具，它被誉为"整个微积分学中最重要的定理"。
> 这个定理的核心内容由牛顿和莱布尼茨在17世纪独立发现，因此又被称为**牛顿-莱布尼茨公式**。
> 
> 这两位数学巨匠的工作将积分学与微分学这两个看似独立的领域联系起来，揭示了它们之间深刻的内在联系，从而奠定了现代微积分的基础。
> 

> [!important]
> 
> ==微积分基本定理（牛顿-莱布尼茨公式）==
> 
> 设函数 $f$ 在区间 $[a, b]$ 上连续，且 $F$ 是 $f$ 的任意一个原函数（即 $F'(x) = f(x)$），则
> $$
> \int_a^b f(x)\,dx = F(b) - F(a)
> $$
> 
> 通常记作：$\int_a^b f(x)\,dx = F(x)\big|_a^b = F(b) - F(a)$
> 
> **定理的意义**
> - 它将复杂的积分计算问题转化为相对简单的求原函数问题。
> - 它建立了微分与积分之间的互逆关系：求导和积分在某种意义上是"相反"的运算。
> - 它统一了微积分的两大核心操作，揭示了变化率与累积量之间的深刻联系。
> 
> **定理的直观证明**
> 
> 让我们从直观的角度来理解为什么这个定理成立。
> 
> 考虑定积分 $\int_a^b f(x)\,dx$，它表示曲线 $y = f(x)$ 下从 $a$ 到 $b$ 的面积。
> 
> 现在定义一个新的函数：$A(x) = \int_a^x f(t)\,dt$，它表示从 $a$ 到 $x$ 的曲线下面积。
> 
> **关键洞察**：当我们给 $x$ 一个微小的增量 $\Delta x$ 时，面积 $A$ 的增量为：
> $$
> \Delta A = A(x+\Delta x) - A(x) = \int_x^{x+\Delta x} f(t)\,dt
> $$
> 
> 当 $\Delta x$ 很小时，在小区间 $[x, x+\Delta x]$ 上，$f(t)$ 的值近似等于 $f(x)$，
> 因此 $\Delta A \approx f(x)\Delta x$
> 
> 于是有 $\Delta A/\Delta x \approx f(x)$
> 
> 当 $\Delta x \to 0$ 时，这个近似变得精确，所以我们发现：
> $$
> A'(x) = \lim_{\Delta x\to 0} \frac{\Delta A}{\Delta x} = f(x)
> $$
> 
> 这意味着：**面积函数 $A(x)$ 的导数正好等于被积函数 $f(x)$**！
> 
> 换句话说，$A(x)$ 是 $f(x)$ 的一个原函数。
> 
> 现在，设 $F$ 是 $f$ 的任意一个原函数，由于同一函数的任意两个原函数之间只相差一个常数，所以
> $A(x) = F(x) + C$
> 
> 当 $x = a$ 时，$A(a) = \int_a^a f(t)\,dt = 0$，所以
> $0 = F(a) + C$，即 $C = -F(a)$
> 
> 因此 $A(x) = F(x) - F(a)$
> 
> 当 $x = b$ 时，$A(b) = \int_a^b f(t)\,dt = F(b) - F(a)$
> 
> 这就完成了证明。

> [!note]
> 
> **例1** 计算 $\int_0^1 x^2\,dx$
> 
> 解：$f(x) = x^2$ 的一个原函数是 $F(x) = x^3/3$
> 根据微积分基本定理：
> $$
> \int_0^1 x^2\,dx = F(1) - F(0) = \frac{1^3}{3} - \frac{0^3}{3} = \frac{1}{3}
> $$
> 
> 这与我们之前用黎曼和极限计算的结果一致，但过程简单得多。
> 
> **例2** 计算 $\int_0^\pi \sin x\,dx$
> 
> 解：$\sin x$ 的一个原函数是 $-\cos x$
> 根据微积分基本定理：
> $$
> \int_0^\pi \sin x\,dx = [-\cos x]_0^\pi = -\cos\pi - (-\cos 0) = 1 + 1 = 2
> $$
> 
> **例3** 计算 $\int_1^e \frac{1}{x}\,dx$
> 
> 解：$\frac{1}{x}$ 的一个原函数是 $\ln|x|$
> 根据微积分基本定理：
> $$
> \int_1^e \frac{1}{x}\,dx = \ln e - \ln 1 = 1 - 0 = 1
> $$
> 
> 这些例子展示了微积分基本定理的强大威力——它将复杂的极限计算简化为简单的代数运算。
> 

## 积分的性质和运算

### 积分的性质

> [!important]
>  
> 定积分具有一系列重要的性质，这些性质不仅有助于我们理解积分的本质，还能简化积分的计算。
> 
> **1. 线性性质**
> 
> 若函数 $f$ 和 $g$ 在 $[a, b]$ 上可积，$c$ 为常数，则：
> 
> - **加法性质**：$\int_a^b [f(x) + g(x)]\,dx = \int_a^b f(x)\,dx + \int_a^b g(x)\,dx$
> - **数乘性质**：$\int_a^b c\cdot f(x)\,dx = c\cdot \int_a^b f(x)\,dx$
> 
> **几何解释**：加法性质表示两个函数围成的总面积等于各自面积的代数和；数乘性质表示函数值按比例缩放时，面积也按相同比例缩放。
>

> [!important]
>
> **2. 区间可加性**
> 
> 若函数 $f$ 在包含 $a, b, c$ 的区间上可积，则：
> $$
> \int_a^b f(x)\,dx = \int_a^c f(x)\,dx + \int_c^b f(x)\,dx
> $$
> 
> **几何解释**：从 $a$ 到 $b$ 的总面积等于从 $a$ 到 $c$ 的面积加上从 $c$ 到 $b$ 的面积。
>

> [!important]
>
> **3. 积分上下限交换**
> 
> $$
> \int_a^b f(x)\,dx = -\int_b^a f(x)\,dx
> $$
> 
> **几何解释**：当积分方向反转时，面积值变号，这保证了面积的方向性。
>

> [!important]
>
> **4. 绝对值不等式**
> 
> $$
> \left|\int_a^b f(x)\,dx\right| \leq \int_a^b |f(x)|\,dx
> $$
> 
> **几何解释**：函数积分的绝对值不超过函数绝对值积分，因为绝对值积分计算的是总面积（不考虑正负），而普通积分计算的是代数和。
>

> [!important]
>
> **5. 积分比较定理**
> 
> 若在 $[a, b]$ 上 $f(x) \leq g(x)$，则
> $$
> \int_a^b f(x)\,dx \leq \int_a^b g(x)\,dx
> $$
> 
> **几何解释**：函数值较大的曲线在相同区间上围成的面积也较大。
> 

### 不定积分的运算

> [!tip] 
> 不定积分是求原函数的过程，其结果是一个函数族（相差一个常数）。以下是计算不定积分的两种基本方法.
>

> [!important]
> 
> ==换元积分法==
> 
> 换元积分法源于链式法则的逆运算，是计算积分最强大的工具之一。
> 
> **基本思想**：通过变量代换，将复杂的积分转化为简单的积分。
> 
> **定理**：设函数 $f$ 在区间 $I$ 上连续，函数 $\varphi$ 在区间 $J$ 上可导且值域包含于 $I$，则
> $$
> \int f(\varphi(x))\varphi'(x)\,dx = \int f(u)\,du,\quad u = \varphi(x)
> $$
> 
> **直观解释**：链式法则告诉我们 $(F(\varphi(x)))' = F'(\varphi(x))\cdot\varphi'(x) = f(\varphi(x))\varphi'(x)$
> 因此，$\int f(\varphi(x))\varphi'(x) dx$ 应该是 $F(\varphi(x)) + C$
> 这正是 $\int f(u) du$ 在 $u = \varphi(x)$ 时的结果。

> [!note]
> 
> **例1** 计算 $\int 2x\cos(x^2)\,dx$
> 
> 解：令 $u = x^2$，则 $du = 2x\,dx$
> 原积分 $= \int \cos(u)\,du = \sin(u) + C = \sin(x^2) + C$
> 
> **例2** 计算 $\int x\sqrt{x^2+1}\,dx$
> 
> 解：令 $u = x^2+1$，则 $du = 2x\,dx$，$x\,dx = du/2$
> 原积分 $= \int \sqrt{u}\cdot (du/2) = \frac{1}{2}\int u^{1/2}\,du = \frac{1}{2}\cdot\frac{2}{3}u^{3/2} + C = \frac{1}{3}(x^2+1)^{3/2} + C$
> 

> [!important]
> 
> ==分部积分法==
> 
> 分部积分法源于乘积求导法则的逆运算，适用于计算两个函数乘积的积分。
> 
> **基本思想**：将难以直接计算的积分 $\int u\,dv$ 转化为更容易计算的 $\int v\,du$
> 
> **公式**：$\int u\,dv = uv - \int v\,du$
> 
> **直观解释**：乘积法则告诉我们 $(uv)' = u'v + uv'$
> 两边积分得：$uv = \int u'v dx + \int uv' dx$
> 整理得：$\int uv' dx = uv - \int u'v dx$
> 这就是分部积分公式。

> [!note]
> 
> **例1** 计算 $\int x e^x\,dx$
> 
> 解：令 $u = x, dv = e^x\,dx$，则 $du = dx, v = e^x$
> 原积分 $= x e^x - \int e^x\,dx = x e^x - e^x + C$
> 
> **例2** 计算 $\int \ln x\,dx$
> 
> 解：令 $u = \ln x, dv = dx$，则 $du = (1/x)\,dx, v = x$
> 原积分 $= x\ln x - \int x\cdot(1/x)\,dx = x\ln x - \int dx = x\ln x - x + C$
> 

### 定积分的运算

> [!tip]
> 定积分的计算可以使用与不定积分相同的方法，但有一些重要区别：


> [!important]
> 
> ==定积分的换元法==
> 
> 与不定积分的换元法相比，定积分的换元法有一个重要特点：**需要同时改变积分限**。
> 
> **定理**：设函数 $f$ 在区间 $[a, b]$ 上连续，函数 $\varphi$ 在区间 $[\alpha, \beta]$ 上具有连续导数，且 $\varphi(\alpha) = a, \varphi(\beta) = b$，则
> $$
> \int_a^b f(x)\,dx = \int_\alpha^\beta f(\varphi(t))\varphi'(t)\,dt
> $$
> 
> **关键区别**：在定积分中使用换元法时，不仅要进行变量代换，还要相应地改变积分上下限。

> [!note]
> 
> **例1** 计算 $\int_0^{\pi/2} \sin^2 x \cos x\,dx$
> 
> 解：令 $u = \sin x$，则 $du = \cos x\,dx$
> 当 $x = 0$ 时，$u = \sin 0 = 0$；当 $x = \pi/2$ 时，$u = \sin(\pi/2) = 1$
> 原积分 $= \int_0^1 u^2\,du = \frac{u^3}{3}\Big|_0^1 = \frac{1}{3}$
> 
> **例2** 计算 $\int_1^4 \frac{\sqrt{x}}{1+\sqrt{x}}\,dx$
> 
> 解：令 $u = 1+\sqrt{x}$，则 $du = \frac{1}{2\sqrt{x}}\,dx$，$dx = 2(u-1)\,du$
> 当 $x = 1$ 时，$u = 2$；当 $x = 4$ 时，$u = 3$
> 原积分 $= \int_2^3 \frac{u-1}{u} \cdot 2(u-1)\,du = 2\int_2^3 \frac{(u-1)^2}{u}\,du$
> $= 2\int_2^3 (u - 2 + 1/u)\,du = 2\left[\frac{u^2}{2} - 2u + \ln|u|\right]_2^3$
> $= [u^2 - 4u + 2\ln|u|]_2^3 = (9-12+2\ln 3) - (4-8+2\ln 2) = 1 + 2\ln(3/2)$
> 

> [!important]
> 
> ==定积分的分部积分法==
> 
> 定积分的分部积分法与不定积分类似，但结果是一个数值而非函数。
> 
> **公式**：$\int_a^b u\,dv = [uv]_a^b - \int_a^b v\,du$
> 
> **关键区别**：在定积分的分部积分法中，$uv$ 项需要代入上下限计算。

> [!note]
> 
> **例1** 计算 $\int_0^1 x e^x\,dx$
> 
> 解：令 $u = x, dv = e^x\,dx$，则 $du = dx, v = e^x$
> 原积分 $= [x e^x]_0^1 - \int_0^1 e^x\,dx = (1\cdot e - 0) - [e^x]_0^1 = e - (e - 1) = 1$
> 
> **例2** 计算 $\int_1^e \ln x\,dx$
> 
> 解：令 $u = \ln x, dv = dx$，则 $du = (1/x)\,dx, v = x$
> 原积分 $= [x\ln x]_1^e - \int_1^e x\cdot(1/x)\,dx = (e\cdot 1 - 1\cdot 0) - \int_1^e dx = e - [x]_1^e = e - (e - 1) = 1$
> 

> [!important]
> 
> ==定积分的特殊性质==
> 
> 定积分还有一些不定积分不具备的特殊性质：
> 
> **对称性**：
> - 若 $f$ 是偶函数（$f(-x) = f(x)$），则 $\int_{-a}^a f(x)\,dx = 2\int_0^a f(x)\,dx$
> - 若 $f$ 是奇函数（$f(-x) = -f(x)$），则 $\int_{-a}^a f(x)\,dx = 0$
> 
> **周期性**：
> 若 $f$ 是周期为 $T$ 的周期函数，则 $\int_a^{a+T} f(x)\,dx = \int_0^T f(x)\,dx$
> 
> 这些特殊性质可以大大简化定积分的计算。
> 
> 通过掌握这些积分方法，我们能够解决各种复杂的积分计算问题，为后续的数学学习和应用打下坚实基础。

> [!warning]
> 
> ==人生就像一场积分==
> 
> 人生就像一场积分, **考上大学，从一个环境到另一个环境，就像积分中的换元法**。但换元法的精髓在于：**改变变量的同时，必须调整积分的上下限**。
> 
> 这意味着：
> - 你不能用高中的标准来衡量大学的生活
> - 你不能用过去的思维来解决现在的问题  
> - 你不能用旧的习惯来面对新的环境
> 
> 就像在定积分的换元中，如果只改变被积函数而忘记改变积分限，结果必然是错误的。在人生的换元中，如果只改变环境而不调整自己的心态、目标和行为方式，同样难以获得正确的人生积分。
> 
> 每一次重要的转变——无论是升学、就业、结婚，还是任何重大的人生抉择——都是一次换元。成功的换元需要我们：
> 
> 1. **认清新旧变量的对应关系**：理解新旧环境之间的差异和联系
> 2. **准确计算新的上下限**：明确在新阶段中的起点和目标
> 3. **勇敢地执行变换**：主动适应新的规则和节奏
> 
> 积分教会我们的不仅是数学技巧，更是一种人生智慧：**懂得在变化中保持本质，在转型中完成累积**。
> 
> 愿你善于运用人生的"换元法"，在每一个转折点都能准确调整自己的"积分上下限"，让生命的定积分值不断增长，最终收获丰盈而充实的人生。
>

---
title: 高等数学讲义
author: 胡煜成
description: 首都师范大学高等数学A
"og:description": 浏览器版和手机版
"og:image": https://vlook-doc.pages.dev/pic/vlook-og.png
keywords:
- 高等数学,微积分,讲义
vlook-chp-autonum: h1=off
vlook-query: vdl=on
vlook-query: ws=off
---

[toc]

# 函数的整体与局部性质


## 中值定理


> [!tip]
> 
> **中值定理**是微积分中的核心结论. 类似于连续函数的**介值定理**, **中值定理**揭示了连续且可导的函数局部和整体之间的某种联系.

### 拉格朗日中值定理

> [!important]
>
> 
>
>  **微分中值定理（拉格朗日中值定理）：**
>  设函数 $f(x)$ 在闭区间 $[a, b]$ 上连续，并且在开区间 $(a, b)$ 上可导。那么，存在一个点 $c \in (a, b)$，使得：
>  $$
>  f'(c) = \frac{f(b) - f(a)}{b - a}
>  $$
>  
>  该定理的几何意义是：在曲线 $y = f(x)$ 上，至少存在一点 $c$，它的切线斜率等于割线通过点 $(a, f(a))$ 和 $(b, f(b))$ 的斜率。
> 
>  ![中值定理](../media/img/mean_value_theorem.png#400h)
>  

> [!warning]
> 
> ==定理的直观理解==
> 
> 想象你开车从A城市到B城市，总距离是 $f(b)-f(a)$，总时间是 $b-a$，那么你的平均速度就是 $\frac{f(b)-f(a)}{b-a}$。
> 
> 微分中值定理告诉我们：在整个旅途中，**至少存在某一时刻**，你的瞬时速度（导数）恰好等于这个平均速度。
> 
> 从几何角度看，连接曲线两端点的割线斜率就是这个平均变化率，而定理保证曲线上至少有一点，该点的切线平行于这条割线。

> [!warning]  
> 
>  **注意**: 该定理的结论也是**存在性**的, 并没有给出这个点 $c$ 的具体计算方法.
> 
> 微分中值定理建立了函数的**局部性质**（导数）与**整体性质**（函数值变化）之间的桥梁：
> 
> - **局部到整体**：通过各点的局部变化率，可以推断函数在整个区间上的变化情况
> - **微观到宏观**：无穷小的微分信息蕴含着有限增量的整体信息
> - **存在性到构造性**：虽然定理只保证存在性，但为许多问题的解决提供了关键思路
> 
> 这个定理是后续泰勒展开、函数单调性分析、极值理论等重要内容的基础，在微分方程、优化理论等领域都有广泛应用。

> [!note]
> 
> 定理的应用举例
> 
> **例1** 证明不等式：$|\sin x - \sin y| \leq |x-y|$
> 
> 证明：对函数 $f(t)=\sin t$ 在区间 $[x,y]$（或 $[y,x]$）上应用中值定理：
> 存在 $c$ 介于 $x,y$ 之间，使得：
> $$
> \frac{\sin x - \sin y}{x-y} = \cos c
> $$
> 
> 因为 $|\cos c| \leq 1$，所以：
> $$
> \left|\frac{\sin x - \sin y}{x-y}\right| \leq 1
> $$
> 
> 即 $|\sin x - \sin y| \leq |x-y|$。
> 
> **例2** 证明：如果 $f'(x)=0$ 在整个区间上成立，则 $f(x)$ 是常数函数。
> 
> 证明：任取 $a<b$，由中值定理，存在 $c\in(a,b)$ 使得：
> $$
> f(b)-f(a) = f'(c)(b-a) = 0
> $$
> 
> 所以 $f(b)=f(a)$，即函数值不变，$f(x)$ 是常数函数。
> 

>[!note]
>
> ==反例==
> 
> 如下图，该函数在 $ (0, 2) $ 上不可导，不满足拉格朗日中值定理的前提条件，所以不能应用该定理。
>![](../media/img/chap2_2.png)
>

> [!note]
> 
>  ==例1==
>  
>  **$f(x) = x^2$ 对任意两点 $x_1$, $x_2$.**
> 
> 解： $ f(x) = x^2 $ 是多项式函数，在任意区间 $[x_1, x_2]$ 上连续且可导，满足拉格朗日中值定理的条件。  
> 
>  $\displaystyle\frac{f(x_2) - f(x_1)}{x_2 - x_1} = \frac{x_2^2 - x_1^2}{x_2 - x_1} = x_2 + x_1$  
> 
> 根据定理，存在 $ c \in (x_1, x_2) $ 使得：
   $\displaystyle f'(c) = 2c = x_2 + x_1$解得：
   $\displaystyle c = \frac{x_1 + x_2}{2}$结论：中值点 $ c $ 为区间中点，满足定理要求。  
> 
>> ==例2==
>  
> **$f(x) = x^3$ 对 $x_1 = 0$, $x_2 = 1$.**
> 
> 解： $ f(x) = x^3 $ 在 $[0, 1]$ 上连续且可导，满足定理条件。
> $\displaystyle \frac{f(1) - f(0)}{1 - 0} = \frac{1^3 - 0^3}{1} = 1$ 
>  根据定理，存在 $ c \in (0, 1) $ 使得：$\displaystyle f'(c) = 3c^2 = 1$  $\displaystyle  c = \frac{1}{\sqrt{3}} \approx 0.577$  结论：中值点 $ c = \frac{1}{\sqrt{3}} $ 满足定理要求。  

> [!caution]

> ==补充应用:利普希茨Lipschitz连续==
> 
> 若 $ f(x) $ 在区间 $ I $ 上满足拉格朗日中值定理，且导数有界（即 $ |f'(x)| \leq M $），则 $ f(x) $ 是 **Lipschitz连续** 的，即：
> $\displaystyle|f(x_1) - f(x_2)| \leq M |x_1 - x_2|, \quad \forall x_1, x_2 \in I.$
> 
> 
> **有限增量公式**
> 
> 对任意 $ x, y \in [a, b] $，存在 $ \theta \in (0, 1) $，使得：
> $\displaystyle f(y) - f(x) = f'(x + \theta \Delta x) \Delta x, \quad 0 < \theta < 1.$  其中 $ \Delta x = y - x $

### 罗尔中值定理和柯西中值定理

> [!important]
> 
> ==罗尔中值定理==
> 
> **罗尔中值定理：**
> 设函数 $f(x)$ 在闭区间 $[a, b]$ 上连续，在开区间 $(a, b)$ 上可导，并且 $f(a) = f(b)$。那么，存在一个点 $c \in (a, b)$，使得：
> $$
> f'(c) = 0
> $$
> 
> **几何意义**：如果一条连续光滑的曲线在两个端点处的高度相同，那么至少存在一点，该点的切线是水平的。
> 
> **证明思路**：如果函数在闭区间上恒为常数，结论显然成立。否则，根据极值定理，函数在闭区间上必有最大值和最小值，且至少有一个极值点出现在开区间内部，在该点处导数为零。

> [!important]
>
> ==拉格朗日中值定理==
> 
> 设函数 $f(x)$ 在闭区间 $[a, b]$ 上连续，并且在开区间 $(a, b)$ 上可导。那么，存在一个点 $c \in (a, b)$，使得：
> $$
> f'(c) = \frac{f(b) - f(a)}{b - a}
> $$
>
> **几何意义**：在曲线 $y = f(x)$ 上，至少存在一点 $c$，它的切线斜率等于割线通过点 $(a, f(a))$ 和 $(b, f(b))$ 的斜率。
> 
> **证明思路**：构造辅助函数 $g(x) = f(x) - \frac{f(b)-f(a)}{b-a}(x-a)$，使得 $g(a)=g(b)$，然后应用罗尔定理。
> 

> [!important]
>
> ==柯西中值定理==
> 
> 设函数 $f(x)$ 和 $g(x)$ 在闭区间 $[a, b]$ 上连续，在开区间 $(a, b)$ 上可导，且 $g'(x) \neq 0$ 对于所有 $x \in (a, b)$ 成立。那么，存在一个点 $c \in (a, b)$，使得：
> $$
> \frac{f(b) - f(a)}{g(b) - g(a)} = \frac{f'(c)}{g'(c)}
> $$
> 
> **几何意义**：考虑由参数方程 $x = g(t), y = f(t)$ 表示的曲线，从 $t=a$ 到 $t=b$。连接曲线两端点的割线斜率为 $\frac{f(b)-f(a)}{g(b)-g(a)}$，而曲线上在 $t=c$ 处的切线斜率为 $\frac{f'(c)}{g'(c)}$。柯西中值定理说明，至少存在一点 $c$，使得切线斜率等于割线斜率。
> 
> **证明思路**：构造辅助函数 $h(x) = f(x) - \frac{f(b)-f(a)}{g(b)-g(a)}[g(x)-g(a)]$，使得 $h(a)=h(b)$，然后应用罗尔定理。

> [!important]
> 
> ==三个中值定理的关系==
> 
> - **罗尔定理**是**拉格朗日定理**的特殊情况：当 $f(a)=f(b)$ 时，拉格朗日定理的结论退化为罗尔定理的结论。
> - **拉格朗日定理**是**柯西定理**的特殊情况：当 $g(x)=x$ 时，柯西定理的结论退化为拉格朗日定理的结论。
> - 这三个定理都是描述函数在区间上整体变化率与局部变化率之间的关系，都是**存在性**定理。

> [!note]
> 
> **例1** 书上的例子.

### 积分中值定理

> [!tip]
> 
> 在介绍了微分中值定理系列之后，下面我们要探讨积分学中对应的**积分中值定理**。这个定理建立了定积分与函数值之间的重要联系，在理论和应用中都有重要价值。

> [!tip]
> 
> ==积分中值定理的引入==
> 
> 回顾定积分的几何意义：它表示曲边梯形的面积。一个自然的问题是：这个面积能否用某个"平均高度"乘以底边长度来表示？
> 
> **直观理解**：对于连续函数 $f(x)$ 在区间 $[a,b]$ 上的定积分，存在某个点 $c \in [a,b]$，使得以 $f(c)$ 为高的矩形面积等于曲边梯形的面积。

> [!important]
>  
> ==积分中值定理==
> 
> 设函数 $f(x)$ 在闭区间 $[a, b]$ 上连续，则存在一点 $c \in [a, b]$，使得
> $$
> \int_a^b f(x)  dx = f(c)(b - a)
> $$
> 
> 数值 $\frac{1}{b-a} \int_a^b f(x)  dx$ 称为函数 $f(x)$ 在区间 $[a,b]$ 上的**积分平均值**。
> 
> **几何意义**：由曲线 $y = f(x)$、直线 $x=a$、$x=b$ 和 $x$ 轴所围成的曲边梯形的面积，等于以 $f(c)$ 为高的矩形的面积。
> 
> **证明**：
> 
> 由于 $f(x)$ 在 $[a, b]$ 上连续，根据闭区间上连续函数的性质：
> 
> 1. $f(x)$ 在 $[a, b]$ 上取得最小值 $m$ 和最大值 $M$，即
>    $$
>    m \leq f(x) \leq M, \quad \forall x \in [a,b]
>    $$
> 
> 2. 对不等式两边在 $[a,b]$ 上积分：
>    $$
>    \int_a^b m  dx \leq \int_a^b f(x)  dx \leq \int_a^b M  dx
>    $$
>    即
>    $$
>    m(b-a) \leq \int_a^b f(x)  dx \leq M(b-a)
>    $$
> 
> 3. 因此：
>    $$
>    m \leq \frac{1}{b-a} \int_a^b f(x)  dx \leq M
>    $$
> 
> 4. 根据连续函数的介值定理，存在 $c \in [a,b]$，使得
>    $$
>    f(c) = \frac{1}{b-a} \int_a^b f(x)  dx
>    $$
> 
> 5. 即：
>    $$
>    \int_a^b f(x)  dx = f(c)(b-a)
>    $$
> 
> 证毕。

> [!warning]
> 
> ### 注意事项
> 
> 1. **连续性要求**：定理要求函数连续，这是结论成立的关键条件
> 
> 2. **存在性而非构造性**：定理只保证存在性，不提供求 $c$ 的具体方法
> 
> 3. **点的位置**：$c$ 一般在区间内部，但定理只保证在闭区间上
> 

> [!note]
> 
> ==应用举例==
> 
> **例1** 求函数 $f(x) = x^2$ 在区间 $[0, 2]$ 上满足积分中值定理的点 $c$
> 
> **解**：计算积分
> $$
> \int_0^2 x^2  dx = \left[ \frac{x^3}{3} \right]_0^2 = \frac{8}{3}
> $$
> 
> 根据积分中值定理：
> $$
> \frac{8}{3} = f(c)(2-0) = 2c^2
> $$
> 
> 解得：
> $$
> c^2 = \frac{4}{3}, \quad c = \frac{2}{\sqrt{3}} \approx 1.155
> $$
> 
> **例2** 证明：若 $f(x)$ 在 $[a,b]$ 上连续，且 $\int_a^b f(x)  dx = 0$，则存在 $c \in [a,b]$ 使得 $f(c) = 0$
> 
> **证明**：由积分中值定理，存在 $c \in [a,b]$，使得
> $$
> \int_a^b f(x)  dx = f(c)(b-a) = 0
> $$
> 
> 由于 $b-a \neq 0$，所以 $f(c) = 0$。
> 
> **例3** 估计积分 $\int_0^1 e^{-x^2}  dx$ 的值
> 
> **解**：函数 $f(x) = e^{-x^2}$ 在 $[0,1]$ 上连续，且
> $$
> e^{-1} \leq e^{-x^2} \leq 1
> $$
> 
> 由积分中值定理，存在 $c \in [0,1]$，使得
> $$
> \int_0^1 e^{-x^2}  dx = e^{-c^2}
> $$
> 
> 由于 $e^{-1} \leq e^{-c^2} \leq 1$，所以
> $$
> \frac{1}{e} \leq \int_0^1 e^{-x^2}  dx \leq 1
> $$
> 
> 这个估计虽然粗糙，但不需要具体计算积分值。

> [!important]
> 
> ==推广的积分中值定理==
>
> 设函数 $f(x)$ 和 $g(x)$ 在闭区间 $[a, b]$ 上连续，且 $g(x)$ 在 $[a, b]$ 上不变号，则存在一点 $c \in [a, b]$，使得
> $$
> \int_a^b f(x) g(x)  dx = f(c) \int_a^b g(x)  dx
> $$
> 
> **证明思路**：类似基本定理的证明，利用最值定理和介值定理。
> 
> **应用**：在加权平均、概率论和物理问题中有广泛应用。

> [!warning]
> 
> ==积分中值定理与微分中值定理的联系==
> 
> 积分中值定理和微分中值定理都描述了函数在区间上的"平均"行为：
> 
> | 定理 | 描述对象 | 结论形式 |
> |------|----------|----------|
> | 微分中值定理 | 导数 $f'(x)$ | $f'(c) = \frac{f(b)-f(a)}{b-a}$ |
> | 积分中值定理 | 函数 $f(x)$ | $f(c) = \frac{1}{b-a} \int_a^b f(x)  dx$ |
> 
> 它们共同构成了微积分基本理论的重要组成部分。
> 


> [!warning]
> 
> 积分中值定理是微积分中的基本定理之一：
> 
> - 它用简洁的形式表达了定积分与函数值的关系
> - 其证明体现了连续函数性质的典型应用
> - 在理论和实际问题中都有广泛用途
> - 与微分中值定理相辅相成，共同揭示了函数的整体与局部性质

### 运用中值定理证明洛必达法则

> [!important]
> 
> **洛必达法则**：
> 设函数 $f(x)$ 和 $g(x)$ 在点 $a$ 的某个去心邻域内可导，且满足：
> 1. $\lim\limits_{x \to a} f(x) = \lim\limits_{x \to a} g(x) = 0$（或 $\infty$）
> 2. $g'(x) \neq 0$ 在该邻域内
> 3. $\lim\limits_{x \to a} \dfrac{f'(x)}{g'(x)}$ 存在（或为 $\infty$）
> 
> 则：
> $$
> \lim_{x \to a} \frac{f(x)}{g(x)} = \lim_{x \to a} \frac{f'(x)}{g'(x)}
> $$

> **证明（0/0型情形）**：

> **第一步：函数延拓**
> 定义：
> $$
> F(x) = 
> \begin{cases}
> f(x) & x \neq a \\
> 0 & x = a
> \end{cases},
> \quad G(x) = 
> \begin{cases}
> g(x) & x \neq a \\
> 0 & x = a
> \end{cases}
> $$
> 
> 由于 $\lim\limits_{x \to a} f(x) = \lim\limits_{x \to a} g(x) = 0$，$F(x)$ 和 $G(x)$ 在 $x=a$ 处连续。
> 
> **第二步：应用柯西中值定理**
> 在包含 $a$ 和 $x$ 的区间上（$x \neq a$），$F(x)$ 和 $G(x)$ 满足柯西中值定理的条件：
> - 在闭区间上连续
> - 在开区间上可导
> - $G'(x) = g'(x) \neq 0$
> 
> 因此，存在 $\xi$ 介于 $a$ 和 $x$ 之间，使得：
> $$
> \frac{F(x) - F(a)}{G(x) - G(a)} = \frac{F'(\xi)}{G'(\xi)}
> $$
> 
> 由于 $F(a) = G(a) = 0$，上式化为：
> $$
> \frac{F(x)}{G(x)} = \frac{f'(\xi)}{g'(\xi)}
> $$
> 
> **第三步：取极限**
> 当 $x \to a$ 时，$\xi \to a$（因为 $\xi$ 介于 $a$ 和 $x$ 之间），所以：
> $$
> \lim_{x \to a} \frac{f(x)}{g(x)} = \lim_{x \to a} \frac{F(x)}{G(x)} = \lim_{\xi \to a} \frac{f'(\xi)}{g'(\xi)} = \lim_{x \to a} \frac{f'(x)}{g'(x)}
> $$
> 
> 这就完成了 0/0 型情形的证明。


## 泰勒展开

### 高阶无穷小

> [!tip]
> 
> 在深入研究泰勒展开之前，我们需要先理解**无穷小量**和**高阶无穷小**的概念，这些概念为我们提供了衡量函数在局部趋近于零时的"速度标尺"。


> [!important]
> 
> ==无穷小量的定义==
> 
> **无穷小量**是指在某个极限过程中趋近于零的量。更精确地说：
> 
> 设函数 $f(x)$ 在点 $x_0$ 的某个去心邻域内有定义。如果
> $$
> \lim_{x \to x_0} f(x) = 0
> $$
> 则称 $f(x)$ 为 $x \to x_0$ 时的无穷小量。
> 
> 类似地，可以定义 $x \to \infty$ 时的无穷小量。
> 
> **例子**：
> - 当 $x \to 0$ 时，$x$, $x^2$, $\sin x$ 都是无穷小量
> - 当 $x \to \infty$ 时，$\frac{1}{x}$, $\frac{1}{x^2}$ 都是无穷小量

> [!important]
> 
> ==无穷小量的比较==
> 
> 不同的无穷小量趋近于零的"速度"可能不同。为了比较这种差异，我们引入以下概念：
> 
> 设 $\alpha(x)$ 和 $\beta(x)$ 都是 $x \to x_0$ 时的无穷小量，且 $\beta(x) \neq 0$。
> 
> 1. **高阶无穷小**：如果 $\lim_{x \to x_0} \frac{\alpha(x)}{\beta(x)} = 0$，则称 $\alpha(x)$ 是 $\beta(x)$ 的高阶无穷小，记作 $\alpha(x) = o(\beta(x))$。
> 
> 2. **等价无穷小**：如果 $\lim_{x \to x_0} \frac{\alpha(x)}{\beta(x)} = 1$，则称 $\alpha(x)$ 与 $\beta(x)$ 是等价无穷小，记作 $\alpha(x) \sim \beta(x)$。
> 
> 3. **同阶无穷小**：如果 $\lim_{x \to x_0} \frac{\alpha(x)}{\beta(x)} = c \neq 0$（$c$ 为常数），则称 $\alpha(x)$ 与 $\beta(x)$ 是同阶无穷小。

> [!note]
> 
> - 当 $x \to 0$ 时，$x^2 = o(x)$，因为 $\lim_{x \to 0} \frac{x^2}{x} = 0$
> - 当 $x \to 0$ 时，$\sin x \sim x$，因为 $\lim_{x \to 0} \frac{\sin x}{x} = 1$
> - 当 $x \to 0$ 时，$1 - \cos x \sim \frac{1}{2}x^2$，因为 $\lim_{x \to 0} \frac{1 - \cos x}{\frac{1}{2}x^2} = 1$

> [!warning]
> 
> ==无穷大量==
> 
> 与无穷小量相对的是**无穷大量**：
> 
> 设函数 $f(x)$ 在点 $x_0$ 的某个去心邻域内有定义。如果对于任意正数 $M$，总存在 $\delta > 0$，使得当 $0 < |x - x_0| < \delta$ 时，有 $|f(x)| > M$，则称 $f(x)$ 为 $x \to x_0$ 时的无穷大量。
> 
> 类似地，可以定义 $x \to \infty$ 时的无穷大量。
> 
> **例子**：
> - 当 $x \to 0$ 时，$\frac{1}{x}$ 是无穷大量
> - 当 $x \to \infty$ 时，$x$, $x^2$ 都是无穷大量

> [!important]
> 
> ==标准无穷小量==
> 
> 幂函数 $x^n$ 在 $x \to 0$ 时构成了一套自然的"标尺"，用于衡量其他无穷小量的阶数：
> 
> - $x$ 是一阶无穷小
> - $x^2$ 是二阶无穷小
> - $x^3$ 是三阶无穷小
> - 一般地，$x^n$ 是 $n$ 阶无穷小
> 
> 当我们说 $f(x) = o(x^n)$ 时，意味着 $f(x)$ 趋近于零的速度比 $x^n$ 更快。
> 
> 这套标尺的重要性在于：**任何足够光滑的函数在零点附近都可以用这些标准无穷小量的线性组合来近似表示**——这正是泰勒展开的核心思想。
> 
> **例子**：
> - $e^x - 1 \sim x$（一阶近似）
> - $e^x - 1 - x \sim \frac{1}{2}x^2$（二阶近似）
> - $\sin x - x \sim -\frac{1}{6}x^3$（三阶近似）
> 
> 在下一节中，我们将看到如何系统性地构造这种近似，即泰勒展开。

### 泰勒展开的概念

> ![tip]
>  
> ==泰勒展开的核心概念==
> 
> 任何足够光滑的函数在零点附近都可以用标准无穷小量 $x^n$ 的线性组合来近似表示。

> [!note]
> 
> **例1：指数函数 $e^x$ 在 $x=0$ 附近**
> 
> 我们知道：
> - $e^0 = 1$
> - 在 $x=0$ 附近，$e^x \approx 1 + x$（一阶近似）
> - 更好的近似：$e^x \approx 1 + x + \frac{x^2}{2}$（二阶近似）
> - 更更好的近似：$e^x \approx 1 + x + \frac{x^2}{2} + \frac{x^3}{6}$（三阶近似）
> 
> 这个模式可以继续下去，每一项都是 $x^n$ 的倍数。
> 
> **例2：正弦函数 $\sin x$ 在 $x=0$ 附近**
> 
> 我们知道：
> - $\sin 0 = 0$
> - 在 $x=0$ 附近，$\sin x \approx x$（一阶近似）
> - 更好的近似：$\sin x \approx x - \frac{x^3}{6}$（三阶近似）
> - 更更好的近似：$\sin x \approx x - \frac{x^3}{6} + \frac{x^5}{120}$（五阶近似）
> 
> 注意到这里只出现奇数次项，这与正弦函数的奇函数性质相符。


> [!note]
> 
> ==数值实验证据==
> 
> 让我们通过数值计算来验证这些近似的有效性（取 $x=0.1$）：
> 
> | 函数 | 精确值 | 一阶近似 | 二阶近似 | 三阶近似 |
> |------|--------|----------|----------|----------|
> | $e^{0.1}$ | 1.105170918 | 1.1 | 1.105 | 1.105166667 |
> | $\sin(0.1)$ | 0.099833417 | 0.1 | - | 0.099833333 |
> 
> 可以看到：
> - 随着近似阶数的增加，精度显著提高
> - 三阶近似已经非常接近真实值
> - 不同的函数需要不同阶数的近似来达到相同的精度


> [!important]
> 
> ==确定泰勒展开的系数==
> 
> 假设我们希望用多项式来近似函数 $f(x)$：
> $$
> f(x) \approx a_0 + a_1x + a_2x^2 + a_3x^3 + \cdots + a_nx^n
> $$
> 
> 如何确定系数 $a_0, a_1, a_2, \ldots, a_n$？
> 
> **思路**：让近似多项式在 $x=0$ 处与函数 $f(x)$ 有尽可能多的"一致性"。
> 
> **推导过程**：
> 
> 1. **零阶一致性**：在 $x=0$ 处，函数值与近似值相等
>    $$
>    f(0) = a_0 \quad \Rightarrow \quad a_0 = f(0)
>    $$
> 
> 2. **一阶一致性**：在 $x=0$ 处，一阶导数相等
>    $$
>    f'(0) = a_1 \quad \Rightarrow \quad a_1 = f'(0)
>    $$
> 
> 3. **二阶一致性**：在 $x=0$ 处，二阶导数相等
>    $$
>    f''(0) = 2a_2 \quad \Rightarrow \quad a_2 = \frac{f''(0)}{2}
>    $$
> 
> 4. **n阶一致性**：在 $x=0$ 处，n阶导数相等
>    $$
>    f^{(n)}(0) = n! \cdot a_n \quad \Rightarrow \quad a_n = \frac{f^{(n)}(0)}{n!}
>    $$
> 
> 因此，我们得到了泰勒展开的系数公式：
> $$
> a_n = \frac{f^{(n)}(0)}{n!}
> $$
> 
> 完整的泰勒公式（在 $x=0$ 处，也称为麦克劳林公式）为：
> $$
> f(x) = f(0) + f'(0)x + \frac{f''(0)}{2!}x^2 + \frac{f'''(0)}{3!}x^3 + \cdots + \frac{f^{(n)}(0)}{n!}x^n + R_n(x)
> $$
> 
> 其中 $R_n(x)$ 是余项，表示近似误差。
> 
> **例子验证**：对于 $f(x) = e^x$
> - $f(0) = 1$ ⇒ $a_0 = 1$
> - $f'(0) = 1$ ⇒ $a_1 = 1$
> - $f''(0) = 1$ ⇒ $a_2 = \frac{1}{2}$
> - $f'''(0) = 1$ ⇒ $a_3 = \frac{1}{6}$
> 
> 这与我们之前的观察完全一致！
> 
> 这个美妙的公式告诉我们：**函数在一点附近的行为完全由它在该点的各阶导数决定**。这是微分学最深刻的结论之一。


### 泰勒展开的余项估计

> [!tip]
>
> 本节我们将估计泰勒展开的余项 $R_n(x)$ 的大小. 为什么余项的大小很重要? 这是因为泰勒展开的核心价值在于用多项式来近似复杂函数，但作为近似我们自然关心一个关键问题：这种近似的误差有多大？是否可控？
> 
> 答案是肯定的！本节的余项分析告诉我们：
> 
> - 对于充分光滑的函数，泰勒近似的误差确实是可以控制的
> 
> - 误差随着展开阶数 $n$ 的增加而减小
> 
> - 在展开点附近，误差比展开式的最后一项更快地趋近于零
> 
> 这种可控性使得泰勒展开在数值计算、物理建模、工程优化等领域有着广泛的应用。
> 

> [!important]
> 
> ==皮亚诺余项==
> 
> 设函数 $f(x)$ 在 $x=0$ 处有 $n$ 阶导数，则存在邻域 $U(0)$，使得对于任意 $x \in U(0)$，有
> $$
> f(x) = f(0) + f'(0)x + \frac{f''(0)}{2!}x^2 + \cdots + \frac{f^{(n)}(0)}{n!}x^n + o(x^n)
> $$
> 其中 $o(x^n)$ 表示当 $x \to 0$ 时，余项是 $x^n$ 的高阶无穷小。
> 
> **证明**
> 
> 我们需要证明：$\lim_{x \to 0} \frac{R_n(x)}{x^n} = 0$，其中 $R_n(x) = f(x) - P_n(x)$，$P_n(x)$ 是 $n$ 次泰勒多项式。
> 
> **方法一：使用柯西中值定理**
> 
> 考虑函数 $\phi(t) = f(t) - P_n(t)$ 和 $\psi(t) = t^{n+1}$
> 
> 在区间 $[0,x]$ 上应用柯西中值定理：
> $$
> \frac{\phi(x) - \phi(0)}{\psi(x) - \psi(0)} = \frac{\phi'(\xi)}{\psi'(\xi)} \quad \text{对某个 } \xi \in (0,x)
> $$
> 
> 由于 $\phi(0) = 0$，$\psi(0) = 0$，我们有：
> $$
> \frac{R_n(x)}{x^{n+1}} = \frac{\phi'(\xi)}{(n+1)\xi^n}
> $$
> 
> 但 $\phi'(t) = f'(t) - P_n'(t)$，而 $P_n'(t)$ 是 $f'(t)$ 的 $(n-1)$ 阶泰勒多项式
> 
> 由归纳假设，$\lim_{t \to 0} \frac{\phi'(t)}{t^n} = 0$
> 
> 因此：
> $$
> \lim_{x \to 0} \frac{R_n(x)}{x^{n+1}} = \lim_{\xi \to 0} \frac{\phi'(\xi)}{(n+1)\xi^n} = 0
> $$
> 
> 这就证明了 $R_n(x) = o(x^n)$。
> 
> **方法二：使用洛必达法则**
> 
> 考虑极限 $\lim_{x \to 0} \frac{R_n(x)}{x^n}$
> 
> 注意到：
> - $R_n(0) = 0$
> - $R_n'(0) = 0$
> - ...
> - $R_n^{(n-1)}(0) = 0$
> 
> 这是因为泰勒多项式 $P_n(x)$ 的前 $n$ 阶导数在 $x=0$ 处与 $f(x)$ 完全相同。
> 
> 应用洛必达法则 $n$ 次：
> $$
> \lim_{x \to 0} \frac{R_n(x)}{x^n} = \lim_{x \to 0} \frac{R_n'(x)}{nx^{n-1}} = \cdots = \lim_{x \to 0} \frac{R_n^{(n-1)}(x)}{n!x}
> $$
> 
> 现在考虑最后一个极限：
> $$
> \lim_{x \to 0} \frac{R_n^{(n-1)}(x)}{n!x} = \frac{1}{n!} \lim_{x \to 0} \frac{R_n^{(n-1)}(x) - R_n^{(n-1)}(0)}{x}
> $$
> 
> 根据导数的定义，这个极限等于 $\frac{1}{n!} R_n^{(n)}(0)$
> 
> 但 $R_n^{(n)}(0) = f^{(n)}(0) - P_n^{(n)}(0) = f^{(n)}(0) - n! \cdot \frac{f^{(n)}(0)}{n!} = 0$
> 
> 因此：
> $$
> \lim_{x \to 0} \frac{R_n(x)}{x^n} = 0
> $$
> 
> 这就证明了 $R_n(x) = o(x^n)$。
>

> [!warning]
> 
> ==两种证明方法的比较==
> 
> - **柯西中值定理方法**：更加几何化，通过构造辅助函数和区间分析来证明
> - **洛必达法则方法**：更加代数化，直接通过极限运算和导数定义来证明

> [!warning]
> 
> ==余项的直观理解==
> 
> 余项 $o(x^n)$ 的含义是：
> - 当 $x$ 很小时，泰勒多项式的误差比 $x^n$ 更快地趋近于零
> - 展开的阶数 $n$ 越高，近似精度越高
> - 对于固定的 $n$，当 $x \to 0$ 时，误差趋近于零的速度由 $x^n$ 决定
> 
> **例子**：比较 $e^x$ 的不同阶泰勒近似的误差
> 
> | $x$ | 精确值 | 一阶近似误差 | 二阶近似误差 | 三阶近似误差 |
> |-----|--------|--------------|--------------|--------------|
> | 0.1 | 1.10517 | 0.00517 | 0.00017 | 0.000004 |
> | 0.01 | 1.01005 | 0.00005 | 1.67×10⁻⁷ | 4.17×10⁻¹⁰ |
> 
> 可以看到：
> - 误差确实随着 $x$ 减小而快速减小
> - 高阶近似的误差减小得更快
> - 当 $x=0.01$ 时，三阶近似的误差已经可以忽略不计

> [!warning]
> 
> ==皮亚诺余项的意义==
> 
> 皮亚诺余项 $o(x^n)$ 给出了泰勒近似的**渐近性质**：
> - 它告诉我们当 $x \to 0$ 时误差的行为
> - 但它不提供具体的误差界
> - 对于固定的 $x$，我们不知道误差到底有多大
>
> 皮亚诺余项确认了我们的直观：用多项式逼近光滑函数是可行的，且逼近误差在原点附近是可以控制的. 在实际应用中，我们有时需要更精确的误差估计，这时可以使用下面将要介绍的**拉格朗日余项**或**柯西余项**。
> 

> [!tip]
> 
> 皮亚诺余项 $o(x^n)$ 告诉我们余项是 $x^n$ 的高阶无穷小，但它没有给出具体的误差估计。在实际应用中，我们经常需要知道误差的具体范围，这时就需要使用**拉格朗日余项**。
>

> [!important]
> 
> ==拉格朗日余项==
> 
> 设函数 $f(x)$ 在包含 $0$ 和 $x$ 的区间上具有 $n+1$ 阶连续导数，则存在 $\xi$ 介于 $0$ 和 $x$ 之间，使得
> $$
> f(x) = f(0) + f'(0)x + \frac{f''(0)}{2!}x^2 + \cdots + \frac{f^{(n)}(0)}{n!}x^n + \frac{f^{(n+1)}(\xi)}{(n+1)!}x^{n+1}
> $$
> 
> 其中 $\frac{f^{(n+1)}(\xi)}{(n+1)!}x^{n+1}$ 称为**拉格朗日余项**。
> 
> **证明思路**：
> 
> 考虑辅助函数：
> $$
> F(t) = f(x) - \left[ f(t) + f'(t)(x-t) + \frac{f''(t)}{2!}(x-t)^2 + \cdots + \frac{f^{(n)}(t)}{n!}(x-t)^n \right]
> $$
> 
> 和
> $$
> G(t) = (x-t)^{n+1}
> $$
> 
> 在区间 $[0,x]$（或 $[x,0]$）上应用柯西中值定理：
> $$
> \frac{F(x) - F(0)}{G(x) - G(0)} = \frac{F'(\xi)}{G'(\xi)} \quad \text{对某个 } \xi \in (0,x)
> $$
> 
> 经过计算可得：
> $$
> F'(\xi) = -\frac{f^{(n+1)}(\xi)}{n!}(x-\xi)^n, \quad G'(\xi) = -(n+1)(x-\xi)^n
> $$
> 
> 代入并整理即得拉格朗日余项公式。
>

> [!warning]
> 
> ==拉格朗日余项的意义==
> 
> 1. **具体误差界**：拉格朗日余项给出了误差的具体表达式
> 2. **可计算性**：如果知道 $f^{(n+1)}$ 的界，就可以计算误差的范围
> 3. **实用性**：在数值计算和工程应用中非常有用

> [!note]
> 
> **例子**：估计 $e^{0.1}$ 的三阶泰勒近似的误差
> 
> $e^x$ 的四阶导数为 $e^x$，在 $[0,0.1]$ 上，$|e^x| \leq e^{0.1} < 1.11$
> 
> 因此误差：
> $$
> |R_3(0.1)| \leq \frac{1.11}{4!}(0.1)^4 \approx 4.625 \times 10^{-6}
> $$
> 
> 这与我们之前观察到的实际误差 $4 \times 10^{-6}$ 吻合。


> [!important]
>
> ==柯西余项==
> 
> **泰勒定理（带柯西余项）**：
> 设函数 $f(x)$ 在包含 $0$ 和 $x$ 的区间上具有 $n+1$ 阶连续导数，则存在 $\theta \in (0,1)$，使得
> $$
> f(x) = f(0) + f'(0)x + \frac{f''(0)}{2!}x^2 + \cdots + \frac{f^{(n)}(0)}{n!}x^n + \frac{f^{(n+1)}(\theta x)}{n!}(1-\theta)^n x^{n+1}
> $$
> 
> 其中 $\frac{f^{(n+1)}(\theta x)}{n!}(1-\theta)^n x^{n+1}$ 称为**柯西余项**。
> 
> **证明思路**：
> 
> 使用与拉格朗日余项类似的证明方法，但选择不同的辅助函数 $G(t)$。
> 
> **柯西余项的特点**：
> 
> 1. **形式不同**：柯西余项与拉格朗日余项的表达式不同
> 2. **适用范围**：在某些情况下，柯西余项能给出更精确的误差估计
> 3. **理论价值**：在分析泰勒级数的收敛性时很有用

> [!important]
> 
> ==积分余项==
>
> 设函数 $f(x)$ 在包含 $0$ 和 $x$ 的区间上具有 $n+1$ 阶连续导数，则
> $$
> f(x) = f(0) + f'(0)x + \frac{f''(0)}{2!}x^2 + \cdots + \frac{f^{(n)}(0)}{n!}x^n + R_n(x)
> $$
> 其中积分余项为：
> $$
> R_n(x) = \frac{1}{n!} \int_0^x (x-t)^n f^{(n+1)}(t)  dt
> $$
>
> 
> **推导过程**：
> 
> 1. 从微积分基本定理出发：
>    $$
>    f(x) = f(0) + \int_0^x f'(t)  dt
>    $$
> 
> 2. 对积分 $\int_0^x f'(t)  dt$ 进行分部积分，令 $u = f'(t)$, $dv = dt$：
>    $$
>    \int_0^x f'(t)  dt = \left[ f'(t) \cdot t \right]_0^x - \int_0^x t f''(t)  dt = x f'(0) + \int_0^x (x-t) f''(t)  dt
>    $$
> 
> 3. 重复此过程，每次分部积分都会产生一个新的泰勒项和余下的积分：
>    $$
>    f(x) = f(0) + x f'(0) + \frac{x^2}{2!} f''(0) + \cdots + \frac{x^n}{n!} f^{(n)}(0) + \frac{1}{n!} \int_0^x (x-t)^n f^{(n+1)}(t)  dt
>    $$
> 
> 这样就得到了积分余项公式。

> [!warning]
> 
> ==积分余项的优势==
> 
> 与其他余项形式相比，积分余项具有独特优势：
> 
> 1. **精确表达式**：积分余项给出了余项的精确表达式，而非存在性结果
> 
> 2. **适用范围广**：可用于推导各种数值方法的误差估计
> 
> 3. **理论价值**：在泛函分析和偏微分方程中有重要应用
> 
> 4. **灵活性**：可以通过不同的积分估计技术得到不同的误差界

> [!warning]
> 
> ==积分余项的局限性==
> 
> 1. **计算复杂**：实际计算积分可能很困难
> 
> 2. **条件较强**：要求 $f^{(n+1)}$ 连续，而皮亚诺余项只需 $n$ 阶导数存在
> 
> 3. **实用性有限**：在实际数值计算中，拉格朗日余项通常更便于使用

> [!warning]
> 
> ==各种余项形式的比较总结==
>
> | 余项类型 | 表达式 | 条件 | 主要应用 |
> |----------|--------|------|----------|
> | 皮亚诺余项 | $o(x^n)$ | $f$ 在 $x_0$ 处 $n$ 阶可导 | 极限计算，渐近分析 |
> | 拉格朗日余项 | $\frac{f^{(n+1)}(\xi)}{(n+1)!}x^{n+1}$ | $f^{(n+1)}$ 在区间上存在 | 误差估计，不等式证明 |
> | 柯西余项 | $\frac{f^{(n+1)}(\theta x)}{n!}(1-\theta)^n x^{n+1}$ | $f^{(n+1)}$ 在区间上存在 | 特殊情形的误差分析 |
> | 积分余项 | $\frac{1}{n!}\int_0^x (x-t)^n f^{(n+1)}(t) dt$ | $f^{(n+1)}$ 连续 | 理论分析，数值方法推导 |


> [!warning]
> 
> ==积分余项与其他余项的关系==
> 
> 积分余项可以推导出拉格朗日余项和柯西余项：
> 
> **推导拉格朗日余项**：
> 
> 由积分中值定理，存在 $\xi \in (0,x)$ 使得：
> $$
> \int_0^x (x-t)^n f^{(n+1)}(t)  dt = f^{(n+1)}(\xi) \int_0^x (x-t)^n  dt = f^{(n+1)}(\xi) \frac{x^{n+1}}{n+1}
> $$
> 
> 代入积分余项得：
> $$
> R_n(x) = \frac{f^{(n+1)}(\xi)}{(n+1)!} x^{n+1}
> $$
> 
> 这正是拉格朗日余项。
> 
> **推导柯西余项**：
> 
> 令 $t = \theta x$，则 $dt = x d\theta$，积分变为：
> $$
> \int_0^x (x-t)^n f^{(n+1)}(t)  dt = x^{n+1} \int_0^1 (1-\theta)^n f^{(n+1)}(\theta x)  d\theta
> $$
> 
> 由积分中值定理，存在 $\theta_0 \in (0,1)$ 使得：
> $$
> \int_0^1 (1-\theta)^n f^{(n+1)}(\theta x)  d\theta = f^{(n+1)}(\theta_0 x) \int_0^1 (1-\theta)^n  d\theta = \frac{f^{(n+1)}(\theta_0 x)}{n+1}
> $$
> 
> 因此：
> $$
> R_n(x) = \frac{f^{(n+1)}(\theta_0 x)}{n!} \cdot \frac{x^{n+1}}{n+1}
> $$
> 
> 这与柯西余项形式略有不同，但本质相同。


> [!note]
> 
> ==应用实例：计算 $\pi$ 的近似值==
> 
> 利用 $\arctan x$ 的泰勒展开：
> $$
> \arctan x = x - \frac{x^3}{3} + \frac{x^5}{5} - \frac{x^7}{7} + \cdots
> $$
> 
> 取 $x = 1$，得：
> $$
> \frac{\pi}{4} = 1 - \frac{1}{3} + \frac{1}{5} - \frac{1}{7} + \cdots
> $$
> 
> 使用拉格朗日余项可以估计需要多少项才能达到指定的精度。
> 
> 例如，要计算 $\pi$ 到小数点后 6 位，需要：
> $$
> |R_n(1)| \leq \frac{1}{2n+1} < 10^{-6}
> $$
> 
> 解得 $n > 5 \times 10^5$，即需要约 50 万项！这说明虽然泰勒展开理论上是精确的，但实际计算时收敛速度可能很慢。
> 

### 常见函数的泰勒展开

> [!tip]
> 
> 掌握常见函数的泰勒展开式是应用泰勒展开的基础。这些展开式在数学分析、物理学、工程计算等领域有着广泛的应用。

> [!note]
> 
> ==指数函数 $e^x$==
> 
> **泰勒展开式**：
> $$
> e^x = 1 + x + \frac{x^2}{2!} + \frac{x^3}{3!} + \frac{x^4}{4!} + \cdots = \sum_{n=0}^{\infty} \frac{x^n}{n!}
> $$
> 
> **收敛性**：对所有实数 $x$ 都收敛
> 
> **推导**：
> - $f(x) = e^x$，$f^{(n)}(x) = e^x$，$f^{(n)}(0) = 1$
> - 代入泰勒公式：$a_n = \frac{f^{(n)}(0)}{n!} = \frac{1}{n!}$
> 
> **应用**：计算 $e$ 的近似值
> $$
> e = e^1 \approx 1 + 1 + \frac{1}{2} + \frac{1}{6} + \frac{1}{24} + \frac{1}{120} \approx 2.71667
> $$

> [!note]
> 
> ==正弦函数 $\sin x$==
> 
> **泰勒展开式**：
> $$
> \sin x = x - \frac{x^3}{3!} + \frac{x^5}{5!} - \frac{x^7}{7!} + \cdots = \sum_{n=0}^{\infty} \frac{(-1)^n x^{2n+1}}{(2n+1)!}
> $$
> 
> **收敛性**：对所有实数 $x$ 都收敛
> 
> **推导**：
> - $\sin^{(n)}(x) = \sin\left(x + \frac{n\pi}{2}\right)$
> - $\sin^{(n)}(0)$ 的值为：0, 1, 0, -1, 0, 1, ...（循环）
> - 只有奇数次项非零，且符号交替
> 
> **特点**：只包含奇数次项，这与 $\sin x$ 是奇函数相符

> [!note]
> 
> ==余弦函数 $\cos x$==
> 
> **泰勒展开式**：
> $$
> \cos x = 1 - \frac{x^2}{2!} + \frac{x^4}{4!} - \frac{x^6}{6!} + \cdots = \sum_{n=0}^{\infty} \frac{(-1)^n x^{2n}}{(2n)!}
> $$
> 
> **收敛性**：对所有实数 $x$ 都收敛
> 
> **推导**：
> - $\cos^{(n)}(x) = \cos\left(x + \frac{n\pi}{2}\right)$
> - $\cos^{(n)}(0)$ 的值为：1, 0, -1, 0, 1, 0, ...（循环）
> - 只有偶数次项非零，且符号交替
> 
> **特点**：只包含偶数次项，这与 $\cos x$ 是偶函数相符


> [!note]
> 
> ==自然对数 $\ln(1+x)$==
> 
> **泰勒展开式**：
> $$
> \ln(1+x) = x - \frac{x^2}{2} + \frac{x^3}{3} - \frac{x^4}{4} + \cdots = \sum_{n=1}^{\infty} \frac{(-1)^{n+1} x^n}{n}
> $$
> 
> **收敛区间**：$-1 < x \leq 1$
> 
> **推导**：
> - $f(x) = \ln(1+x)$，$f'(x) = \frac{1}{1+x} = \sum_{n=0}^{\infty} (-1)^n x^n$（几何级数）
> - 逐项积分得到 $\ln(1+x)$ 的展开式
> 
> **注意**：当 $x=1$ 时，得到著名的交错调和级数
> $$
> \ln 2 = 1 - \frac{1}{2} + \frac{1}{3} - \frac{1}{4} + \cdots
> $$

> [!note]
> 
> ==二项式展开 $(1+x)^\alpha$==
> 
> **泰勒展开式**（广义二项式定理）：
> $$
> (1+x)^\alpha = 1 + \alpha x + \frac{\alpha(\alpha-1)}{2!}x^2 + \frac{\alpha(\alpha-1)(\alpha-2)}{3!}x^3 + \cdots
> $$
> 
> **收敛区间**：
> - 当 $\alpha$ 是非负整数时：对所有 $x$ 成立（有限项）
> - 当 $\alpha$ 不是非负整数时：$|x| < 1$
> 
> **特殊情况**：
> - $\alpha = -1$：$\frac{1}{1+x} = 1 - x + x^2 - x^3 + \cdots$
> - $\alpha = \frac{1}{2}$：$\sqrt{1+x} = 1 + \frac{1}{2}x - \frac{1}{8}x^2 + \frac{1}{16}x^3 - \cdots$
> - $\alpha = -\frac{1}{2}$：$\frac{1}{\sqrt{1+x}} = 1 - \frac{1}{2}x + \frac{3}{8}x^2 - \frac{5}{16}x^3 + \cdots$

> [!warning]
> 
> ==收敛性总结表==
> 
> | 函数 | 展开式 | 收敛区间 |
> |------|--------|----------|
> | $e^x$ | $\sum \frac{x^n}{n!}$ | $(-\infty, \infty)$ |
> | $\sin x$ | $\sum \frac{(-1)^n x^{2n+1}}{(2n+1)!}$ | $(-\infty, \infty)$ |
> | $\cos x$ | $\sum \frac{(-1)^n x^{2n}}{(2n)!}$ | $(-\infty, \infty)$ |
> | $\ln(1+x)$ | $\sum \frac{(-1)^{n+1} x^n}{n}$ | $(-1, 1]$ |
> | $(1+x)^\alpha$ | $\sum \binom{\alpha}{n} x^n$ | 见上文说明 |
> 
> 掌握这些常见函数的泰勒展开式，能够帮助我们解决各种极限计算、近似计算和级数求和问题。在实际应用中，我们可以根据精度要求截取适当的前几项进行计算。

### 泰勒展开的应用

> [!tip]
> 
> 泰勒公式不仅是理论分析的有力工具，在实际问题中也有着广泛的应用。本节将通过具体例子展示泰勒公式在极限计算、近似计算、不等式证明和微分方程求解等方面的应用。

> [!important]
> 
> ==极限计算==
> 
> 泰勒展开为计算复杂极限提供了系统的方法，特别是当洛必达法则变得繁琐时。

> [!note]
> 
> **例1** 计算 $\lim_{x \to 0} \frac{e^x - 1 - x}{x^2}$
> 
> **解**：将 $e^x$ 展开到二阶：
> $$
> e^x = 1 + x + \frac{x^2}{2} + o(x^2)
> $$
> 
> 代入得：
> $$
> \frac{e^x - 1 - x}{x^2} = \frac{(1 + x + \frac{x^2}{2} + o(x^2)) - 1 - x}{x^2} = \frac{\frac{x^2}{2} + o(x^2)}{x^2} = \frac{1}{2} + o(1)
> $$
> 
> 因此：
> $$
> \lim_{x \to 0} \frac{e^x - 1 - x}{x^2} = \frac{1}{2}
> $$
>

> [!note]
> 
> **例2** 计算 $\lim_{x \to 0} \frac{\sin x - x}{x^3}$
> 
> **解**：将 $\sin x$ 展开到三阶：
> $$
> \sin x = x - \frac{x^3}{6} + o(x^3)
> $$
> 
> 代入得：
> $$
> \frac{\sin x - x}{x^3} = \frac{(x - \frac{x^3}{6} + o(x^3)) - x}{x^3} = -\frac{1}{6} + o(1)
> $$
> 
> 因此：
> $$
> \lim_{x \ to 0} \frac{\sin x - x}{x^3} = -\frac{1}{6}
> $$

> [!important]
> 
> ==近似计算==
> 
> 泰勒展开为函数值的近似计算提供了系统方法，特别在数值分析和工程计算中应用广泛。

> [!note]
> 
> **例3** 计算 $\sin 1^\circ$ 的近似值
> 
> **解**：先将角度转换为弧度：$1^\circ = \frac{\pi}{180} \approx 0.0174533$
> 
> 使用 $\sin x$ 的展开：
> $$
> \sin x = x - \frac{x^3}{6} + \frac{x^5}{120} - \cdots
> $$
> 
> 代入 $x = 0.0174533$：
> $$
> \sin 1^\circ \approx 0.0174533 - \frac{(0.0174533)^3}{6} \approx 0.0174524
> $$
> 
> 与精确值 $0.0174524064$ 相比，误差约为 $10^{-8}$。

> [!important]
> 
> ==不等式证明==
> 
> 泰勒展开为证明函数不等式提供了有效方法。

> [!note]
> 
> **例5** 证明：当 $x > 0$ 时，$e^x > 1 + x + \frac{x^2}{2}$
> 
> **证明**：将 $e^x$ 展开到三阶：
> $$
> e^x = 1 + x + \frac{x^2}{2} + \frac{e^\xi}{6}x^3 \quad (\xi \in (0,x))
> $$
> 
> 由于 $e^\xi > 0$，所以：
> $$
> e^x = 1 + x + \frac{x^2}{2} + \frac{e^\xi}{6}x^3 > 1 + x + \frac{x^2}{2}
> $$
> 
> 证毕。

> [!note]
> 
> **例6** 证明：当 $0 < x < \frac{\pi}{2}$ 时，$\sin x > x - \frac{x^3}{6}$
> 
> **证明**：将 $\sin x$ 展开到五阶：
> $$
> \sin x = x - \frac{x^3}{6} + \frac{\cos \xi}{120}x^5 \quad (\xi \in (0,x))
> $$
> 
> 当 $0 < x < \frac{\pi}{2}$ 时，$\cos \xi > 0$，所以：
> $$
> \sin x = x - \frac{x^3}{6} + \frac{\cos \xi}{120}x^5 > x - \frac{x^3}{6}
> $$
> 
> 证毕。

### 大O符号

> [!tip]
> 
> 在前面的讨论中，我们介绍了皮亚诺余项 $o(x^n)$ 和拉格朗日余项。现在我们将引入**大O符号**，它提供了另一种描述余项行为的方式，在数值分析和算法分析中特别有用。

> [!important]
>
> ==大O符号的定义==
>
> 设函数 $f(x)$ 和 $g(x)$ 在 $x_0$ 的某个去心邻域内有定义。如果存在常数 $M > 0$ 和 $\delta > 0$，使得当 $0 < |x - x_0| < \delta$ 时，有
> $$
> |f(x)| \leq M|g(x)|
> $$
> 则称 $f(x)$ 是 $g(x)$ 的大O，记作 $f(x) = O(g(x))$（当 $x \to x_0$）。
>
> **直观理解**：$f(x) = O(g(x))$ 表示 $f(x)$ 的**增长速率不超过** $g(x)$ 的常数倍。
>
> ### 大O符号与皮亚诺余项的比较
>
> | 符号 | 定义 | 含义 | 强弱关系 |
> |------|------|------|----------|
> | $f(x) = o(g(x))$ | $\lim_{x \to x_0} \frac{f(x)}{g(x)} = 0$ | $f(x)$ 是 $g(x)$ 的高阶无穷小 | 更强 |
> | $f(x) = O(g(x))$ | $\exists M > 0, |\frac{f(x)}{g(x)}| \leq M$ | $f(x)$ 不超过 $g(x)$ 的常数倍 | 更弱 |
>
> **关键区别**：
>
> - $o(x^n)$ 保证余项比 $x^n$ **更快地**趋近于零
> - $O(x^{n+1})$ 保证余项最多是 $x^{n+1}$ 的**常数倍**

> [!note]
> 
> ==泰勒展开中的大O符号==
> 
> 设函数 $f(x)$ 在 $x=0$ 处有 $n+1$ 阶连续导数，则
> $$
> f(x) = f(0) + f'(0)x + \frac{f''(0)}{2!}x^2 + \cdots + \frac{f^{(n)}(0)}{n!}x^n + O(x^{n+1})
> $$
> 
> **证明思路**：
> 由拉格朗日余项公式：
> $$
> R_n(x) = \frac{f^{(n+1)}(\xi)}{(n+1)!}x^{n+1}
> $$
> 
> 由于 $f^{(n+1)}(x)$ 在 $x=0$ 附近连续，故有界，即存在 $M > 0$ 使得 $|f^{(n+1)}(x)| \leq M$，因此
> $$
> |R_n(x)| \leq \frac{M}{(n+1)!}|x|^{n+1}
> $$
> 
> 即 $R_n(x) = O(x^{n+1})$。
>

> [!note]
> 
> ==函数展开的比较==
> 
> **例1** 比较 $e^x$ 和 $\cos x$ 的展开式
> 
> - $e^x = 1 + x + \frac{x^2}{2} + O(x^3)$
> - $\cos x = 1 - \frac{x^2}{2} + O(x^4)$
> 
> 这表明：
> - $e^x$ 的三阶误差是 $O(x^3)$
> - $\cos x$ 的三阶误差是 $O(x^4)$，实际上更小

> [!warning]
> 
> ==大O符号在数值分析中的重要性==
> 
> 大O符号在数值分析和算法分析中极为重要：
> 
> 1. **算法复杂度分析**：描述算法时间或空间需求随输入规模增长的速度
> 
> 2. **数值方法误差分析**：描述数值方法的截断误差
> 
> 3. **渐近分析**：研究函数在无穷远处或奇点附近的行为
> 
> **例5** 数值积分的误差分析
> 
> 梯形公式的误差为 $O(h^2)$，辛普森公式的误差为 $O(h^4)$，这表明辛普森公式收敛更快。

---
title: 高等数学讲义
author: 胡煜成
description: 首都师范大学高等数学A
"og:description": 浏览器版和手机版
"og:image": https://vlook-doc.pages.dev/pic/vlook-og.png
keywords:
- 高等数学,微积分,讲义
vlook-chp-autonum: h1=off
vlook-query: vdl=on
vlook-query: ws=off
---

[toc]

# 积分的应用

## 几何应用: 求体积与弧长

### 微元法思想

> [!tip]
>  
> 微元法是积分学中解决几何与物理问题的核心思想，它将复杂的整体问题分解为无穷多个简单的局部问题。
> 
> **基本思路**：
> 
> 1. **分割**：将所求的整体量对应的区域分割成许多微小部分
> 2. **近似**：在每个微小部分上，用简单的几何量近似代替复杂的实际量
> 3. **求和取极限**：将所有微小部分的近似值相加，然后通过取极限得到精确值
>

> [!important]
>  
> ==微元法数学表述==
> 
> 如果要求整体量 $Q$，先找出微元 $dQ = f(x)dx$，然后通过积分得到
> $$
> Q = \int_a^b dQ = \int_a^b f(x)dx
> $$

> [!note]
>  
> **例子**：计算曲线 $y = f(x)$ 在 $[a,b]$ 上与 $x$ 轴围成的面积
> - 分割：将 $[a,b]$ 分成 $n$ 个小区间
> - 近似：每个小区间 $[x, x+dx]$ 上的面积微元 $dA = f(x)dx$
> - 求和取极限：$A = \int_a^b f(x)dx$
> 

### 体积的计算

> [!note]
>  
> **例1** 计算底面积为 $A$，高为 $h$ 的棱柱体积
> 
> **解**：所有截面面积均为 $A$，所以
> $$
> V = \int_0^h A  dx = A \cdot h
> $$
> 
> **例2** 计算底半径为 $R$，高为 $h$ 的圆锥体积
> 
> **解**：在高度 $x$ 处的截面是半径为 $r(x) = R \cdot \frac{x}{h}$ 的圆，面积 $A(x) = \pi r^2(x) = \pi R^2 \frac{x^2}{h^2}$
> 
> 体积：
> $$
> V = \int_0^h A(x)dx = \int_0^h \pi R^2 \frac{x^2}{h^2} dx = \frac{\pi R^2}{h^2} \cdot \frac{h^3}{3} = \frac{1}{3}\pi R^2 h
> $$
> 

> [!note]
> 
> 曲线 $y = f(x)$ 绕 $x$ 轴旋转一周形成的旋转体体积：
> $$
> V = \int_a^b \pi [f(x)]^2 dx
> $$
> 
> **推导**：在 $x$ 处垂直于 $x$ 轴的截面是半径为 $f(x)$ 的圆盘，面积 $A(x) = \pi [f(x)]^2$
> 
> **例3** 计算 $y = \sqrt{x}$ 在 $[0,1]$ 上绕 $x$ 轴旋转形成的体积
> 
> **解**：
> $$
> V = \int_0^1 \pi (\sqrt{x})^2 dx = \pi \int_0^1 x  dx = \pi \cdot \frac{1}{2} = \frac{\pi}{2}
> $$
> 

> [!note]
>  
> 曲线 $y = f(x)$ 绕 $y$ 轴旋转一周形成的旋转体体积：
> $$
> V = \int_a^b 2\pi x f(x) dx
> $$
> 
> **推导**：在 $x$ 处厚度为 $dx$ 的柱壳体积微元 $dV = 2\pi x \cdot f(x) \cdot dx$
> 
> **例4** 计算 $y = x$ 在 $[0,1]$ 上绕 $y$ 轴旋转形成的体积
> 
> **解**：
> $$
> V = \int_0^1 2\pi x \cdot x  dx = 2\pi \int_0^1 x^2 dx = 2\pi \cdot \frac{1}{3} = \frac{2\pi}{3}
> $$
>


### 曲线弧长

> [!important]
>   
> ==直角坐标系下的弧长==
> 
> 曲线 $y = f(x)$ 在 $[a,b]$ 上的弧长：
> $$
> L = \int_a^b \sqrt{1 + [f'(x)]^2}  dx
> $$
> 
> **推导**：弧长微元 $ds = \sqrt{(dx)^2 + (dy)^2} = \sqrt{1 + \left(\frac{dy}{dx}\right)^2} dx$

> [!note]
>  
> **例5** 计算 $y = x^{3/2}$ 从 $x=0$ 到 $x=1$ 的弧长
> 
> **解**：$f'(x) = \frac{3}{2}x^{1/2}$，所以
> $$
> L = \int_0^1 \sqrt{1 + \left(\frac{3}{2}x^{1/2}\right)^2} dx = \int_0^1 \sqrt{1 + \frac{9}{4}x} dx
> $$
> 
> 令 $u = 1 + \frac{9}{4}x$，则 $du = \frac{9}{4}dx$，当 $x=0$ 时 $u=1$，$x=1$ 时 $u=\frac{13}{4}$
> 
> $$
> L = \frac{4}{9} \int_1^{13/4} \sqrt{u}  du = \frac{4}{9} \cdot \frac{2}{3} u^{3/2} \Big|_1^{13/4} = \frac{8}{27} \left[\left(\frac{13}{4}\right)^{3/2} - 1\right]
> $$

> [!important]
>  
> ==参数方程下的弧长==
> 
> 曲线由参数方程 $x = x(t), y = y(t)$ ($\alpha \leq t \leq \beta$) 给出时，弧长为：
> $$
> L = \int_\alpha^\beta \sqrt{\left(\frac{dx}{dt}\right)^2 + \left(\frac{dy}{dt}\right)^2}  dt
> $$

> [!ntoe]
>  
> **例6** 计算半径为 $R$ 的圆的周长
> 
> **解**：圆的参数方程 $x = R\cos t, y = R\sin t$ ($0 \leq t \leq 2\pi$)
> 
> $\frac{dx}{dt} = -R\sin t, \frac{dy}{dt} = R\cos t$
> 
> $$
> L = \int_0^{2\pi} \sqrt{(-R\sin t)^2 + (R\cos t)^2}  dt = \int_0^{2\pi} R  dt = 2\pi R
> $$
> 

> [!important]
> 
> ==极坐标下的弧长==
> 
> 曲线由极坐标方程 $r = r(\theta)$ ($\alpha \leq \theta \leq \beta$) 给出时，弧长为：
> $$
> L = \int_\alpha^\beta \sqrt{[r(\theta)]^2 + \left[\frac{dr}{d\theta}\right]^2}  d\theta
> $$
> 
> **推导**：利用直角坐标与极坐标的关系 $x = r\cos\theta, y = r\sin\theta$，代入参数方程的弧长公式可得。

> [!note]
>  
> **例7** 计算心形线 $r = a(1 + \cos\theta)$ ($0 \leq \theta \leq 2\pi$) 的周长
> 
> **解**：$\frac{dr}{d\theta} = -a\sin\theta$
> 
> $$
> L = \int_0^{2\pi} \sqrt{[a(1+\cos\theta)]^2 + (-a\sin\theta)^2}  d\theta
> = a\int_0^{2\pi} \sqrt{2 + 2\cos\theta}  d\theta
> $$
> 
> 利用 $1 + \cos\theta = 2\cos^2(\theta/2)$，得
> $$
> L = a\int_0^{2\pi} 2|\cos(\theta/2)| d\theta = 4a\int_0^{\pi} \cos(\theta/2) d\theta = 8a
> $$

## 物理中的应用: 功与能量

> 
> 在物理学中，力沿路径做的功定义为力与位移的乘积。当力是变力时，需要用积分计算。
>

> [!warning]
> 
> ==有限区域内的变力做功==
> 
> **例1** 弹簧压缩做功
> 
> **解**：根据胡克定律，弹簧力 $F(x) = kx$，其中 $k$ 为弹性系数，$x$ 为形变量
> 
> 将弹簧从平衡位置压缩 $L$ 距离做的功：
> $$
> W = \int_0^L kx  dx = \frac{1}{2}kL^2
> $$
> 
> **例2** 抽水做功
> 
> **解**：设圆柱形水箱半径 $R$，高 $H$，充满密度为 $\rho$ 的液体
> 
> 将厚度为 $dx$，距底面高度为 $x$ 的水层抽出需做功：
> $$
> dW = (\rho \pi R^2 dx) \cdot g \cdot (H - x)
> $$
> 
> 总功：
> $$
> W = \int_0^H \rho g \pi R^2 (H - x)  dx = \frac{1}{2} \rho g \pi R^2 H^2
> $$
>

> [!warning]
> 
> ==无穷区域上的做功问题==
> 
> **例3** 万有引力做功
> 
> **解**：质量为 $m$ 的物体从距地心 $r$ 处移动到无穷远处，克服地球引力做的功：
> 
> 根据万有引力定律，引力 $F(x) = \frac{GMm}{x^2}$，其中 $G$ 为引力常数，$M$ 为地球质量
> 
> 功的定义为：
> $$
> W = \int_r^\infty \frac{GMm}{x^2}  dx
> $$
> 
> 通过极限定义：
> $$
> W = \lim_{b \to \infty} \int_r^b \frac{GMm}{x^2}  dx = \lim_{b \to \infty} GMm \left[ -\frac{1}{x} \right]_r^b = \lim_{b \to \infty} GMm \left( \frac{1}{r} - \frac{1}{b} \right) = \frac{GMm}{r}
> $$
> 
> 这就是引力势能公式，它收敛到一个有限值。
>

> [!warning]
> 
> ==无界函数的积分==
> 
> 当被积函数在积分区间内无界时，也需要通过极限来定义积分。
> 
> **例4** 计算电场强度
> 
> **解**：点电荷 $Q$ 在距离 $r$ 处产生的电势：
> $$
> V = \int_r^\infty \frac{Q}{4\pi\epsilon_0 x^2}  dx
> $$
> 
> 在 $x = 0$ 处被积函数无界，但我们的积分从 $r > 0$ 开始，所以没有问题。
> 
> 考虑另一个例子：计算函数 $f(x) = \frac{1}{\sqrt{x}}$ 在 $[0,1]$ 上的积分
> 
> 在 $x=0$ 处函数无界，我们通过极限定义：
> $$
> \int_0^1 \frac{1}{\sqrt{x}}  dx = \lim_{a \to 0^+} \int_a^1 \frac{1}{\sqrt{x}}  dx = \lim_{a \to 0^+} \left[ 2\sqrt{x} \right]_a^1 = \lim_{a \to 0^+} (2 - 2\sqrt{a}) = 2
> $$
> 
> 这个积分收敛到有限值 2。

## 概率中的应用

> [!tip]
> 
> 积分学在概率论中扮演着核心角色，特别是在处理连续型随机变量时。本节将介绍如何用积分来描述和分析连续随机现象。掌握积分在概率中的应用，不仅是学习概率论的基础，也是理解现代统计学、金融工程等领域的必备工具。


> [!important]
> 
> ==概率密度函数==
> 
> 对于连续型随机变量，我们不能像离散情况那样谈论某个具体值的概率，而是使用概率密度函数来描述概率分布。
> 
> **定义**：
> 如果存在非负函数 $f(x)$，使得对任意实数 $a \leq b$，随机变量 $X$ 落在区间 $[a,b]$ 内的概率为
> $$
> P(a \leq X \leq b) = \int_a^b f(x)  dx
> $$
> 则称 $f(x)$ 为 $X$ 的概率密度函数。
> 
> **性质**：
> 1. 非负性：$f(x) \geq 0$ 对所有 $x$ 成立
> 2. 归一性：$\int_{-\infty}^\infty f(x)  dx = 1$
> 
> **例1** 验证函数 $f(x) = \begin{cases} 
> 2x & 0 \leq x \leq 1 \\
> 0 & \text{其他}
> \end{cases}$ 是否为概率密度函数
> 
> **解**：检查非负性：在 $[0,1]$ 上 $2x \geq 0$，满足
> 
> 检查归一性：
> $$
> \int_{-\infty}^\infty f(x)  dx = \int_0^1 2x  dx = [x^2]_0^1 = 1
> $$
> 
> 因此 $f(x)$ 是一个合法的概率密度函数。

> [!note]
> 
> ==均匀分布==
> 
> 均匀分布描述了一个随机变量在某个区间内等可能取值的现象。
> 
> **定义**：
> 如果随机变量 $X$ 在区间 $[a,b]$ 上有概率密度函数
> $$
> f(x) = \begin{cases}
> \frac{1}{b-a} & a \leq x \leq b \\
> 0 & \text{其他}
> \end{cases}
> $$
> 则称 $X$ 服从均匀分布，记作 $X \sim U(a,b)$。
> 
> **例2** 公共汽车到站时间问题
> 
> **解**：假设公共汽车每10分钟一班，乘客随机到达车站，求等待时间不超过3分钟的概率。
> 
> 等待时间 $X \sim U(0,10)$，概率密度函数 $f(x) = \frac{1}{10}$，$0 \leq x \leq 10$
> 
> $$
> P(0 \leq X \leq 3) = \int_0^3 \frac{1}{10}  dx = \frac{3}{10} = 0.3
> $$
> 
>

> [!note]
> 
> ==指数分布==
> 
> 指数分布常用于描述等待时间、寿命等随机现象。
> 
> **定义**：
> 如果随机变量 $X$ 有概率密度函数
> $$
> f(x) = \begin{cases}
> \lambda e^{-\lambda x} & x \geq 0 \\
> 0 & x < 0
> \end{cases}
> $$
> 其中 $\lambda > 0$，则称 $X$ 服从参数为 $\lambda$ 的指数分布。
> 
> **例3** 电子元件寿命问题
> 
> **解**：某电子元件的寿命 $X$（单位：小时）服从参数 $\lambda = 0.001$ 的指数分布，求该元件能工作超过1000小时的概率。
> 
> $$
> P(X > 1000) = \int_{1000}^\infty 0.001 e^{-0.001x}  dx
> $$
> 
> 计算这个反常积分：
> $$
> \lim_{b \to \infty} \int_{1000}^b 0.001 e^{-0.001x}  dx = \lim_{b \to \infty} \left[ -e^{-0.001x} \right]_{1000}^b = e^{-1} \approx 0.3679
> $$
> 

> [!note]
> 
> ==正态分布==
> 
> 正态分布（高斯分布）是概率论与统计学中最重要的分布，它描述了自然界中大量随机现象的分布规律。
> 
> **定义**：
> 如果随机变量 $X$ 有概率密度函数
> $$
> f(x) = \frac{1}{\sqrt{2\pi}\sigma} e^{-\frac{(x-\mu)^2}{2\sigma^2}}
> $$
> 则称 $X$ 服从正态分布，记作 $X \sim N(\mu,\sigma^2)$。
> 
> **参数意义**：
> - $\mu$：均值，决定分布的中心位置
> - $\sigma$：标准差，决定分布的分散程度
> 
> **标准正态分布**：
> 当 $\mu = 0$，$\sigma = 1$ 时，称为标准正态分布，其概率密度函数为
> $$
> \varphi(x) = \frac{1}{\sqrt{2\pi}} e^{-\frac{x^2}{2}}
> $$
> 
> **概率计算**：
> 对于 $X \sim N(\mu,\sigma^2)$，$P(a \leq X \leq b) = \int_a^b \frac{1}{\sqrt{2\pi}\sigma} e^{-\frac{(x-\mu)^2}{2\sigma^2}}  dx$
> 
> 这个积分没有初等函数形式的原函数，谜底留到第二册.


## 反常积分

> [!tip]
> 
> 反常积分处理两类问题：无穷区间上的积分和无界函数的积分。

> [!important]
> 
> ==无穷区间上的反常积分==
> 
> **定义**：
> 1. $\int_a^\infty f(x)  dx = \lim_{b \to \infty} \int_a^b f(x)  dx$
> 2. $\int_{-\infty}^b f(x)  dx = \lim_{a \to -\infty} \int_a^b f(x)  dx$
> 3. $\int_{-\infty}^\infty f(x)  dx = \int_{-\infty}^c f(x)  dx + \int_c^\infty f(x)  dx$（$c$ 为任意实数）
> 
> **收敛判别**：
> 如果极限存在且有限，则称反常积分收敛；否则称发散。

> [!note]
> 
> **例5** 研究 $\int_1^\infty \frac{1}{x^p}  dx$ 的收敛性
> 
> **解**：
> 当 $p \neq 1$ 时：
> $$
> \int_1^\infty \frac{1}{x^p}  dx = \lim_{b \to \infty} \left[ \frac{x^{1-p}}{1-p} \right]_1^b = \lim_{b \to \infty} \frac{b^{1-p} - 1}{1-p}
> $$
> 
> - 当 $p > 1$ 时，$b^{1-p} \to 0$，积分收敛于 $\frac{1}{p-1}$
> - 当 $p < 1$ 时，$b^{1-p} \to \infty$，积分发散
> 
> 当 $p = 1$ 时：
> $$
> \int_1^\infty \frac{1}{x}  dx = \lim_{b \to \infty} [\ln x]_1^b = \lim_{b \to \infty} \ln b = \infty
> $$
> 发散。

> [!important]
> 
> ==无界函数的反常积分（瑕积分）==
> 
> 如果函数 $f(x)$ 在点 $c$ 的任意邻域内无界，则称 $c$ 为瑕点。
> 
> **定义**：
> 1. 若 $f(x)$ 在 $[a,b)$ 上连续，且 $\lim_{x \to b^-} f(x) = \infty$，则
>    $$
>    \int_a^b f(x)  dx = \lim_{t \to b^-} \int_a^t f(x)  dx
>    $$
> 
> 2. 若 $f(x)$ 在 $(a,b]$ 上连续，且 $\lim_{x \to a^+} f(x) = \infty$，则
>    $$
>    \int_a^b f(x)  dx = \lim_{t \to a^+} \int_t^b f(x)  dx
>    $$
> 
> 3. 若 $c \in (a,b)$ 是瑕点，则
>    $$
>    \int_a^b f(x)  dx = \int_a^c f(x)  dx + \int_c^b f(x)  dx
>    $$

> [!note]
> 
> **例6** 研究 $\int_0^1 \frac{1}{x^p}  dx$ 的收敛性
> 
> **解**：
> 当 $p \neq 1$ 时：
> $$
> \int_0^1 \frac{1}{x^p}  dx = \lim_{a \to 0^+} \left[ \frac{x^{1-p}}{1-p} \right]_a^1 = \lim_{a \to 0^+} \frac{1 - a^{1-p}}{1-p}
> $$
> 
> - 当 $p < 1$ 时，$a^{1-p} \to 0$，积分收敛于 $\frac{1}{1-p}$
> - 当 $p > 1$ 时，$a^{1-p} \to \infty$，积分发散
> 
> 当 $p = 1$ 时：
> $$
> \int_0^1 \frac{1}{x}  dx = \lim_{a \to 0^+} [\ln x]_a^1 = \lim_{a \to 0^+} (-\ln a) = \infty
> $$
> 发散。


---
title: 高等数学讲义
author: 胡煜成
description: 首都师范大学高等数学A
"og:description": 浏览器版和手机版
"og:image": https://vlook-doc.pages.dev/pic/vlook-og.png
keywords:
- 高等数学,微积分,讲义
vlook-chp-autonum: h1=off
vlook-query: vdl=on
vlook-query: ws=off
---

[toc]

# 常微分方程

> [!tip] 
> 
> 微分方程是解决实际问题的重要数学工具. 现实世界中的很多问题, 如天体运动, 空气和水的流动, 疾病的传播等现象都可以用微分方程来描述, 本章的任务是介绍几个典型的微分方程及其求解方法.

## 什么是微分方程

> [!important]
> 
> 顾名思义, 微分方程就是含有微分的等式. 例如
> 
> $$
> y' = \frac{dy}{dx} = 2xy
> $$
> 

> [!caution]
> 
> ==微分方程的阶数==
> 
> 微分方程中还可能含有高阶导数, 如 $y^{\prime \prime}, y^{\prime \prime \prime},  \cdots, y^{(n)}$, 方程中所包含的最高阶的导数为几阶, 那么我们就称该微分方程为几阶的.
> 

> [!caution]
> 
> ==微分方程的解==
> 
> 满足微分方程的函数 $y(x)$ 称为微分方程的解. 给定 $y(x)$ 很容易判断它是不是一个微分方程的解, 但是反过来却不容易: 事实上, **大部分的微分方程我们是解不出来的**. 接下来我们要介绍几类比较简单的能够求解的微分方程. 

> [!note] 
>
> ==自由落体的小球==
>
> 考虑一个自由落体的小球, 忽略空气阻力, 根据**牛顿第二定律**, 小球在垂直方向上下落的距离 $y$ 随时间 $t$ 变化的函数 $y(t)$ 满足
>
> $$
> \begin{equation}
> y^{\prime \prime}(t)=g
> \end{equation}
> $$
>
> 方程的右边是一个常数 (**重力加速度**), 左边是一个二阶导数, 所以这是一个**二阶微分方程**. 
>
> 下面我们来求解这个微分方程:
>
> Step 1. 
>
> 令 $v(t)=y^{\prime}(t)$, 则原方程可化为:
> $$
> \begin{equation}
> y''(t)=v'(t)=g
> \end{equation}
> $$
>
> 这是一个关于函数 $v(t)$ 的一阶微分方程. 对该方程两边对自变量 $t$ 做不定积分, 得到
>
> $$
> v(t)=g t+C_1
> $$
>
> 容易验证, 这个 $v(t)$ 确实满足上述微分方程, 所以这样我们就求解了该方程.
>
> 但有同学可能注意到了, 这个解中含有一个常数 $C_1$, 那我们该拿这个 $C_1$ 怎么办呢? 单从微分方程本身我们是没有办法确定 $C_1$ 的值的, 但是我们可以根据**物理条件**来确定 $C_1$ 的值, 这样的条件也被称为**定解条件**. 
>
> `定解条件1`: 小球的初速度为 $2m/s$, 即 $t=0$ 时, $ v(0)=2$. 
>
> 带入方程得 $C_1=2$, 于是我们得到 
> 
> $$
> \begin{equation}
> v(t) = gt + 2
> \end{equation}
> $$
> 
> 为满足`定解条件1`的微分方程 (2) 的解.
>
> Step 2. 
>
> 接下来我们在 (3) 式的基础上继续求解微分方程 (1). 此时
> 
> 
> $$
> y'(t)= v(t) = g t + 2 
> $$
> 
> 对等式两边积分得到
> 
> $$
> y(t)=\frac{1}{2} g t^2 + 2t + C_2
> $$
> 
> 为了确定 $C_2$ 的具体数值, 我们需要第二个定解条件
> 
> `定解条件2`: 小球的初始位置在1米处, 即 $t=0$ 时有 $y(0)=1$
> 
> 同`定解条件1`一样, `定解条件2`也是来自于物理而非方程本身.
> 
> 根据`定解条件2`容易确定, $C_2 = 1$, 从而微分方程 (1) 的解为
> $$
> y(t)= \frac{1}{2} g t^2 + 2t + 1.
> $$
> 
> 此时, 方程的解中已经不含有未知数, 也就是说它是微分方程 (1) 和`定解条件1&2`所确定的唯一解.

> [!warning]
>
> 可能有同学已经注意到了, 上个例子中我们所谓的解微分方程不就是在做不定积分吗? 这是对的. 后面我们会体会到, 很多时候求解微分方程都要归结到积分运算.
>


> [!note]
> 
> ==简谐振动==
> 
> **一维弹簧振子**
> 假设一个质量为 $m$ 的物体连接在弹簧的一端，弹簧另一端固定。当物体受到弹簧的恢复力作用时，它会在平衡位置附近做简谐振动。根据胡克定律，弹簧的恢复力与位移 $x(t)$ 成正比，方向与位移相反，其表达式为：  
> $$
> F_{\text{弹}} = -kx(t)
> $$
> 
> 其中，$k$ 为弹簧常数，$x(t)$ 为物体相对于平衡位置的位移。根据牛顿第二定律，力等于质量乘加速度，因此：  
> 
> $$
> F = ma = m\frac{d^2x(t)}{dt^2}
> $$
> 
> 将两者代入得到弹簧振子的运动方程：  
> 
> $$
> m\frac{d^2x(t)}{dt^2} = -kx(t)
> $$
> 
> 整理得：  
> 
> $$
> \frac{d^2x(t)}{dt^2} + \frac{k}{m}x(t) = 0
> $$
> 
> 令 $\omega^2 = \frac{k}{m}$，方程化为：  
> 
> $$
> \frac{d^2x(t)}{dt^2} + \omega^2 x(t) = 0
> $$
> 
> 这就是简谐振动的微分方程。  
> 
> **方程的解**  
> 
> 接下来我们来"蒙"一个微分方程的解. 你没有听错, 因为微分方程太难解了, 以至于"蒙"也成了一个合理的办法, 总之不管用什么方法, 只要能找到解就行.
> 
> 该二阶线性齐次微分方程的通解为：  
> $$
> x(t) = A\cos(\omega t) + B\sin(\omega t)
> $$
> 
> 其中，$A$ 和 $B$ 是由初始条件决定的常数。  
> 
> **定解条件**  
> 如果初始时刻 $t = 0$ 时，物体的位移为 $x(0) = x_0$，速度为 $v(0) = v_0$，我们可以通过代入初始条件求解 $A$ 和 $B$：  
> 
> 1. **初始位移条件**：  
> $$x(0) = A = x_0$$  
> 2. **初始速度条件**：  
> $$v(0) = x'(0) = -A\omega\sin(0) + B\omega\cos(0) = B\omega = v_0$$  
> 
> 代入初始条件得到：  
> 
> $$
> x(t) = x_0 \cos(\omega t) + \frac{v_0}{\omega} \sin(\omega t)
> $$
> 
> 这个解描述了弹簧振子在简谐运动中的位移随时间的变化情况。

> [!note]
> ==单摆==
> 
> **单摆的描述**  
> 单摆由长度为 $L$ 的细绳和质量为 $m$ 的小球组成，小球在重力作用下绕固定点摆动。假设摆角为 $\theta(t)$，即小球偏离竖直方向的角度，我们将推导其运动方程。  
>  
> **受力分析**  
> 小球所受的力主要包括：  
> 1. **重力** $mg$，方向竖直向下；  
> 2. **绳子的张力** $T$，方向沿绳子向内。  
>  
> 将重力分解为两个方向：  
> - 沿绳方向的分力 $mg\cos\theta$，被张力抵消；  
> - 垂直于绳方向的分力 $mg\sin\theta$，产生恢复力矩。  
>  
> **力矩分析**  
> 恢复力矩 $\tau$ 关于固定点 O 为：  
> $$
> \tau = -mgL\sin\theta
> $$
>  
> 根据牛顿第二定律的角度形式，力矩等于转动惯量 $I$ 乘角加速度 $\alpha$：  
> $$
> \tau = I \alpha
> $$
>  
> 对于单摆，转动惯量 $I = mL^2$，角加速度 $\alpha = \frac{d^2\theta}{dt^2}$，因此：  
> $$
> -mgL\sin\theta = mL^2 \frac{d^2\theta}{dt^2}
> $$
>  
> 消去 $m$ 和 $L$ 后，得到：  
> $$
> \frac{d^2\theta}{dt^2} + \frac{g}{L}\sin\theta = 0
> $$
>  
> **小角近似**  
> 当 $\theta$ 较小时，$\sin\theta \approx \theta$（弧度制），方程简化为：  
> $$
> \frac{d^2\theta}{dt^2} + \frac{g}{L}\theta = 0
> $$
>  
> 这就是单摆在小角度近似下的简谐运动方程。  
>  
> **方程的解**  
> 该方程的解跟简谐振动完全一样.
> 

> [!note]
> **LC电路**  
> 一个理想的LC电路由电感 $L$ 和电容 $C$ 组成。假设电路中无电阻，电感与电容串联。电容的电荷量 $q(t)$ 随时间变化，导致电路中的电流 $i(t)$ 也随时间变化。我们来推导该系统的运动方程。  
>  
> **基本方程**  
> 1. **电容的关系**：  
> 电容两端的电压 $u_C(t)$ 与电荷量 $q(t)$ 的关系为：  
> $$
> u_C(t) = \frac{q(t)}{C}
> $$
>  
> 2. **电感的关系**：  
> 电感两端的电压 $u_L(t)$ 与电流变化率 $\frac{di(t)}{dt}$ 的关系为：  
> $$
> u_L(t) = L \frac{di(t)}{dt}
> $$
> 由于电流 $i(t)$ 是电荷 $q(t)$ 的时间导数：  
> $$
> i(t) = \frac{dq(t)}{dt}
> $$
>  
> **回路方程（基尔霍夫电压定律）**  
> 在LC电路中，总电压为零，即：  
> $$
> u_L(t) + u_C(t) = 0
> $$
> 代入电感和电容的表达式：  
> $$
> L \frac{d^2q(t)}{dt^2} + \frac{q(t)}{C} = 0
> $$
>  
> **LC震荡方程**  
> 将上式整理为标准形式：  
> $$
> \frac{d^2q(t)}{dt^2} + \frac{1}{LC}q(t) = 0
> $$
>  
> 这就是LC电路的微分方程，描述了电容器电荷随时间的简谐振荡过程。  
>  
> **特征频率**  
> LC电路的特征角频率 $\omega_0$ 为：  
> $$
> \omega_0 = \sqrt{\frac{1}{LC}}
> $$
> 这表明LC电路的振荡频率只由电感和电容决定，与初始电荷或电流无关。

> [!note]
> 
> ==地心电梯==
> 
> **牛顿壳层定理**
> 假设一个半径为 $R$、质量为 $M$ 的均匀球壳，质点 $m$ 位于球壳内部或外部，球壳对质点的引力为
> 
> - 当 $r \geq R$ 时，球壳对质点的引力为：  
> $$
> F = G\frac{Mm}{r^2}
> $$
> - 当 $r < R$ 时，球壳对质点的引力为：  
> $$
> F = 0
> $$
> 
> 这表明在球壳内部，质点所受引力为零，而在外部，引力遵循经典的万有引力公式，等效于将球壳质量集中于球心。
> 
> 
> **牛顿壳层定理的微积分推导**
> 
>  1. 外部质点的引力
> 取球壳上一个面积元 $dA = R^2 \sin\theta \, d\theta \, d\phi$，其中 $\theta$ 是极角，$\phi$ 是方位角。  
> 球壳的面密度 $\sigma = \frac{M}{4\pi R^2}$，因此面积元的质量：  
> $$
> dm = \sigma \, dA = \frac{M}{4\pi R^2} \cdot R^2 \sin\theta \, d\theta \, d\phi
> $$
> 质点 $P$ 与面积元 $dm$ 之间的距离为：  
> $$
> s = \sqrt{r^2 + R^2 - 2rR\cos\theta}
> $$
> 微元 $dm$ 对质点 $P$ 产生的引力：  
> $$
> dF = G \frac{dm \cdot m}{s^2}
> $$
> 由于球壳的对称性，垂直于径向的引力分量会相互抵消，仅剩下沿径向的分量：  
> $$
> dF_{\text{径}} = dF \cdot \frac{r - R\cos\theta}{s}
> $$
> 将 $dF_{\text{径}}$ 对整个球壳积分：  
> $$
> F = \int_0^{2\pi} \int_0^\pi G \frac{M m}{4\pi R^2} \cdot \frac{R^2 \sin\theta (r - R\cos\theta)}{(r^2 + R^2 - 2rR\cos\theta)^{3/2}} \, d\theta \, d\phi
> $$
> 计算结果表明，球壳外部的引力等效于质量集中于球心：  
> $$
> F = G \frac{Mm}{r^2}
> $$
> 
> 2. 外层球壳的引力为零 (也可以用积分计算, 但比较繁琐)
> 
> 考虑距球心距离为 $r$ 的质点 $P$，外层的壳质量不影响 $P$。引力微元在 $P$ 点的径向和垂直方向上完全抵消，因此外层壳对 $P$ 的引力为：  
> $$
> F_{\text{外}} = 0
> $$
> 
> 
> **穿过地心的电梯在重力作用下的运动方程推导**  
> 
> 假设一部电梯沿直线穿过地球中心，从地球表面一端移动到另一端，忽略空气阻力和其他阻力，仅考虑重力作用。我们将推导电梯在这种情况下的运动方程。  
> 
> 假设地球是一个半径为 $R$ 的均匀密度球体，总质量为 $M$，密度为 $\rho = \frac{M}{\frac{4}{3} \pi R^3}$。在距离地心 $r$ 处，电梯所受引力只来自半径为 $r$ 的球体部分，质量为：  
> $$
> M(r) = \rho \cdot \frac{4}{3} \pi r^3 = M \cdot \frac{r^3}{R^3}
> $$
> 
> 根据牛顿引力定律，电梯在距离地心 $r$ 处的引力为：  
> $$
> F(r) = G \frac{M(r) \cdot m}{r^2} = G \frac{M \cdot m \cdot r}{R^3}  
> $$
> 因此，重力加速度为：  
> $$
> g(r) = G \frac{M}{R^3} \cdot r  
> $$
> 
> 电梯在重力作用下的加速度为 $-g(r)$，即：  
> $$
>\frac{d^2r}{dt^2} = -G \frac{M}{R^3} \cdot r  
> $$
> 这就是一个简谐振动方程，其形式为：  
> $$
> \frac{d^2r}{dt^2} + \omega^2 r = 0  
> $$
> 其中，角频率 $\omega$ 为：  
> $$
> \omega = \sqrt{\frac{G M}{R^3}}  
> $$
>  

## 可分离变量方程

> [!tip]
> 
> 这一节我们介绍一类比较简单的微分方程的解法.

> [!note]
>
> ==速率方程==
>
> 在这个例子中我们考虑一阶微分方程
>
> $$
> \begin{equation}
> \frac{dy}{dt} = k y
> \end{equation}
> $$
>
> 其中 $k$ 为常数. 方程 (4) 是一类非常重要的微分方程, 方程左边是 $y$ 随时间的变化率, 整个方程则表示 $y$ 的瞬时变化率与 $y$ 在当前时刻的值成正比. 这类方程在实际问题中十分常见, 下面我们看两个实例.
>
> **情景1: 传染病**
>
> 考虑一个传染病爆发的场景, 我们用 $y(t)$ 表示 $t$ 时刻感染者的数目. 由于疾病的传播依赖于人和人的接触, 所以当前的感染者 $y(t)$ 约多, 新增的感染人数就会越大. 我们用一个系数 $k$ 来表示这个病的传播能力, 可以理解为在单位时间内一个感染者 (平均) 能够传染 $k$ 个人. 因此在过了 $\Delta t$ 的时间后, $t_0+\Delta t$ 时刻的感染者人数等于 $t_0$ 时刻的感染者人数加上 $\Delta t$ 这段时间内新增的感染者人数, 即
>
> $$
> \begin{equation}
> y(t_0+\Delta t) \approx y(t_0) + k y(t_0) \Delta t
> \end{equation}
> $$
>
> 注意这里时约等于, 因为在 $\Delta$ 这段时间内, 感染者的人数并总是不严格等于 $y(t_0)$ 的, 但是如果 $\Delta t$ 取得很小, 那么 $y$ 的变化也非常小 ($y(t)$ 的连续性), 从而可以近似看成常数 $y(t_0)$.
>
> 通过对公式 (5) 进行变换可以得到
>
> $$
> \frac{y(t_0+\Delta t) - y(t_0)} {\Delta t} \approx  k y(t_0) 
> $$
>
> 根据上面的分析, 当我们让 $\Delta t$ 区域 0 时, 左边趋近于 $y'(t_0)$, 而约等号也会"趋近于"等号, 因此我们得到
>
> $$
> y'(t_0) = k y(t_0)
> $$
>
> 上式中把 $t_0$ 换成 $t$, 就得到微分方程 (4). 
>
> **情景2: 化学反应**
>
> 考虑一个放射性元素的衰变过程，我们用 $y(t)$ 表示 $t$ 时刻剩余的放射性原子数。放射性元素的衰变是一个随机过程，每个原子都有一定的概率在单位时间内发生衰变，因此衰变的速率与当前剩余的原子数成正比。我们用一个常数 $k$ 来表示这种衰变率，称为**衰变常数**，即单位时间内一个原子发生衰变的概率。  
>
> 在时间 $\Delta t$ 之后，剩余的放射性原子数 $y(t_0+\Delta t)$ 可以表示为 $t_0$ 时刻的原子数减去这段时间内衰变的原子数：  
>
> $$
> y(t_0+\Delta t) \approx y(t_0) - k y(t_0) \Delta t
> $$
>
> 注意这里的负号表示原子数目在减小, 而约等于号表示在 $\Delta t$ 时间内，衰变速率近似保持恒定，因为当 $\Delta t$ 很小时，$y(t)$ 变化非常小，$y(t_0)$ 可以被近似看作常数。
>
> 对上式整理并移项得到：
>
> $$
> \frac{y(t_0+\Delta t) - y(t_0)}{\Delta t} \approx -k y(t_0)
> $$
>
> 当我们令 $\Delta t \to 0$ 时，左边趋近于 $y'(t_0)$，约等号也趋近于等号，因此得到：
>
> $$
> y'(t_0) = -k y(t_0)
> $$
>
> 将 $t_0$ 换成一般的 $t$，同样得到微分方程 (4), 只是系数变成了负数.
>
> 
>
> 下面我们来"蒙"方程(4)的解. 我们知道, $\mathrm{e}^t$ 的导数等于它自己, 因此 $\mathrm{e}^t$ 是满足微分方程 $y' = y$ 的一个解. 对 $\mathrm{e}^x$ 进行适当边形, 可以构造出 (4) 的解为
>
> $$
> y(t) = C\mathrm{e}^{kt}
> $$
>
> 其中 $C$ 为一个参数, 依赖于定解条件.
>
> 在**情景1**中, 假设初始时刻 $t=0$ 时感染者的人数 $y(0) = 100$, 可以得到 $C = 100$. 于是 $t$ 时刻的感染者等于
>
> $$
> y(t) = 100\mathrm{e}^{kt}
> $$
>
> 我们经常听到传染病人数"指数型增长"的可怕说法, 背后对应的就是这个数学公式. 当然, 实际情况下指数增长只是在传染病爆发的初期出现, 随着时间的增长, 未感染的群体数目会减小, 还有一部分感染者将被治愈, 这时微分方程 (4) 就不再成立了, 需要用一个新的微分方程来描述.
>
> 在**情景2**中，假设初始时刻 $t=0$ 时放射性原子的数目 $y(0) = N_0$，因此微分方程 
> $$
> y' = -ky
> $$
> 的解为:
>
> $$
> y(t) = N_0 e^{-k t}
> $$
>
> 这个公式描述了放射性原子数目随时间的指数型衰减。与传染病的"指数型增长"相反，放射性衰变是一种**指数型减少**的过程。  
>
> 在实际情况中，放射性衰变是一个非常稳定的过程，不受外界环境的影响，因此微分方程 $y'(t) = -k y(t)$ 可以长期成立，直至几乎所有原子都完成衰变。我们常用**半衰期** $T_{\frac{1}{2}}$ 来描述这个衰变过程，即原子数目减少到初始值一半所需的时间。通过解方程 $y(T_{\frac{1}{2}}) = \frac{N_0}{2}$，可以得到：
>
> $$
> T_{\frac{1}{2}} = \frac{\ln 2}{k}
> $$
>
> 半衰期是一个重要的物理量，它使得我们可以通过简单的实验观测来确定衰变常数 $k$，从而了解放射性物质的衰变特性.

> [!important]
> 
> ==可分离变量方程的求解==
> 
> 方程 (4) 的求解其实可以不通过"蒙", 而是通过一种叫做 "separation of variables" 的技巧求解. 注意到 (4) 可以变形为
> 
> $$
> \frac{dy}{y} = k dx
> $$
> 
> 注意到上式有这么一个特点: 左边只含有变量 $y$, 右边只含有变量 $x$, 具有这个性质的微分方程就是**可分离变量**的微分方程. 这类方程的求解方法为分别对等式左右两边积分, 对上式而言, 可以得到
> 
> $$
> \ln y = k x + \tilde{C}
> $$
> 
> 从而
> 
> $$
> y = \mathrm{e}^{kx +\tilde{C}} = C\mathrm{e}^{kx}
> $$
>
> 这正是我们刚才猜到的解的形式.
> 

> [!note]
> 
> ==例==
> 
> 求解方程 $\displaystyle y' = \frac{y^2}{x^2}$.
> 
> 解: 方程可转换为变量分离的形式:
> 
> $$
> \frac{dy}{y^2} = \frac{dx}{x^2}
> $$
> 
> 对等式两边积分得到
> 
> $$
> -\frac{1}{y} = -\frac{1}{x} + C
> $$
> 
> 即
> 
> $$
> y = \frac{x}{1 + kx}
> $$
> 
> 其中 $k$ 为常数.
> 

## 常系数一阶线性微分方程

> [!tip]
> 
> 本节我们在上一节所介绍的速率方程的基础上进一步扩充, 考虑形如 $ y' = ky + b$ 的方程. 这类方程在实际应用中也经常出现, 属于**一阶线性微分方程**, 它比速率方程多了一个右端项 $b$, 这一节我们首先考虑系数 $k$, $b$ 都是常数的情形. 下一节我们将考虑更加复杂的 $k(x)$, $b(x)$ 随 $x$ 变化的情形.
> 

> [!note]
> 
> ==例: 恒定速率的降温过程(牛顿冷却定律)==
>   
> **模型描述**  
> 牛顿冷却定律描述了物体与周围环境之间的温度变化过程，其微分方程模型为：  
> $$
> \frac{dT}{dt} = -k (T - T_{\text{env}}) 
> $$
> 
> 其中：  
> - $T(t)$：物体在时间 $t$ 的温度。  
> - $T_{\text{env}}$：环境温度（常数）。  
> - $k$：冷却系数，$k > 0$。  
>   
> **求解过程（分离变量法）**  
> 1. 将方程整理为：  
> $$
> \frac{dT}{T - T_{\text{env}}} = -k \, dt
> $$
>   
> 2. 对两边积分：  
> $$
> \int \frac{dT}{T - T_{\text{env}}} = \int -k \, dt
> $$
>   
> 3. 积分结果为：  
> $$
>  \ln |T - T_{\text{env}}| = -kt + C 
> $$
>   
> 4. 通过指数函数解出 $T$：  
> $$
> T - T_{\text{env}} = C_1 e^{-kt} 
> $$
> 
> 其中 $C_1 = e^C$ 为任意常数。  
>   
> 5. 利用初始条件 $T(0) = T_0$，求出 $C_1$：  
> $$
> T_0 - T_{\text{env}} = C_1 
> $$
>   
> 6. 最终解为：  
> $$
> T(t) = T_{\text{env}} + (T_0 - T_{\text{env}}) e^{-kt} 
> $$
>   
> **解释**  
> 物体的温度逐渐趋近于环境温度 $T_{\text{env}}$，冷却速度由系数 $k$ 控制。  

> [!note]
>
> ==例: 简单贷款偿还模型==
>
> **模型描述**  
> 贷款偿还模型描述了借款人以恒定利率和固定还款额偿还贷款的过程，其微分方程为：  
> $$
> \frac{dB}{dt} = rB - P 
> $$
>
> 其中：  
> - $B(t)$：时间 $t$ 时剩余的贷款余额。  
> - $r$：年利率（常数）。  
> - $P$：每年固定还款额。  
>
> **求解过程（分离变量法）**  
>
> 1. 将方程整理为：  
> $$
> \frac{dB}{rB - P} = dt
> $$
>
> 2. 对两边积分：  
> $$
> \int \frac{dB}{rB - P} = \int dt 
> $$
>
> 3. 积分结果为：
>
> $$
>  \frac{1}{r} \ln |rB - P| = t + C 
> $$
>
>   4. 解出 $B$：  
>
> $$
>  rB - P = C_1 e^{rt} 
> $$
>
> 其中 $C_1 = e^{rC}$。  
>
>   5. 利用初始条件 $B(0) = B_0$，求出 $C_1$：  
>
> $$
> rB_0 - P = C_1
> $$
> 6. 最终解为：  
>
> $$
>  B(t) = \frac{P}{r} + \left( B_0 - \frac{P}{r} \right) e^{rt} 
> $$
>
> **解释**  
>   如果 $P > rB_0$，余额 $B(t)$ 随时间逐渐减少，最终贷款将被还清；反之，如果 $P \leq rB_0$，贷款余额将持续增长。

## 变系数一阶线性微分方程

> [!tip]
> 
> 本节考虑更加复杂的 $k(x)$, $b(x)$ 随 $x$ 变化的**一阶线性微分方程**: $ y' = k(x)y + b(x)$.
> 

> [!note] 
>
> ==例: 城市热岛效应模型讲义==
>
> **模型描述**  
>
> 城市热岛效应是指由于人类活动和城市结构导致城市温度显著高于周边郊区的现象。为了描述这种现象，可以使用以下一阶线性微分方程模型：  
>
> $$
> \frac{dT}{dt} = -\alpha(t) T + Q(t)
> $$
>
> 其中：  
> - $T(t)$：城市的平均温度（随时间变化）。  
> - $\alpha(t)$：时间相关的散热系数，表示城市向外部环境散热的效率。  
>   白天，建筑材料吸热，散热效率降低，$\alpha(t)$ 较小。  
>   夜晚，城市散热效率提高，$\alpha(t)$ 较大。  
> - $Q(t)$：时间相关的外部热源，包括：  
> 	太阳辐射：随时间变化呈现周期性。  
>   人类活动：如车辆排放、工业生产、空调使用等。通常在白天达到高峰。   
>
> **模型扩展(通常用在数学建模中)**  
>
> - **加入风速影响：**  
>   散热系数 $\alpha(t)$ 可以扩展为 $\alpha(t, v_w)$，其中 $v_w$ 为风速。风速较大时，散热效果增强。  
>   $$
>   \frac{dT}{dt} = -\alpha(t, v_w) T + Q(t)
>   $$
>
> - **考虑湿度和绿化率：**  
>   可以通过引入湿度和绿化率来模拟更复杂的热交换过程：  
>   $$
>   \frac{dT}{dt} = -(\alpha(t) + \beta H + \gamma G)T + Q(t)
>   $$
>   
> - 
>
>  其中 $H$ 为湿度，$G$ 为绿化率，$\beta$ 和 $\gamma$ 为对应的影响系数。  
>

> [!important]
> 
> ==常数变异法==
> 
> 求解变系数的一阶线性微分方程可以使用常数变异法. 过程如下:
> 
> `step 1`
> 将方程的非齐次项 $b(x)$ 去掉，得到齐次方程：  
> $y' = k(x)y$  
> 这个方程是可分离变量的，解法为：  
> $$
> \frac{dy}{y} = k(x)dx
> $$
> 积分得到：  
> $$
> \ln|y| = \int k(x) dx + C
> $$
> 进一步简化：  
> $$
> y_h = Ce^{\int k(x) dx}
> $$
> 这是齐次方程的一般解。
>
> `step 2`
> 假设非齐次方程的特解形式为：  
> $$
> y_p = u(x)e^{\int k(x) dx}
> $$
> 其中 $u(x)$ 是待定函数。
>
> `step 3`
> 将 $y_p = u(x)e^{\int k(x) dx}$ 代入原方程 $y' = k(x)y + b(x)$，利用链式法则：  
> $$
> y_p' = u'(x)e^{\int k(x) dx} + u(x)k(x)e^{\int k(x) dx}
> $$
> 将 $y_p$ 和 $y_p'$ 代入原方程：  
> $$
> u'(x)e^{\int k(x) dx} + u(x)k(x)e^{\int k(x) dx} = k(x)u(x)e^{\int k(x) dx} + b(x)
> $$
> 化简后得：  
> $$
> u'(x)e^{\int k(x) dx} = b(x)
> $$
> 两边同时除以 $e^{\int k(x) dx}$：  
> $$
> u'(x) = b(x)e^{-\int k(x) dx}
> $$
> 积分求解 $u(x)$：  
> $$
> u(x) = \int b(x)e^{-\int k(x) dx} dx + C
> $$
>
> 通解为齐次解与特解的叠加：  
> $$
> y = y_h + y_p = Ce^{\int k(x) dx} + \left(\int b(x)e^{-\int k(x) dx} dx\right)e^{\int k(x) dx}
> $$
>
> > 最后得到方程的解为:
> > $$
> > y = Ce^{\int k(x) dx} + e^{\int k(x) dx} \int b(x)e^{-\int k(x) dx} dx
> > $$
> > 其中 $C$ 是任意常数。
> 

## 二阶线性微分方程和微分方程组

> [!tip]
> 
> 实际问题中经常出现形如
> $$
> y''(x) + Q(x) \cdot y'(x) + R(x) \cdot y(x) = f(x) 
> $$
> 的微分方程. 这类方程属于**二阶线性微分方程**.
> 

> [!note]
> 
> ==带有阻尼和外力的振动方程==
>  
> 考虑一个质量为 $ m $ 的物体，固定在弹簧上，弹簧常数为 $ k $，并且系统中存在阻力（或阻尼），阻力与速度成正比，比例常数为 $c $。此外，系统受到一个外力 $ F(t) $ 的作用。我们的目标是建立该系统的运动方程。
>
> 系统的受力分析为: 
>  
> - **弹簧力**：根据胡克定律，弹簧的恢复力是与物体的位移 $ x(t) $ 成正比的，方向与位移相反，表达式为：  
>   $$
>   F_{\text{spring}} = -k \cdot x(t)
>   $$
>  
> - **阻尼力**：阻尼力与物体的速度 $ \frac{dx}{dt} $ 成正比，方向与速度相反，表达式为：  
>   $$
>    F_{\text{damping}} = -c \cdot \frac{dx}{dt} 
>   $$
>  
> - **外力**：外力 $F(t)$ 是已知的外部作用力。  
>  
> 根据牛顿第二定律，物体的加速度 $ \frac{d^2x}{dt^2} $ 与合力之比为物体的质量：  
> $$
> m \cdot \frac{d^2x}{dt^2} = F_{\text{spring}} + F_{\text{damping}} + F(t) 
> $$
>  
> 将各个力代入:
> $$
> m \cdot \frac{d^2x}{dt^2} = -k \cdot x(t) - c \cdot \frac{dx}{dt} + F(t)
> $$
>  
> 将上式整理得到标准形式的二阶线性微分方程：  
> $$
>  \frac{d^2x}{dt^2} + \frac{c}{m} \cdot \frac{dx}{dt} + \frac{k}{m} \cdot x(t) = \frac{F(t)}{m} 
> $$
>  
> 这就是有外力的阻尼震荡方程.
> - 当 $F(t) = 0$ 时，方程为齐次方程，描述的是自由阻尼振动：  
>   $$
>   \frac{d^2x}{dt^2} + \frac{c}{m} \cdot \frac{dx}{dt} + \frac{k}{m} \cdot x(t) = 0 
>   $$
>  
> - 当 $ F(t) \neq 0 $ 时，如 $F(t) = h\sin( \omega t)$, 方程为非齐次方程，描述的是有外力作用下的阻尼振动。
> 
>   $$
>   \frac{d^2x}{dt^2} + \frac{c}{m} \cdot \frac{dx}{dt} + \frac{k}{m} \cdot x(t) = \frac{h}{m} \sin( \omega t)
>   $$

> [!warning]
> 
> 前面我们考虑的简谐振动方程可以看成是二阶线性微分方程的特例, 但一般的二阶线性微分方程求解是非常困难的, 需要通过引入新变量的方法将**高阶(二阶)线性微分方程**转化为**一阶线性线性微分方程组**.
> 
> 例如对方程
> 
> $$
>   y'' + p y' + q y = 0
> $$
> 我们可以令 $v(t) = y'(t)$, 则
>   $$
>   \left\{
>   \begin{align*}
>   &y' = u \\
>   &u' = -p u - q y
>   \end{align*}
>   \right.
>   $$
>   
> 求解这类**一阶线性线性微分方程组**需要在高维线性空间中进行, 需要一些线性代数的知识, 因此这部分内容我们将在下学期再介绍.

> [!tip]
> 
> 由多个微分方程联立得到**微分方程组**, 刚才的例子就是一个微分方程组. 实际问题中微分方程组也十分的常见.
> 

> [!note]
> 
> ==Lotka-Volterra 模型==
> 
> Lotka-Volterra 模型是一个经典的捕食-猎物模型，用于描述捕食者与猎物之间的相互作用。该模型由两个微分方程组成，分别描述猎物和捕食者的动态变化。模型的标准形式为：  
>  
> $$
> \frac{dx}{dt} = \alpha x - \beta xy
> $$
> $$
> \frac{dy}{dt} = \delta xy - \gamma y
> $$
>  
> 其中：  
> - $x(t)$ 是猎物（兔子）的数量，  
> - $y(t)$ 是捕食者（狼）的数量，  
> - $\alpha$ 是猎物的自然增长率（不受捕食者影响时），  
> - $\beta$ 是捕食者捕食猎物的效率，  
> - $\delta$ 是捕食者的繁殖率（每捕食一只猎物，捕食者的种群数量增加的比例），  
> - $\gamma$ 是捕食者的死亡率（不受食物影响时）。  
>  
> 这个模型是一个非线性方程组，常用于描述生态系统中捕食者和猎物的动态交互关系。

> [!note]
> 
> ==行星运动方程==
> 
> $$
> \frac{d^2 x}{dt^2} = -G \frac{M}{(x^2 + y^2 + z^2)^{3/2}} x
> $$
> $$
> \frac{d^2 y}{dt^2} = -G \frac{M}{(x^2 + y^2 + z^2)^{3/2}} y
> $$
> $$
> \frac{d^2 z}{dt^2} = -G \frac{M}{(x^2 + y^2 + z^2)^{3/2}} z
> $$
>  
> 该方程组描述了行星在三维空间中的运动。
> 

## 微分方程的数值求解

> [!tip]
> 
> 大部分微分方程都无法解析求解, 运用计算机, 我们可以对微分方程进行数值求解.
> 

> [!note]
> 
> ==Lotka-Volterra方程==
> 
> [课堂展示] 我们可以很容易的用AI帮助我们写程序, 然后画图.

> [!note]
> 
> ==行星运动方程==
> 
> [课堂展示] 我们可以很容易的用AI帮助我们写程序, 然后画图.


[回到主页面](index.html)

---
title: 高等数学讲义
author: 胡煜成
description: 首都师范大学高等数学A
"og:description": 浏览器版和手机版
"og:image": https://vlook-doc.pages.dev/pic/vlook-og.png
keywords:
- 高等数学,微积分,讲义
vlook-chp-autonum: h1=off
vlook-query: vdl=on
vlook-query: ws=off
---

[toc]

# 数值方法求解微积分问题

> [!tip]
> 
> 在实际工程和科学计算中，许多微积分问题无法获得解析解，或者解析表达式过于复杂。数值方法通过离散化近似，为这些问题提供了实用的解决方案。本章介绍三种基本数值方法：数值微分、数值积分和常微分方程的数值解法。

### 数值微分

> [!tip]
> 
> 在实际应用中，我们经常遇到需要计算函数导数的情况，但有时函数表达式复杂，或者只有离散的数据点，这时就需要使用数值微分方法。



> [!important]
> 
> ### 8.1.1 差商的基本概念
> 
> 数值微分的核心思想是用**差商**来近似**导数**。差商是函数在两个点上的函数值之差与自变量之差的比值。
> 
> **三种基本差商**：
> 
> 1. **前向差商**：
>    $$
>    f'(x) \approx \frac{f(x+h)-f(x)}{h}
>    $$
> 
> 2. **后向差商**：
>    $$
>    f'(x) \approx \frac{f(x)-f(x-h)}{h}
>    $$
> 
> 3. **中心差商**：
>    $$
>    f'(x) \approx \frac{f(x+h)-f(x-h)}{2h}
>    $$
> 
> 其中 $h > 0$ 是一个小的步长。
>

> [!warning]
> 
> ### 8.1.2 差商的几何意义
> 
> 从几何角度看，差商实际上是**割线斜率**对**切线斜率**的近似：
> 
> - **前向差商**：使用点 $(x, f(x))$ 和 $(x+h, f(x+h))$ 的割线斜率
> 
> - **后向差商**：使用点 $(x-h, f(x-h))$ 和 $(x, f(x))$ 的割线斜率
> 
> - **中心差商**：使用点 $(x-h, f(x-h))$ 和 $(x+h, f(x+h))$ 的割线斜率
> 
> **精度比较**：
> 
> - 前向和后向差商的误差约为 $O(h)$
> - 中心差商的误差约为 $O(h^2)$，精度更高

> [!note]
> 
> ==数值微分的计算实例==
> 
> **例1** 计算 $f(x) = x^2$ 在 $x=1$ 处的导数近似值，取 $h=0.1$
> 
> **精确值**：$f'(1) = 2$
> 
> **前向差商**：
> $$
> \frac{f(1.1)-f(1)}{0.1} = \frac{1.21-1}{0.1} = 2.1
> $$
> 
> **后向差商**：
> $$
> \frac{f(1)-f(0.9)}{0.1} = \frac{1-0.81}{0.1} = 1.9
> $$
> 
> **中心差商**：
> $$
> \frac{f(1.1)-f(0.9)}{0.2} = \frac{1.21-0.81}{0.2} = 2.0
> $$
> 
> 可以看到中心差商给出了最精确的结果。
> 
> **例2** 步长 $h$ 对精度的影响
> 
> 对于 $f(x) = \sin x$，在 $x=0$ 处计算导数，精确值为 $\cos 0 = 1$
> 
> | 步长 $h$ | 前向差商 | 绝对误差 | 中心差商 | 绝对误差 |
> |----------|----------|----------|----------|----------|
> | 0.1      | 0.99833  | 0.00167  | 0.99998  | 0.00002  |
> | 0.01     | 0.99998  | 0.00002  | 1.00000  | 0.00000  |
> | 0.001    | 1.00000  | 0.00000  | 1.00000  | 0.00000  |
> 
> 观察发现：
> - 步长越小，精度越高
> - 中心差商比前向差商精度更高
> - 但步长过小可能引入数值舍入误差

> [!important]
> 
> ==二阶导数的数值计算==
> 
> 二阶导数可以用以下公式近似：
> $$
> f''(x) \approx \frac{f(x+h) - 2f(x) + f(x-h)}{h^2}
> $$
> 
> **推导**：
> 将 $f(x+h)$ 和 $f(x-h)$ 在 $x$ 处泰勒展开：
> $$
> f(x+h) = f(x) + hf'(x) + \frac{h^2}{2}f''(x) + \frac{h^3}{6}f'''(x) + \cdots
> $$
> $$
> f(x-h) = f(x) - hf'(x) + \frac{h^2}{2}f''(x) - \frac{h^3}{6}f'''(x) + \cdots
> $$
> 
> 两式相加：
> $$
> f(x+h) + f(x-h) = 2f(x) + h^2 f''(x) + O(h^4)
> $$
> 
> 整理得：
> $$
> f''(x) \approx \frac{f(x+h) - 2f(x) + f(x-h)}{h^2}
> $$

> [!note]
> 
> **例3** 计算 $f(x) = x^3$ 在 $x=1$ 处的二阶导数，$h=0.1$
> 
> **精确值**：$f''(1) = 6$
> 
> **数值计算**：
> $$
> \frac{f(1.1) - 2f(1) + f(0.9)}{0.01} = \frac{1.331 - 2 + 0.729}{0.01} = \frac{0.06}{0.01} = 6
> $$
> 
> 结果与精确值一致。

### 数值积分

> [!tip]
>
> 当函数的原函数难以求出，或者只有离散的数据点时，数值积分提供了计算定积分的有效方法。数值积分的基本思想是用简单的函数（如多项式）近似被积函数，然后计算近似函数的积分。
>

> [!important]
>
> ==矩形法==
> 
> 矩形法是数值积分中最简单的方法，它将积分区间分割成若干小区间，用每个小区间左端点或右端点的函数值作为矩形的高。
> 
> **左矩形法**：
> $$
> \int_a^b f(x)dx \approx h\sum_{i=0}^{n-1} f(x_i)
> $$
> 其中 $h = \frac{b-a}{n}$，$x_i = a + ih$
> 
> **右矩形法**：
> $$
> \int_a^b f(x)dx \approx h\sum_{i=1}^n f(x_i)
> $$
> 
> **几何意义**：用一系列矩形面积之和近似曲边梯形的面积。

> [!note]
>
> **例1** 用矩形法计算 $\int_0^1 x^2 dx$，取 $n=4$
> 
> **精确值**：$\frac{1}{3} \approx 0.3333$
> 
> **左矩形法**：
> $h = 0.25$，$x_i = 0, 0.25, 0.5, 0.75$
> 
> 面积 = $0.25 \times [f(0) + f(0.25) + f(0.5) + f(0.75)]$
> = $0.25 \times [0 + 0.0625 + 0.25 + 0.5625] = 0.25 \times 0.875 = 0.21875$
> 
> **右矩形法**：
> $x_i = 0.25, 0.5, 0.75, 1.0$
> 
> 面积 = $0.25 \times [f(0.25) + f(0.5) + f(0.75) + f(1.0)]$
> = $0.25 \times [0.0625 + 0.25 + 0.5625 + 1.0] = 0.25 \times 1.875 = 0.46875$

> [!important]
>
> ==梯形法==
> 
> 梯形法用梯形面积代替矩形面积，通常能获得更好的精度。
> 
> **梯形公式**：
> $$
> \int_a^b f(x)dx \approx \frac{h}{2}[f(a) + 2\sum_{i=1}^{n-1} f(x_i) + f(b)]
> $$
> 
> **几何意义**：用一系列梯形面积之和近似曲边梯形的面积。
> 
> **推导**：
> 每个小区间 $[x_i, x_{i+1}]$ 上的积分用梯形面积近似：
> $$
> \int_{x_i}^{x_{i+1}} f(x)dx \approx \frac{h}{2}[f(x_i) + f(x_{i+1})]
> $$
> 
> 将所有小区间相加即得梯形公式。

> [!note]
>
> **例2** 用梯形法计算 $\int_0^1 x^2 dx$，取 $n=4$
> 
> 面积 = $\frac{0.25}{2}[f(0) + 2f(0.25) + 2f(0.5) + 2f(0.75) + f(1.0)]$
> = $0.125 \times [0 + 2 \times 0.0625 + 2 \times 0.25 + 2 \times 0.5625 + 1.0]$
> = $0.125 \times [0 + 0.125 + 0.5 + 1.125 + 1.0] = 0.125 \times 2.75 = 0.34375$
> 
> 与精确值 $0.3333$ 相比，误差约为 $0.0104$，比矩形法有明显改进。

> [!important]
>
> ==辛普森法==
> 
> 辛普森法用抛物线代替直线来近似被积函数，精度更高。
> 
> **辛普森公式**：
> $$
> \int_a^b f(x)dx \approx \frac{h}{3}[f(a) + 4\sum_{i=1}^{n/2} f(x_{2i-1}) + 2\sum_{i=1}^{n/2-1} f(x_{2i}) + f(b)]
> $$
> 
> **要求**：区间等分且 $n$ 为偶数
> 
> **几何意义**：每两个相邻小区间上用一条抛物线近似被积函数。

> [!note]
>
> **例3** 用辛普森法计算 $\int_0^1 x^2 dx$，取 $n=4$
> 
> 面积 = $\frac{0.25}{3}[f(0) + 4f(0.25) + 2f(0.5) + 4f(0.75) + f(1.0)]$
> = $\frac{0.25}{3} \times [0 + 4 \times 0.0625 + 2 \times 0.25 + 4 \times 0.5625 + 1.0]$
> = $\frac{0.25}{3} \times [0 + 0.25 + 0.5 + 2.25 + 1.0] = \frac{0.25}{3} \times 4.0 = 0.3333$
> 
> 与精确值完全一致（因为 $x^2$ 是二次函数，辛普森法对不超过三次的多项式精确成立）。

> [!warning]
>
> ==三种数值积分方法的精度比较==
> 
> 对于 $\int_0^1 e^x dx = e - 1 \approx 1.71828$，不同方法的精度比较：
> 
> | 方法     | $n=4$ 时的近似值 | 绝对误差 | 收敛阶 |
> |----------|------------------|----------|--------|
> | 左矩形法 | 1.49068          | 0.22760  | $O(h)$ |
> | 右矩形法 | 1.93637          | 0.21809  | $O(h)$ |
> | 梯形法   | 1.71339          | 0.00489  | $O(h^2)$ |
> | 辛普森法 | 1.71832          | 0.00004  | $O(h^4)$ |
> 
> 可见辛普森法的精度最高，梯形法次之，矩形法精度最低。

> [!warning]
>
> ==数值积分的误差分析==
> 
> 各种数值积分方法的误差估计：
> 
> - **矩形法**：误差约 $O(h)$
> - **梯形法**：误差约 $O(h^2)$
> - **辛普森法**：误差约 $O(h^4)$

### 常微分方程的数值解法

> [!tip]
> 
> 许多实际问题的数学模型是常微分方程，但大多数微分方程无法求得解析解。数值解法通过离散化方法，将连续的微分方程转化为离散的代数方程，从而获得近似解。

> [!important]
> 
> ==欧拉方法==
> 
> 欧拉方法是最简单、最直观的数值解法，它用切线来近似积分曲线。
> 
> **基本思想**：从初始点出发，沿着该点的切线方向前进一小步，得到下一个近似点。
> 
> **迭代公式**：
> $$
> y_{n+1} = y_n + hf(x_n, y_n)
> $$
> 
> 其中：
> - $h$ 是步长
> - $f(x_n, y_n)$ 是微分方程右端函数在 $(x_n, y_n)$ 处的值
> - $y_n$ 是 $x_n$ 处的近似解
> 
> **几何解释**：在每一步，用当前点的切线斜率代替曲线在该点的导数，沿着切线方向前进。

> [!note]
> 
> **例1** 用欧拉方法求解初值问题：
> $$
> \frac{dy}{dx} = y, \quad y(0) = 1
> $$
> 在区间 $[0, 1]$ 上，取步长 $h = 0.2$
> 
> **精确解**：$y = e^x$
> 
> **数值计算**：
> 
> | $x_n$ | 欧拉近似 $y_n$ | 精确值 $e^{x_n}$ | 绝对误差 |
> |-------|----------------|------------------|----------|
> | 0.0   | 1.0000         | 1.0000           | 0.0000   |
> | 0.2   | 1.2000         | 1.2214           | 0.0214   |
> | 0.4   | 1.4400         | 1.4918           | 0.0518   |
> | 0.6   | 1.7280         | 1.8221           | 0.0941   |
> | 0.8   | 2.0736         | 2.2255           | 0.1519   |
> | 1.0   | 2.4883         | 2.7183           | 0.2300   |
> 
> 计算过程：
> - $y_1 = 1.0 + 0.2 \times 1.0 = 1.2$
> - $y_2 = 1.2 + 0.2 \times 1.2 = 1.44$
> - $y_3 = 1.44 + 0.2 \times 1.44 = 1.728$
> - 依此类推...

> [!note]
> 
> ==步长对精度的影响==
> 
> 欧拉方法的精度与步长 $h$ 密切相关。一般来说，步长越小，精度越高，但计算量越大。
> 
> **例2** 不同步长下的比较（同一个问题）
> 
> | 步长 $h$ | $y(1)$ 的近似值 | 绝对误差 |
> |----------|------------------|----------|
> | 0.5      | 2.2500           | 0.4683   |
> | 0.2      | 2.4883           | 0.2300   |
> | 0.1      | 2.5937           | 0.1246   |
> | 0.05     | 2.6533           | 0.0650   |
> | 0.01     | 2.7048           | 0.0135   |
> 
> 可见随着步长减小，精度逐渐提高。

> [!warning]
> 
> ==改进的欧拉方法==
> 
> 改进的欧拉方法（又称Heun方法）通过使用预测-校正策略来提高精度。
> 
> **计算步骤**：
> 1. **预测步**：用欧拉方法计算一个初步预测值
>    $$
>    \bar{y}_{n+1} = y_n + hf(x_n, y_n)
>    $$
> 
> 2. **校正步**：用预测点的斜率来改进
>    $$
>    y_{n+1} = y_n + \frac{h}{2}[f(x_n, y_n) + f(x_{n+1}, \bar{y}_{n+1})]
>    $$
> 
> **几何解释**：先用欧拉方法预测，然后用两端斜率的平均值来校正。

> [!note]
> 
> **例3** 用改进欧拉方法求解例1的问题
> 
> 第一步计算：
> - 预测：$\bar{y}_1 = 1.0 + 0.2 \times 1.0 = 1.2$
> - 校正：$y_1 = 1.0 + \frac{0.2}{2}[1.0 + 1.2] = 1.0 + 0.1 \times 2.2 = 1.22$
> 
> 与精确值 $1.2214$ 相比，改进欧拉法的结果 $1.2200$ 比普通欧拉法的 $1.2000$ 更接近。

> [!note]
> 
> ==数值解法的应用实例==
> 
> **应用1：人口增长模型**
> 
> **问题**：某地区人口初始为100万，年自然增长率为3%，同时每年净迁入1万人。预测10年后的人口。
> 
> **模型**：
> $$
> \frac{dP}{dt} = 0.03P + 1, \quad P(0) = 100
> $$
> （单位：万人，时间单位：年）
> 
> **解析解**：$P(t) = \frac{100}{3}(e^{0.03t} - 1) + 100e^{0.03t}$
> 
> **数值解**（欧拉方法，$h = 1$ 年）：
> 
> | 年份 $t$ | 人口 $P(t)$（数值） | 人口 $P(t)$（精确） |
> |----------|---------------------|---------------------|
> | 0        | 100.00              | 100.00              |
> | 1        | 104.00              | 104.08              |
> | 2        | 108.12              | 108.37              |
> | 3        | 112.36              | 112.78              |
> | 4        | 116.73              | 117.33              |
> | 5        | 121.23              | 122.02              |
> | 10       | 147.85              | 149.18              |
> 
> 计算过程：
> - $P_1 = 100 + 1 \times (0.03 \times 100 + 1) = 104$
> - $P_2 = 104 + 1 \times (0.03 \times 104 + 1) = 108.12$
> - 依此类推...
> 
> **应用2：RC电路充电过程**
> 
> **问题**：RC电路中，电容初始电压为0，电源电压 $E = 10V$，电阻 $R = 1000\Omega$，电容 $C = 1000\mu F$。求电容电压随时间的变化。
> 
> **模型**：
> $$
> \frac{dV}{dt} = \frac{E - V}{RC}, \quad V(0) = 0
> $$
> 
> 其中 $RC = 1000 \times 0.001 = 1$ 秒
> 
> **解析解**：$V(t) = 10(1 - e^{-t})$
> 
> **数值解**（欧拉方法，$h = 0.2$ 秒）：
> 
> | 时间 $t$ (s) | 电压 $V(t)$（数值） | 电压 $V(t)$（精确） |
> |-------------|---------------------|---------------------|
> | 0.0         | 0.00                | 0.00                |
> | 0.2         | 2.00                | 1.81                |
> | 0.4         | 3.60                | 3.30                |
> | 0.6         | 4.88                | 4.51                |
> | 0.8         | 5.90                | 5.51                |
> | 1.0         | 6.72                | 6.32                |
> 
> 计算过程：
> - $V_1 = 0 + 0.2 \times (10 - 0)/1 = 2.0$
> - $V_2 = 2.0 + 0.2 \times (10 - 2.0)/1 = 3.6$
> - 依此类推...

> [!warning]
> 
> ==数值解法的优缺点==
> 
> **优点**：
> 1. **通用性强**：适用于各种类型的微分方程
> 2. **实现简单**：算法直观，编程容易
> 3. **灵活性高**：可以处理复杂的右端函数
> 
> **缺点**：
> 1. **精度有限**：欧拉方法只有一阶精度
> 2. **稳定性问题**：步长选择不当可能导致数值不稳定
> 3. **累积误差**：误差会随着计算步数增加而积累
> 
> **实用建议**：
> 1. 先尝试欧拉方法，了解问题的基本特性
> 2. 对于精度要求高的问题，使用改进欧拉方法或其他高阶方法
> 3. 通过减小步长来检验结果的收敛性
> 4. 对于刚性问题，需要特殊的数值方法

